import{c as oe,u as be,i as xe,r as i,j as e,O as ae,K as o,T as ue,b as Q,Q as ee,p as Nt,q as W,k as ge,V as le,n as kt,h as we,U as He,X as it,Z as Oe,t as Ye,C as te,f as qe,W as qt,Y as Te,$ as Se,a0 as Gt,o as ie,a1 as Jt,m as lt,z as St,D as Ce,L as Ct,d as Kt,B as Qt,a2 as mt,a3 as st,a4 as At,a5 as Xt,a6 as ne}from"./index-YQPxzjda.js";import{C as ve}from"./circle-x-Cgx-O9-M.js";import{C as Ge}from"./chevron-right-Bep1nWWt.js";import{S as Ue}from"./shield-DdEVoit8.js";import{S as Ae}from"./star-CZso1FtB.js";import{C as ot}from"./chevron-down-C7heoKrI.js";import{S as ct}from"./send-CCicFbBu.js";import{P as Et}from"./play-SxVG3tlJ.js";import{E as Zt}from"./eye-sdGkkxgd.js";import{C as ut}from"./circle-alert-D3OMXpN1.js";import{U as ea}from"./upload-D81k4EH3.js";import{T as ta}from"./trash-2-C1QxOf9S.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],sa=oe("arrow-down-right",aa);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],na=oe("arrow-up-right",ra);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],pe=oe("crown",ia);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],oa=oe("database",la);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],da=oe("eye-off",ca);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],se=oe("loader-circle",ma);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],De=oe("medal",ua);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ga=oe("rotate-ccw",xa);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Tt=oe("trending-down",ha);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],fa=oe("wallet",pa),ba=()=>{const t=be(),{user:a}=xe(),[s,r]=i.useState([]),[n,m]=i.useState(!0),[p,x]=i.useState("all"),[y,f]=i.useState({totalBattles:0,wins:0,losses:0,winRate:0,totalEarnings:0});i.useEffect(()=>{(async()=>{if(!a){m(!1);return}try{const d=(await W(`/battles/user/${a.id}`)).battles||[];console.log("User battles:",d.length),console.log("Current user ID:",a.id),console.log("User participated in:",d.length,"battles");const S=d.filter(D=>D.status==="completed"||D.status==="forfeited");S.sort((D,P)=>{const w=N=>N?typeof N=="object"&&"toDate"in N&&N.toDate?N.toDate().getTime():N instanceof Date?N.getTime():typeof N=="number"?N:0:0;return w(P.createdAt)-w(D.createdAt)}),console.log("Completed battles:",S.length),S.length>0&&console.log("Sample battle:",S[0]),r(S);let v=0,L=0,O=0;d.forEach(D=>{D.winnerId===a.id?(v++,O+=D.prize||0):D.winnerId&&D.winnerId!==a.id&&(L++,O-=D.entryFee||0)}),f({totalBattles:d.length,wins:v,losses:L,winRate:d.length>0?Math.round(v/d.length*100):0,totalEarnings:O})}catch(b){console.error("Error fetching battle history:",b)}finally{m(!1)}})()},[a]);const T=()=>p==="all"?s:p==="won"?s.filter(g=>g.winnerId===a?.id):p==="lost"?s.filter(g=>g.winnerId&&g.winnerId!==a?.id):s,A=g=>{if(!g)return"N/A";let b;return typeof g=="object"&&"toDate"in g&&g.toDate?b=g.toDate():g instanceof Date?b=g:b=new Date(g),new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(b)},j=g=>g.participants?.find(d=>{const S=d;return S.odId!==a?.id&&S.userId!==a?.id}),E=g=>g.participants?.find(d=>{const S=d;return S.odId===a?.id||S.userId===a?.id});return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(se,{className:"w-12 h-12 text-[#00ADB5] animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading battle history..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-900 dark:to-gray-800",children:[e.jsxs("header",{className:"relative overflow-hidden py-8 md:py-12",style:{background:"linear-gradient(135deg, #00ADB5 0%, #00d4ff 100%)"},children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-white/10 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2"})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 relative z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e.jsx(ae,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:"Battle History"}),e.jsx("p",{className:"text-white/80 text-sm",children:"Your past matches and performance"})]})]})}),e.jsxs("button",{onClick:()=>t("/dashboard/codearena/battle"),className:"px-5 py-2.5 bg-white text-[#00ADB5] font-semibold rounded-xl hover:bg-white/90 transition-all shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"New Battle"]})]})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-2 md:grid-cols-5 gap-3 md:gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 p-4 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-100 dark:bg-gray-700 flex items-center justify-center",children:e.jsx(ue,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Total Battles"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y.totalBattles})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 rounded-2xl shadow-lg border border-green-100 dark:border-green-800 p-4 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-100 dark:bg-green-800/50 flex items-center justify-center",children:e.jsx(Q,{className:"w-5 h-5 text-green-600 dark:text-green-400"})})}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mb-1",children:"Victories"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:y.wins})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/30 dark:to-orange-900/30 rounded-2xl shadow-lg border border-red-100 dark:border-red-800 p-4 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-100 dark:bg-red-800/50 flex items-center justify-center",children:e.jsx(ve,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mb-1",children:"Defeats"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:y.losses})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-teal-50 dark:from-cyan-900/30 dark:to-teal-900/30 rounded-2xl shadow-lg border border-cyan-100 dark:border-cyan-800 p-4 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#00ADB5]/20 flex items-center justify-center",children:e.jsx(pe,{className:"w-5 h-5 text-[#00ADB5]"})})}),e.jsx("p",{className:"text-xs text-[#00ADB5] mb-1",children:"Win Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-[#00ADB5]",children:[y.winRate,"%"]})]}),e.jsxs("div",{className:`rounded-2xl shadow-lg border p-4 hover:shadow-xl transition-all ${y.totalEarnings>=0?"bg-gradient-to-br from-amber-50 to-yellow-50 dark:from-amber-900/30 dark:to-yellow-900/30 border-amber-100 dark:border-amber-800":"bg-white dark:bg-gray-800 border-gray-100 dark:border-gray-700"}`,children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${y.totalEarnings>=0?"bg-amber-100 dark:bg-amber-800/50":"bg-gray-100 dark:bg-gray-700"}`,children:e.jsx(ee,{className:`w-5 h-5 ${y.totalEarnings>=0?"text-amber-600 dark:text-amber-400":"text-gray-600"}`})})}),e.jsx("p",{className:`text-xs mb-1 ${y.totalEarnings>=0?"text-amber-600 dark:text-amber-400":"text-gray-500"}`,children:"Total Earnings"}),e.jsxs("p",{className:`text-2xl font-bold ${y.totalEarnings>=0?"text-amber-600 dark:text-amber-400":"text-red-600"}`,children:[y.totalEarnings>=0?"+":"",y.totalEarnings]})]})]}),e.jsx(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex items-center gap-2 bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-100 dark:border-gray-700 p-1.5 w-fit",children:[{id:"all",label:"All Battles",count:s.length},{id:"won",label:"Victories",count:s.filter(g=>g.winnerId===a?.id).length},{id:"lost",label:"Defeats",count:s.filter(g=>g.winnerId&&g.winnerId!==a?.id).length}].map(g=>e.jsxs("button",{onClick:()=>x(g.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2 ${p===g.id?"bg-gradient-to-r from-[#00ADB5] to-[#00d4ff] text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[g.label,e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${p===g.id?"bg-white/20":"bg-gray-200 dark:bg-gray-600"}`,children:g.count})]},g.id))}),e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"space-y-3",children:T().length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-100 dark:bg-gray-700 mx-auto mb-4 flex items-center justify-center",children:e.jsx(ae,{className:"w-10 h-10 text-gray-400 dark:text-gray-500"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:"No battles found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto",children:p==="all"?"You haven't participated in any battles yet. Start your first battle and prove your coding skills!":p==="won"?"No victories yet. Keep practicing and you'll get there!":"No defeats recorded. You're doing great!"}),e.jsxs("button",{onClick:()=>t("/dashboard/codearena/battle"),className:"px-6 py-3 bg-gradient-to-r from-[#00ADB5] to-[#00d4ff] text-white font-semibold rounded-xl hover:shadow-lg transition-all transform hover:scale-105 inline-flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),"Start Your First Battle"]})]}):T().map((g,b)=>{const d=g.winnerId===a?.id,S=j(g),v=E(g),L=g.status==="forfeited"&&g.forfeitedBy!==a?.id,O=g.status==="forfeited"&&g.forfeitedBy===a?.id;return e.jsxs(o.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:b*.05},whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},onClick:()=>t(`/dashboard/codearena/battle/results/${g.id}`),className:`bg-white dark:bg-gray-800 rounded-2xl shadow-md border-2 p-4 cursor-pointer hover:shadow-xl transition-all group ${d?"border-green-200 dark:border-green-700/50 hover:border-green-400 dark:hover:border-green-600":"border-red-200 dark:border-red-700/50 hover:border-red-400 dark:hover:border-red-600"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${d?"bg-gradient-to-br from-green-400 to-emerald-500":"bg-gradient-to-br from-red-400 to-orange-500"}`,children:d?e.jsx(Q,{className:"w-7 h-7 text-white"}):e.jsx(ve,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-lg font-bold ${d?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:d?"ðŸ† Victory":"ðŸ’” Defeat"}),L&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-400 rounded-full font-medium",children:"Opponent Left"}),O&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full font-medium",children:"Forfeited"})]}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 font-medium",children:["vs ",e.jsx("span",{className:"text-gray-900 dark:text-white",children:S?.odName||"Unknown Player"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(Nt,{className:"w-3.5 h-3.5"}),A(g.endTime||g.createdAt)]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium capitalize ${g.difficulty==="easy"?"bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-400":g.difficulty==="medium"?"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-400":"bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-400"}`,children:g.difficulty})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[v?.submissionResult&&e.jsxs("div",{className:"text-center hidden md:block bg-gray-50 dark:bg-gray-700/50 px-4 py-2 rounded-xl",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-0.5",children:"Tests Passed"}),e.jsxs("p",{className:`text-lg font-bold ${v.submissionResult.passed?"text-green-600 dark:text-green-400":"text-orange-600 dark:text-orange-400"}`,children:[v.submissionResult.passedCount,"/",v.submissionResult.totalCount]})]}),e.jsxs("div",{className:`text-center px-4 py-2 rounded-xl ${d?"bg-green-50 dark:bg-green-900/30":"bg-red-50 dark:bg-red-900/30"}`,children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-0.5",children:"Coins"}),e.jsxs("p",{className:`text-lg font-bold flex items-center justify-center gap-1 ${d?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[e.jsx(ee,{className:"w-4 h-4"}),d?"+":"-",d?g.prize:g.entryFee]})]}),e.jsx("div",{className:"hidden md:flex w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 items-center justify-center group-hover:bg-[#00ADB5] group-hover:text-white transition-all",children:e.jsx(Ge,{className:"w-5 h-5 text-gray-400 group-hover:text-white group-hover:translate-x-0.5 transition-all"})})]})]}),g.winReason&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Result: "}),g.winReason]})})]},g.id)})})]})]})},Bt=async t=>{try{const a=await W("/battles/create",{method:"POST",body:JSON.stringify(t)});return console.log(`Created battle ${a.battleId}`),a.battleId}catch(a){throw console.error("Error creating random battle:",a),a}},ya=async(t,a)=>{try{return(await W(`/battles/find?difficulty=${t}&entryFee=${a}`)).battle?._id||null}catch(s){return console.error("Error finding available battle:",s),null}},ja=async t=>{try{const{difficulty:a,entryFee:s}=t,r=await ya(a,s);if(r)return r;const n=await Bt(t);if(!n)throw new Error("Failed to create battle");return n}catch(a){throw console.error("Error joining or creating battle:",a),a}},wa=async(t,a,s)=>{try{if(t.originalBattleId){const r=await W(`/battles/${t.originalBattleId}/rematch`,{method:"POST",body:JSON.stringify({to:a,toName:s||"Opponent",fromName:t.userName,difficulty:t.difficulty,entryFee:t.entryFee,userName:t.userName,userAvatar:t.userAvatar,rating:t.rating})});return console.log(`Created rematch battle ${r.battleId}`),r.battleId}return Bt(t)}catch(r){throw console.error("Error creating rematch battle:",r),r}},va=[{id:"easy",label:"Easy",color:"bg-green-500",rating:"800-1200",time:15},{id:"medium",label:"Medium",color:"bg-yellow-500",rating:"1200-1600",time:20},{id:"hard",label:"Hard",color:"bg-red-500",rating:"1600-2000",time:30}],xt=[{fee:5,prize:9},{fee:10,prize:18},{fee:20,prize:36},{fee:50,prize:90}],Na=({wallet:t})=>{const a=be(),{user:s}=xe(),{userprofile:r,deductCoins:n}=ge(),[m,p]=i.useState("medium"),[x,y]=i.useState(xt[1]),[f,T]=i.useState(!1),[A,j]=i.useState(!1),[E,g]=i.useState([]),[b,d]=i.useState(null),[S,v]=i.useState(0);i.useEffect(()=>{if(!s)return;const u=async()=>{try{const B=((await W(`/battles?status=waiting&difficulty=${m}`)).battles||[]).filter(_=>_.creatorId!==s.id);g(B)}catch(I){console.error("Error fetching waiting battles:",I)}};u();const C=setInterval(u,5e3);return()=>clearInterval(C)},[s,m]),i.useEffect(()=>{if(!b||!f||!s)return;const u=async()=>{try{const I=await W(`/battles/${b}`);if(I&&(I.status==="countdown"||I.status==="active"||I.participants&&I.participants.length>=2)){console.log("Opponent found! Navigating to battle..."),a(`/dashboard/codearena/battle/${b}`);return}const B=((await W(`/battles?status=waiting&difficulty=${m}`)).battles||[]).filter(_=>_.creatorId!==s.id&&_.id!==b&&_.entryFee===x.fee);if(B.length>0){const _=B[0];console.log("Auto-match: Found existing battle, joining...",_.id);try{await W(`/battles/${b}`,{method:"DELETE"})}catch{console.log("Could not delete own battle, may already be matched")}await W(`/battles/${_.id}/join`,{method:"POST",body:JSON.stringify({userId:s.id,userName:r?.name||s.email?.split("@")[0]||"User",userAvatar:r?.profilePic||"",rating:t?.rating||1e3})}),a(`/dashboard/codearena/battle/${_.id}`)}}catch(I){console.error("Error polling battle status:",I)}};u();const C=setInterval(u,2e3);return()=>clearInterval(C)},[b,f,a,s,m,x.fee,r,t]),i.useEffect(()=>{if(!b||!f)return;const u=async()=>{try{const C=localStorage.getItem("token");navigator.sendBeacon(`https://nextstepbackend-qhxw.onrender.com/api/battles/${b}/cancel`,JSON.stringify({token:C}))}catch(C){console.error("Error cancelling battle:",C)}};return window.addEventListener("beforeunload",u),()=>{window.removeEventListener("beforeunload",u),b&&f&&W(`/battles/${b}`,{method:"DELETE"}).catch(()=>{})}},[b,f]),i.useEffect(()=>{let u;return f&&(u=setInterval(()=>{v(C=>C+1)},1e3)),()=>clearInterval(u)},[f]);const L=async()=>{if(console.log("handleFindMatch called",{user:s,wallet:t,selectedEntry:x}),!s){alert("Please log in to find a match");return}if(!t){alert("Wallet not loaded. Please wait or refresh the page.");return}if((t.coins||0)<x.fee){alert(`Insufficient coins! You have ${t.coins||0} coins but need ${x.fee} coins.`);return}T(!0),v(0);try{const u=E.find(C=>C.difficulty===m&&C.entryFee===x.fee&&C.creatorId!==s.id);u?await D(u,!0):await O(!0)}catch(u){console.error("Error finding match:",u),alert("Failed to find match. Please try again."),T(!1)}},O=async(u=!1)=>{try{if(j(!0),!t){alert("Wallet not initialized. Please refresh the page."),T(!1);return}if((t.coins||0)<x.fee){alert(`Insufficient coins! You have ${t.coins||0} coins but need ${x.fee} coins.`),T(!1);return}const C={difficulty:m,entryFee:x.fee,userId:s.id,userName:r?.name||s.email?.split("@")[0]||"User",userAvatar:r?.profilePic||"",rating:t?.rating||1e3};console.log("Creating battle with request:",C);const I=await ja(C);console.log("Battle created with ID:",I),u&&await n(s.id,x.fee,"Battle entry fee"),d(I)}catch(C){console.error("Error creating battle:",C),alert(C instanceof Error?C.message:"Failed to create battle"),T(!1)}finally{j(!1)}},D=async(u,C=!1)=>{try{if(!t){alert("Wallet not initialized. Please refresh the page."),T(!1);return}if((t.coins||0)<u.entryFee){alert(`Insufficient coins! You have ${t.coins||0} coins but need ${u.entryFee} coins.`),T(!1);return}console.log("Joining battle:",u.id),await W(`/battles/${u.id}/join`,{method:"POST",body:JSON.stringify({userId:s.id,userName:r?.name||s.email?.split("@")[0]||"User",userAvatar:r?.profilePic||"",rating:t?.rating||1e3})}),C&&await n(s.id,u.entryFee,"Battle entry fee"),a(`/dashboard/codearena/battle/${u.id}`)}catch(I){console.error("Error joining battle:",I),alert(I instanceof Error?I.message:"Failed to join battle. Battle may have been taken by another player."),T(!1)}},P=async()=>{if(b)try{await n(s.id,-x.fee,"Battle cancelled - refund"),await W(`/battles/${b}`,{method:"DELETE"})}catch(u){console.error("Error cancelling battle:",u)}T(!1),d(null),v(0)},w=u=>{const C=Math.floor(u/60),I=u%60;return`${C}:${I.toString().padStart(2,"0")}`},N=t?.coins??0,F=N>=x.fee,c=!t||!F||f||A;return console.log("BattleLobby render:",{wallet:t,walletCoins:N,selectedEntry:x,hasEnoughCoins:F,isButtonDisabled:c}),e.jsxs("div",{className:"space-y-6 pb-20 md:pb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg",children:e.jsx(ae,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Battle Arena"}),e.jsx("p",{className:"text-gray-500 dark:text-white text-xs",children:"Compete against other coders in real-time"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-amber-50 dark:bg-amber-900/30 rounded-lg",children:[e.jsx(ee,{className:"w-4 h-4 text-amber-600"}),e.jsxs("span",{className:"text-amber-700 dark:text-amber-400 font-semibold text-sm",children:["Balance: ",t?.coins?.toLocaleString()||0," coins"]})]})]}),e.jsx(le,{children:f&&e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(o.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md w-full mx-4 text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-6",children:[e.jsx(o.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"absolute inset-0 rounded-full border-4 border-[#00ADB5]/30 dark:border-[#00ADB5]/40 border-t-blue-600"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(kt,{className:"w-8 h-8 text-[#00ADB5]"})})]}),e.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-[#00ADB5] to-purple-600 bg-clip-text text-transparent mb-2",children:"ðŸ” Finding Opponent..."}),e.jsxs("p",{className:"text-gray-600 dark:text-white mb-6 text-lg",children:["Searching for a ",e.jsx("span",{className:"font-bold text-[#00ADB5]",children:m})," battle ðŸŽ¯"]}),e.jsxs("div",{className:"flex items-center justify-center gap-3 text-3xl font-mono bg-gradient-to-r from-[#00ADB5] to-purple-600 bg-clip-text text-transparent mb-6 font-bold",children:[e.jsx(we,{className:"w-6 h-6 text-[#00ADB5]"}),w(S)]}),e.jsxs("div",{className:"flex items-center justify-center gap-6 text-sm text-gray-600 mb-8",children:[e.jsxs(o.span,{animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0},className:"flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-green-100 to-emerald-100 rounded-full",children:[e.jsx(He,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{className:"font-semibold text-green-700",children:[E.length," players waiting"]})]}),e.jsxs("span",{className:"flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-amber-100 to-yellow-100 rounded-full",children:[e.jsx(ee,{className:"w-4 h-4 text-amber-600"}),e.jsxs("span",{className:"font-semibold text-amber-700",children:["Entry: ",x.fee]})]})]}),e.jsxs(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:P,className:"flex items-center justify-center gap-2 w-full py-4 bg-gradient-to-r from-red-500 to-pink-500 text-white font-bold rounded-2xl hover:from-red-600 hover:to-pink-600 transition-all shadow-lg",children:[e.jsx(it,{className:"w-5 h-5"}),"Cancel Battle ðŸš«"]})]})})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm mb-3",children:"Select Difficulty"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-6",children:va.map(u=>e.jsxs(o.button,{whileHover:{scale:1.03,y:-2},whileTap:{scale:.97},onClick:()=>p(u.id),className:`p-3 rounded-xl border-2 transition-all relative overflow-hidden ${m===u.id?"border-[#00ADB5] bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 shadow-md":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:shadow-md bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-700"}`,children:[m===u.id&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-purple-400/10 rounded-xl"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${u.color} mb-2 mx-auto shadow-sm`}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:u.label}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:u.rating}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-white mt-0.5",children:[e.jsx(we,{className:"w-3 h-3 inline mr-0.5"}),u.time,"m"]})]},u.id))}),e.jsxs("h3",{className:"font-semibold text-sm text-gray-800 dark:text-gray-200 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’°"})," Entry Fee & Prize"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:xt.map(u=>e.jsxs(o.button,{whileHover:{scale:t?.coins>=u.fee?1.03:1},whileTap:{scale:t?.coins>=u.fee?.97:1},onClick:()=>y(u),disabled:t?.coins<u.fee,className:`p-3 rounded-xl border-2 transition-all relative overflow-hidden ${x.fee===u.fee?"border-amber-400 bg-gradient-to-br from-amber-50 to-yellow-50 dark:from-amber-900/30 dark:to-yellow-900/30 shadow-md":t?.coins<u.fee?"border-gray-200 dark:border-gray-600 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 opacity-50 cursor-not-allowed":"border-gray-200 dark:border-gray-600 hover:border-amber-300 dark:hover:border-amber-600 hover:shadow-md bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-700"}`,children:[x.fee===u.fee&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/10 to-yellow-400/10 rounded-xl"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-amber-600 font-medium text-sm",children:[e.jsx(ee,{className:"w-3.5 h-3.5"}),u.fee]}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-green-600 text-xs mt-0.5",children:[e.jsx(Q,{className:"w-3 h-3"}),"Win ",u.prize]})]},u.fee))}),e.jsx(o.button,{whileHover:{scale:c?1:1.02},whileTap:{scale:c?1:.98},onClick:L,disabled:c,className:`w-full py-3 rounded-xl font-semibold text-base flex items-center justify-center gap-2 transition-all shadow-md ${c?"bg-gradient-to-r from-gray-300 to-gray-400 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-[#00ADB5] via-purple-600 to-indigo-600 text-white hover:from-blue-700 hover:via-purple-700 hover:to-indigo-700 cursor-pointer"}`,children:A?e.jsxs(e.Fragment,{children:[e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-4 h-4"}),"Find Match",e.jsx(Ge,{className:"w-4 h-4"})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2 text-xs text-green-600 dark:text-green-400",children:[e.jsx(Ue,{className:"w-3 h-3"}),e.jsx("span",{children:"Secure Battle System"})]}),!t&&e.jsx("p",{className:"text-center text-amber-500 text-xs mt-2",children:"Loading wallet... Please wait"}),t&&!F&&e.jsxs("p",{className:"text-center text-red-500 text-xs mt-2",children:["Need ",x.fee-N," more coins (You have ",N,")"]}),t&&F&&e.jsxs("p",{className:"text-center text-green-500 text-xs mt-2",children:["Ready to battle! (",N," coins available)"]})]}),E.length>0&&e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-white to-green-50 dark:from-gray-800 dark:to-green-900/20 rounded-xl border border-green-200 dark:border-green-700 shadow p-4 relative overflow-hidden",children:[e.jsxs("h3",{className:"font-bold text-sm text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg",children:e.jsx(He,{className:"w-4 h-4 text-white"})}),"Open Battles",e.jsxs(o.span,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"text-xs bg-gradient-to-r from-green-500 to-emerald-500 text-white px-2 py-0.5 rounded-full font-semibold",children:[E.length," live"]})]}),e.jsx("div",{className:"space-y-2",children:E.map(u=>e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:u.creatorProfilePic||`https://api.dicebear.com/7.x/avataaars/svg?seed=${u.creatorId}`,alt:u.creatorName,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:u.creatorName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-white",children:[u.creatorRating," â€¢ ",u.difficulty]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-1 text-amber-600 font-medium text-sm",children:[e.jsx(ee,{className:"w-3 h-3"}),u.entryFee]}),e.jsxs("div",{className:"text-xs text-green-600",children:["Win ",u.prize]})]}),e.jsx("button",{onClick:async()=>{t?.coins>=u.entryFee&&await D(u,!0)},disabled:t?.coins<u.entryFee,className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${t?.coins>=u.entryFee?"bg-[#00ADB5] text-white hover:bg-[#00ADB5]/80":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:"Join"})]})]},u.id))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm mb-3",children:"How Battles Work"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-3",children:[{icon:ee,title:"Pay Entry Fee",description:"Contribute coins to prize pool"},{icon:ae,title:"Solve Problem",description:"Race to solve faster"},{icon:Q,title:"Winner Takes All",description:"Win the prize pool"}].map((u,C)=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-[#00ADB5]/20 dark:bg-[#00ADB5]/20 rounded-lg",children:e.jsx(u.icon,{className:"w-4 h-4 text-[#00ADB5]"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white text-sm",children:u.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:u.description})]})]},C))})]})]})},ka=()=>{const t=["#00ADB5","#FFD700","#FF6B6B","#4ECDC4","#45B7D1"];for(let s=0;s<100;s++){const r=document.createElement("div");r.style.cssText=`
      position: fixed;
      width: 10px;
      height: 10px;
      background: ${t[Math.floor(Math.random()*t.length)]};
      left: ${Math.random()*100}vw;
      top: -10px;
      border-radius: ${Math.random()>.5?"50%":"0"};
      pointer-events: none;
      z-index: 9999;
      animation: confetti-fall ${2+Math.random()*2}s ease-out forwards;
    `,document.body.appendChild(r),setTimeout(()=>r.remove(),4e3)}};if(typeof document<"u"&&!document.getElementById("confetti-styles")){const t=document.createElement("style");t.id="confetti-styles",t.textContent=`
    @keyframes confetti-fall {
      to {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }
  `,document.head.appendChild(t)}const Sa=()=>{const{battleId:t}=Ye(),a=be(),{user:s}=xe(),{userprofile:r,getUserWallet:n}=ge(),[m,p]=i.useState(null),[x,y]=i.useState(!0),[f,T]=i.useState(!1),[A,j]=i.useState(null),[E,g]=i.useState(null),[b,d]=i.useState(0),[S,v]=i.useState(!1),[L,O]=i.useState(""),[D,P]=i.useState(!1),[w,N]=i.useState(!1),[F,c]=i.useState(null);i.useEffect(()=>{s?.id&&m?.status==="completed"&&n(s.id).then(I=>{I&&c(I.coins)})},[s?.id,m?.status,n]),i.useEffect(()=>{(async()=>{if(t)try{const M=await W(`/battles/${t}`),B=M.battle||M;if(console.log("Battle results data:",B),!B||!B.participants){a("/dashboard/codearena");return}p(B);const _=B.participants?.find(U=>U.odId===s?.id),V=B.participants?.find(U=>U.odId!==s?.id);j(_||null),g(V||null);const q=B.winnerId===s?.id;T(q),B.status==="forfeited"&&B.forfeitedBy!==s?.id&&v(!0);let z="";if(B.winReason)z=B.winReason;else if(B.status==="forfeited")B.forfeitedBy===s?.id?z="You left the battle":z="Opponent left the battle";else if(_&&V){const U=_.submissionResult?.passedCount||0,H=V.submissionResult?.passedCount||0,J=_.submissionResult?.totalTime||1/0,l=V.submissionResult?.totalTime||1/0;q?U>H?z=`You passed more test cases (${U} vs ${H})`:U===H&&J<l?z="Same test cases passed, but you were faster!":V.hasSubmitted?z="You solved it better!":z="Opponent did not submit":H>U?z=`Opponent passed more test cases (${H} vs ${U})`:U===H&&l<J?z="Same test cases passed, but opponent was faster":_.hasSubmitted?z="Opponent solved it better":z="You did not submit in time"}O(z),d(q?Math.floor(25+Math.random()*10):-Math.floor(15+Math.random()*10)),y(!1),q&&setTimeout(()=>{ka()},500)}catch(M){console.error("Error fetching battle results:",M),y(!1)}})()},[t,s,a]);const u=I=>{const M=Math.floor(I/60),B=I%60;return`${M}m ${B}s`},C=async()=>{if(!(!s||!E||!m||D||w)){P(!0);try{const I=m.entryFee||50,M=m.difficulty||"easy",B=await wa({difficulty:M,entryFee:I,userId:s.id,userName:r?.name||s?.name||"Player",userAvatar:r?.profilePic||r?.avatarUrl||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s.id}`,rating:A?.rating||1e3,originalBattleId:t},E.odId,E.odName);if(B){N(!0),Te.success(`âš”ï¸ Rematch request sent to ${E.odName}! Waiting for response...`,{duration:5e3,icon:"âš”ï¸"});const V=setInterval(async()=>{try{const z=await W(`/battles/${B}`),U=z.battle||z;U?.status==="countdown"&&U?.participants?.length===2?(clearInterval(V),Te.success(`ðŸŽ‰ ${E.odName} accepted the rematch! Starting battle...`,{duration:3e3,icon:"ðŸŽ‰"}),a(`/dashboard/codearena/battle/${B}`)):U?.status==="rejected"&&(clearInterval(V),N(!1),Te.error(`${E?.odName||"Opponent"} declined the rematch request.`,{duration:4e3,icon:"âŒ"}))}catch(z){console.error("Error polling rematch status:",z),clearInterval(V),N(!1)}},5e3);let q=!0;setTimeout(()=>{clearInterval(V),q&&(q=!1,N(!1),Te("Rematch request timed out. Please try again.",{duration:4e3,icon:"â°"}))},3e5)}}catch(I){console.error("Error creating rematch:",I),Te.error("Failed to send rematch request. Please try again."),N(!1)}finally{P(!1)}}};return x?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center",children:e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 py-8 px-4 relative overflow-hidden",children:[e.jsx(o.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>a("/dashboard/codearena/battle"),className:"absolute top-4 right-4 z-50 w-12 h-12 bg-gray-800/80 hover:bg-gray-700 border border-gray-600 rounded-full flex items-center justify-center text-gray-400 hover:text-white transition-all shadow-lg",children:e.jsx(it,{className:"w-6 h-6"})}),e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-10 left-10 w-40 h-40 bg-gradient-to-br from-cyan-500/20 to-transparent rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-40 right-20 w-60 h-60 bg-gradient-to-br from-purple-500/15 to-transparent rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-20 left-20 w-32 h-32 bg-gradient-to-br from-yellow-500/20 to-transparent rounded-full blur-2xl"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[e.jsxs(o.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"text-center mb-10 relative",children:[f?e.jsxs(e.Fragment,{children:[e.jsxs(o.div,{animate:{rotate:[0,-10,10,-10,10,0],scale:[1,1.1,1]},transition:{duration:.8,delay:.3,repeat:1/0,repeatDelay:3},className:"w-40 h-40 mx-auto mb-6 bg-gradient-to-br from-yellow-400 via-orange-400 to-amber-500 rounded-full flex items-center justify-center shadow-2xl shadow-yellow-500/50 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-300/30 to-orange-300/30 rounded-full animate-pulse"}),e.jsx(Q,{className:"w-20 h-20 text-white relative z-10"})]}),e.jsx(o.h1,{initial:{y:20},animate:{y:0},transition:{delay:.5},className:"text-6xl font-bold bg-gradient-to-r from-yellow-400 via-orange-400 to-yellow-500 bg-clip-text text-transparent mb-4",children:"ðŸ† Victory!"}),e.jsx(o.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"text-2xl text-gray-300 mb-4",children:S?"ðŸšª Your opponent left the battle!":"âœ¨ Congratulations! You won the battle! âœ¨"}),S&&e.jsx(o.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.9},className:"text-lg text-yellow-400",children:"Prize coins have been awarded to you!"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"w-36 h-36 mx-auto mb-6 bg-gradient-to-br from-gray-600 via-gray-700 to-gray-800 rounded-full flex items-center justify-center shadow-2xl shadow-gray-500/30 relative overflow-hidden",children:[e.jsx(o.div,{className:"absolute inset-0 bg-gradient-to-r from-gray-500/20 to-gray-400/20 rounded-full",animate:{opacity:[.3,.5,.3]},transition:{duration:2,repeat:1/0}}),e.jsx(De,{className:"w-18 h-18 text-gray-400 relative z-10"})]}),e.jsx(o.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"text-5xl font-bold bg-gradient-to-r from-gray-400 via-gray-500 to-gray-400 bg-clip-text text-transparent mb-4",children:"ðŸ’” Defeat"}),e.jsx(o.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-xl text-gray-300 mb-2",children:"Good effort! Keep practicing!"}),e.jsx(o.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"text-md text-cyan-400",children:"ðŸ’ª Every defeat is a step towards victory!"})]}),L&&e.jsx(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:1},className:`mt-6 px-6 py-3 rounded-xl border ${f?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:e.jsxs("p",{className:"text-lg font-medium",children:["ðŸ“‹ ",L]})})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-gradient-to-br from-gray-800/60 via-gray-900/60 to-black/60 backdrop-blur-sm border border-gray-700/50 rounded-2xl p-8 mb-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-bl from-cyan-500/10 to-transparent rounded-full -translate-y-10 translate-x-10"}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 items-center",children:[e.jsxs(o.div,{initial:{x:-30,opacity:0},animate:{x:0,opacity:1},transition:{delay:.4},className:"text-center",children:[e.jsx(o.div,{whileHover:{scale:1.1,rotate:5},className:`w-24 h-24 mx-auto mb-4 rounded-full flex items-center justify-center text-2xl font-bold text-white shadow-lg ${f?"bg-gradient-to-br from-yellow-400 to-amber-500 ring-4 ring-yellow-500/50 shadow-yellow-500/30":"bg-gradient-to-br from-cyan-400 to-blue-500 ring-2 ring-cyan-500/30 shadow-cyan-500/20"}`,children:r?.name?.[0]||"Y"}),e.jsx("p",{className:"text-white font-bold text-lg",children:r?.name||"You"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["Level ",A?.level||1]}),f&&e.jsxs(o.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.8,type:"spring"},className:"flex items-center justify-center gap-2 mt-2 text-yellow-400",children:[e.jsx(pe,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"ðŸ† Winner"})]})]}),e.jsx("div",{className:"text-center",children:e.jsx(o.div,{animate:{rotateY:[0,180,360]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"VS"})}),e.jsxs(o.div,{initial:{x:30,opacity:0},animate:{x:0,opacity:1},transition:{delay:.4},className:"text-center",children:[e.jsx(o.div,{whileHover:{scale:1.1,rotate:-5},className:`w-24 h-24 mx-auto mb-4 rounded-full flex items-center justify-center text-2xl font-bold text-white shadow-lg ${f?"bg-gradient-to-br from-red-400 to-orange-500 ring-2 ring-red-500/30 shadow-red-500/20":"bg-gradient-to-br from-yellow-400 to-amber-500 ring-4 ring-yellow-500/50 shadow-yellow-500/30"}`,children:E?.odName?.[0]||"O"}),e.jsx("p",{className:"text-white font-bold text-lg",children:E?.odName||"Opponent"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["Level ",E?.level||1]}),!f&&e.jsxs(o.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.8,type:"spring"},className:"flex items-center justify-center gap-2 mt-2 text-yellow-400",children:[e.jsx(pe,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"ðŸ† Winner"})]})]})]})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"bg-gray-800/50 border border-gray-700/50 rounded-2xl p-6 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5 text-cyan-400"}),"Battle Stats"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-2xl font-bold text-white",children:[A?.submissionResult?.passedCount||0,"/",A?.submissionResult?.totalCount||0]})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Tests Passed"})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-2xl font-bold text-white",children:[E?.submissionResult?.passedCount||0,"/",E?.submissionResult?.totalCount||0]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-2xl font-bold text-white",children:u(Math.round((A?.submissionResult?.totalTime||0)/1e3))})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Time Taken"})]})}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-2xl font-bold text-white",children:u(Math.round((E?.submissionResult?.totalTime||0)/1e3))})})]})]})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsx("div",{className:`p-6 rounded-2xl border ${f?"bg-gradient-to-br from-yellow-500/20 to-amber-500/20 border-yellow-500/30":"bg-gray-800/50 border-gray-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Coins Earned"}),e.jsx("p",{className:`text-3xl font-bold ${f?"text-yellow-400":"text-gray-400"}`,children:f?`+${m?.prize||m?.prizePool||0}`:"+0"}),F!==null&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Balance: ",F.toLocaleString()," coins"]})]}),e.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${f?"bg-yellow-500/20":"bg-gray-700/50"}`,children:e.jsx(ee,{className:`w-7 h-7 ${f?"text-yellow-400":"text-gray-500"}`})})]})}),e.jsx("div",{className:`p-6 rounded-2xl border ${b>0?"bg-gradient-to-br from-green-500/20 to-emerald-500/20 border-green-500/30":"bg-gradient-to-br from-red-500/20 to-orange-500/20 border-red-500/30"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Rating Change"}),e.jsxs("p",{className:`text-3xl font-bold ${b>0?"text-green-400":"text-red-400"}`,children:[b>0?"+":"",b]})]}),e.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${b>0?"bg-green-500/20":"bg-red-500/20"}`,children:b>0?e.jsx(qe,{className:"w-7 h-7 text-green-400"}):e.jsx(Tt,{className:"w-7 h-7 text-red-400"})})]})})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"bg-gray-800/50 border border-gray-700/50 rounded-2xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-purple-400"}),e.jsx("span",{className:"text-white font-medium",children:"Experience Gained"})]}),e.jsxs("span",{className:"text-purple-400 font-bold",children:["+",f?50:20," XP"]})]}),e.jsx("div",{className:"h-3 bg-gray-700 rounded-full overflow-hidden",children:e.jsx(o.div,{initial:{width:0},animate:{width:`${f?70:45}%`},transition:{delay:.7,duration:1,ease:"easeOut"},className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full"})}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"350/500 XP to Level Up"})]}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(o.button,{whileHover:w?{}:{scale:1.05,y:-2,boxShadow:"0 20px 40px rgba(239, 68, 68, 0.4)"},whileTap:w?{}:{scale:.98},onClick:C,disabled:D||w,className:`flex-1 flex items-center justify-center gap-3 py-4 px-6 text-white font-bold text-lg rounded-xl shadow-lg transition-all relative overflow-hidden group disabled:cursor-not-allowed ${w?"bg-gradient-to-r from-yellow-600 via-amber-600 to-orange-600 shadow-yellow-500/30":"bg-gradient-to-r from-red-500 via-orange-500 to-amber-500 shadow-red-500/30 hover:shadow-red-500/50"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400/20 to-orange-400/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),D?e.jsx(se,{className:"w-6 h-6 relative animate-spin"}):w?e.jsx(se,{className:"w-6 h-6 relative animate-spin"}):e.jsx(ae,{className:"w-6 h-6 relative"}),e.jsx("span",{className:"relative",children:D?"Sending...":w?`â³ Waiting for ${E?.odName?.split(" ")[0]||"Opponent"}...`:`ðŸ”¥ Rematch ${E?.odName?.split(" ")[0]||"Opponent"}`})]}),e.jsxs(o.button,{whileHover:{scale:1.05,y:-2,boxShadow:"0 20px 40px rgba(59, 130, 246, 0.4)"},whileTap:{scale:.98},onClick:()=>a("/dashboard/codearena/battle"),className:"flex-1 flex items-center justify-center gap-3 py-4 px-6 bg-gradient-to-r from-cyan-500 via-blue-500 to-indigo-600 text-white font-bold text-lg rounded-xl shadow-lg shadow-cyan-500/30 hover:shadow-cyan-500/50 transition-all relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-400/20 to-blue-400/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),e.jsx(ga,{className:"w-6 h-6 relative"}),e.jsx("span",{className:"relative",children:"âš”ï¸ New Battle"})]}),e.jsxs(o.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.98},onClick:()=>a("/dashboard/codearena"),className:"flex-1 flex items-center justify-center gap-3 py-4 px-6 bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-600 hover:to-gray-500 text-white font-bold text-lg rounded-xl border border-gray-600 hover:border-gray-500 shadow-lg transition-all relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-500/20 to-gray-400/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),e.jsx(qt,{className:"w-6 h-6 relative"}),e.jsx("span",{className:"relative",children:"ðŸ  Back to Arena"})]})]})]})]})};function gt(t,a){(a==null||a>t.length)&&(a=t.length);for(var s=0,r=Array(a);s<a;s++)r[s]=t[s];return r}function Ca(t){if(Array.isArray(t))return t}function Aa(t,a,s){return(a=$a(a))in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function Ea(t,a){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var r,n,m,p,x=[],y=!0,f=!1;try{if(m=(s=s.call(t)).next,a!==0)for(;!(y=(r=m.call(s)).done)&&(x.push(r.value),x.length!==a);y=!0);}catch(T){f=!0,n=T}finally{try{if(!y&&s.return!=null&&(p=s.return(),Object(p)!==p))return}finally{if(f)throw n}}return x}}function Ta(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ht(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function pt(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?ht(Object(s),!0).forEach(function(r){Aa(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ht(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Ba(t,a){if(t==null)return{};var s,r,n=Ia(t,a);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(t);for(r=0;r<m.length;r++)s=m[r],a.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Ia(t,a){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(a.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function Da(t,a){return Ca(t)||Ea(t,a)||La(t,a)||Ta()}function Ra(t,a){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function $a(t){var a=Ra(t,"string");return typeof a=="symbol"?a:a+""}function La(t,a){if(t){if(typeof t=="string")return gt(t,a);var s={}.toString.call(t).slice(8,-1);return s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set"?Array.from(t):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?gt(t,a):void 0}}function Pa(t,a,s){return a in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function ft(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function bt(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?ft(Object(s),!0).forEach(function(r){Pa(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ft(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Oa(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return function(r){return a.reduceRight(function(n,m){return m(n)},r)}}function Re(t){return function a(){for(var s=this,r=arguments.length,n=new Array(r),m=0;m<r;m++)n[m]=arguments[m];return n.length>=t.length?t.apply(this,n):function(){for(var p=arguments.length,x=new Array(p),y=0;y<p;y++)x[y]=arguments[y];return a.apply(s,[].concat(n,x))}}}function Ve(t){return{}.toString.call(t).includes("Object")}function Ma(t){return!Object.keys(t).length}function Le(t){return typeof t=="function"}function _a(t,a){return Object.prototype.hasOwnProperty.call(t,a)}function Fa(t,a){return Ve(a)||fe("changeType"),Object.keys(a).some(function(s){return!_a(t,s)})&&fe("changeField"),a}function Wa(t){Le(t)||fe("selectorType")}function za(t){Le(t)||Ve(t)||fe("handlerType"),Ve(t)&&Object.values(t).some(function(a){return!Le(a)})&&fe("handlersType")}function Ha(t){t||fe("initialIsRequired"),Ve(t)||fe("initialType"),Ma(t)&&fe("initialContent")}function Ua(t,a){throw new Error(t[a]||t.default)}var Va={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},fe=Re(Ua)(Va),We={changes:Fa,selector:Wa,handler:za,initial:Ha};function Ya(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};We.initial(t),We.handler(a);var s={current:t},r=Re(Ja)(s,a),n=Re(Ga)(s),m=Re(We.changes)(t),p=Re(qa)(s);function x(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(T){return T};return We.selector(f),f(s.current)}function y(f){Oa(r,n,m,p)(f)}return[x,y]}function qa(t,a){return Le(a)?a(t.current):a}function Ga(t,a){return t.current=bt(bt({},t.current),a),a}function Ja(t,a,s){return Le(a)?a(t.current):Object.keys(s).forEach(function(r){var n;return(n=a[r])===null||n===void 0?void 0:n.call(a,t.current[r])}),s}var Ka={create:Ya},Qa={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function Xa(t){return function a(){for(var s=this,r=arguments.length,n=new Array(r),m=0;m<r;m++)n[m]=arguments[m];return n.length>=t.length?t.apply(this,n):function(){for(var p=arguments.length,x=new Array(p),y=0;y<p;y++)x[y]=arguments[y];return a.apply(s,[].concat(n,x))}}}function Za(t){return{}.toString.call(t).includes("Object")}function es(t){return t||yt("configIsRequired"),Za(t)||yt("configType"),t.urls?(ts(),{paths:{vs:t.urls.monacoBase}}):t}function ts(){console.warn(It.deprecation)}function as(t,a){throw new Error(t[a]||t.default)}var It={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},yt=Xa(as)(It),ss={config:es},rs=function(){for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return function(n){return s.reduceRight(function(m,p){return p(m)},n)}};function Dt(t,a){return Object.keys(a).forEach(function(s){a[s]instanceof Object&&t[s]&&Object.assign(a[s],Dt(t[s],a[s]))}),pt(pt({},t),a)}var ns={type:"cancelation",msg:"operation is manually canceled"};function Qe(t){var a=!1,s=new Promise(function(r,n){t.then(function(m){return a?n(ns):r(m)}),t.catch(n)});return s.cancel=function(){return a=!0},s}var is=["monaco"],ls=Ka.create({config:Qa,isInitialized:!1,resolve:null,reject:null,monaco:null}),Rt=Da(ls,2),Me=Rt[0],Je=Rt[1];function os(t){var a=ss.config(t),s=a.monaco,r=Ba(a,is);Je(function(n){return{config:Dt(n.config,r),monaco:s}})}function cs(){var t=Me(function(a){var s=a.monaco,r=a.isInitialized,n=a.resolve;return{monaco:s,isInitialized:r,resolve:n}});if(!t.isInitialized){if(Je({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Qe(Xe);if(window.monaco&&window.monaco.editor)return $t(window.monaco),t.resolve(window.monaco),Qe(Xe);rs(ds,us)(xs)}return Qe(Xe)}function ds(t){return document.body.appendChild(t)}function ms(t){var a=document.createElement("script");return t&&(a.src=t),a}function us(t){var a=Me(function(r){var n=r.config,m=r.reject;return{config:n,reject:m}}),s=ms("".concat(a.config.paths.vs,"/loader.js"));return s.onload=function(){return t()},s.onerror=a.reject,s}function xs(){var t=Me(function(s){var r=s.config,n=s.resolve,m=s.reject;return{config:r,resolve:n,reject:m}}),a=window.require;a.config(t.config),a(["vs/editor/editor.main"],function(s){var r=s.m||s;$t(r),t.resolve(r)},function(s){t.reject(s)})}function $t(t){Me().monaco||Je({monaco:t})}function gs(){return Me(function(t){var a=t.monaco;return a})}var Xe=new Promise(function(t,a){return Je({resolve:t,reject:a})}),Lt={config:os,init:cs,__getMonacoInstance:gs},hs={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Ze=hs,ps={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},fs=ps;function bs({children:t}){return Se.createElement("div",{style:fs.container},t)}var ys=bs,js=ys;function ws({width:t,height:a,isEditorReady:s,loading:r,_ref:n,className:m,wrapperProps:p}){return Se.createElement("section",{style:{...Ze.wrapper,width:t,height:a},...p},!s&&Se.createElement(js,null,r),Se.createElement("div",{ref:n,style:{...Ze.fullWidth,...!s&&Ze.hide},className:m}))}var vs=ws,Pt=i.memo(vs);function Ns(t){i.useEffect(t,[])}var Ot=Ns;function ks(t,a,s=!0){let r=i.useRef(!0);i.useEffect(r.current||!s?()=>{r.current=!1}:t,a)}var re=ks;function $e(){}function ke(t,a,s,r){return Ss(t,r)||Cs(t,a,s,r)}function Ss(t,a){return t.editor.getModel(Mt(t,a))}function Cs(t,a,s,r){return t.editor.createModel(a,s,r?Mt(t,r):void 0)}function Mt(t,a){return t.Uri.parse(a)}function As({original:t,modified:a,language:s,originalLanguage:r,modifiedLanguage:n,originalModelPath:m,modifiedModelPath:p,keepCurrentOriginalModel:x=!1,keepCurrentModifiedModel:y=!1,theme:f="light",loading:T="Loading...",options:A={},height:j="100%",width:E="100%",className:g,wrapperProps:b={},beforeMount:d=$e,onMount:S=$e}){let[v,L]=i.useState(!1),[O,D]=i.useState(!0),P=i.useRef(null),w=i.useRef(null),N=i.useRef(null),F=i.useRef(S),c=i.useRef(d),u=i.useRef(!1);Ot(()=>{let B=Lt.init();return B.then(_=>(w.current=_)&&D(!1)).catch(_=>_?.type!=="cancelation"&&console.error("Monaco initialization: error:",_)),()=>P.current?M():B.cancel()}),re(()=>{if(P.current&&w.current){let B=P.current.getOriginalEditor(),_=ke(w.current,t||"",r||s||"text",m||"");_!==B.getModel()&&B.setModel(_)}},[m],v),re(()=>{if(P.current&&w.current){let B=P.current.getModifiedEditor(),_=ke(w.current,a||"",n||s||"text",p||"");_!==B.getModel()&&B.setModel(_)}},[p],v),re(()=>{let B=P.current.getModifiedEditor();B.getOption(w.current.editor.EditorOption.readOnly)?B.setValue(a||""):a!==B.getValue()&&(B.executeEdits("",[{range:B.getModel().getFullModelRange(),text:a||"",forceMoveMarkers:!0}]),B.pushUndoStop())},[a],v),re(()=>{P.current?.getModel()?.original.setValue(t||"")},[t],v),re(()=>{let{original:B,modified:_}=P.current.getModel();w.current.editor.setModelLanguage(B,r||s||"text"),w.current.editor.setModelLanguage(_,n||s||"text")},[s,r,n],v),re(()=>{w.current?.editor.setTheme(f)},[f],v),re(()=>{P.current?.updateOptions(A)},[A],v);let C=i.useCallback(()=>{if(!w.current)return;c.current(w.current);let B=ke(w.current,t||"",r||s||"text",m||""),_=ke(w.current,a||"",n||s||"text",p||"");P.current?.setModel({original:B,modified:_})},[s,a,n,t,r,m,p]),I=i.useCallback(()=>{!u.current&&N.current&&(P.current=w.current.editor.createDiffEditor(N.current,{automaticLayout:!0,...A}),C(),w.current?.editor.setTheme(f),L(!0),u.current=!0)},[A,f,C]);i.useEffect(()=>{v&&F.current(P.current,w.current)},[v]),i.useEffect(()=>{!O&&!v&&I()},[O,v,I]);function M(){let B=P.current?.getModel();x||B?.original?.dispose(),y||B?.modified?.dispose(),P.current?.dispose()}return Se.createElement(Pt,{width:E,height:j,isEditorReady:v,loading:T,_ref:N,className:g,wrapperProps:b})}var Es=As;i.memo(Es);function Ts(t){let a=i.useRef();return i.useEffect(()=>{a.current=t},[t]),a.current}var Bs=Ts,ze=new Map;function Is({defaultValue:t,defaultLanguage:a,defaultPath:s,value:r,language:n,path:m,theme:p="light",line:x,loading:y="Loading...",options:f={},overrideServices:T={},saveViewState:A=!0,keepCurrentModel:j=!1,width:E="100%",height:g="100%",className:b,wrapperProps:d={},beforeMount:S=$e,onMount:v=$e,onChange:L,onValidate:O=$e}){let[D,P]=i.useState(!1),[w,N]=i.useState(!0),F=i.useRef(null),c=i.useRef(null),u=i.useRef(null),C=i.useRef(v),I=i.useRef(S),M=i.useRef(),B=i.useRef(r),_=Bs(m),V=i.useRef(!1),q=i.useRef(!1);Ot(()=>{let H=Lt.init();return H.then(J=>(F.current=J)&&N(!1)).catch(J=>J?.type!=="cancelation"&&console.error("Monaco initialization: error:",J)),()=>c.current?U():H.cancel()}),re(()=>{let H=ke(F.current,t||r||"",a||n||"",m||s||"");H!==c.current?.getModel()&&(A&&ze.set(_,c.current?.saveViewState()),c.current?.setModel(H),A&&c.current?.restoreViewState(ze.get(m)))},[m],D),re(()=>{c.current?.updateOptions(f)},[f],D),re(()=>{!c.current||r===void 0||(c.current.getOption(F.current.editor.EditorOption.readOnly)?c.current.setValue(r):r!==c.current.getValue()&&(q.current=!0,c.current.executeEdits("",[{range:c.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),c.current.pushUndoStop(),q.current=!1))},[r],D),re(()=>{let H=c.current?.getModel();H&&n&&F.current?.editor.setModelLanguage(H,n)},[n],D),re(()=>{x!==void 0&&c.current?.revealLine(x)},[x],D),re(()=>{F.current?.editor.setTheme(p)},[p],D);let z=i.useCallback(()=>{if(!(!u.current||!F.current)&&!V.current){I.current(F.current);let H=m||s,J=ke(F.current,r||t||"",a||n||"",H||"");c.current=F.current?.editor.create(u.current,{model:J,automaticLayout:!0,...f},T),A&&c.current.restoreViewState(ze.get(H)),F.current.editor.setTheme(p),x!==void 0&&c.current.revealLine(x),P(!0),V.current=!0}},[t,a,s,r,n,m,f,T,A,p,x]);i.useEffect(()=>{D&&C.current(c.current,F.current)},[D]),i.useEffect(()=>{!w&&!D&&z()},[w,D,z]),B.current=r,i.useEffect(()=>{D&&L&&(M.current?.dispose(),M.current=c.current?.onDidChangeModelContent(H=>{q.current||L(c.current.getValue(),H)}))},[D,L]),i.useEffect(()=>{if(D){let H=F.current.editor.onDidChangeMarkers(J=>{let l=c.current.getModel()?.uri;if(l&&J.find(h=>h.path===l.path)){let h=F.current.editor.getModelMarkers({resource:l});O?.(h)}});return()=>{H?.dispose()}}return()=>{}},[D,O]);function U(){M.current?.dispose(),j?A&&ze.set(m,c.current.saveViewState()):c.current.getModel()?.dispose(),c.current.dispose()}return Se.createElement(Pt,{width:E,height:g,isEditorReady:D,loading:y,_ref:u,className:b,wrapperProps:d})}var Ds=Is,Rs=i.memo(Ds),dt=Rs;const Be={MAX_CODE_LENGTH:5e4,MIN_CODE_LENGTH:10,ALLOWED_LANGUAGES:["python","javascript","cpp","java","c","go","rust"],BLOCKED_PATTERNS:[/import\s+os/gi,/import\s+subprocess/gi,/import\s+sys/gi,/exec\s*\(/gi,/eval\s*\(/gi,/system\s*\(/gi,/__import__/gi,/open\s*\(/gi,/file\s*\(/gi,/socket/gi,/urllib/gi,/requests/gi,/http/gi,/net/gi,/process/gi,/runtime/gi],SUSPICIOUS_KEYWORDS:["rm -rf","del /s","format c:","sudo","chmod 777","while(true)","for(;;)","while True:","infinite","fork()","thread","async","await"]};class Pe extends Error{code;constructor(a,s){super(a),this.name="SecurityError",this.code=s}}class he extends Error{field;constructor(a,s){super(a),this.name="ValidationError",this.field=s}}const $s=t=>t.replace(/<[^>]*>/g,"").replace(/&[^;]+;/g,"").replace(/javascript:/gi,"").replace(/data:/gi,"").trim(),et=t=>{const{code:a,language:s,challengeId:r,battleId:n}=t;if(!Be.ALLOWED_LANGUAGES.includes(s))throw new he(`Unsupported programming language: ${s}`,"language");if(!a||a.length<Be.MIN_CODE_LENGTH)throw new he("Code is too short","code");if(a.length>Be.MAX_CODE_LENGTH)throw new he("Code exceeds maximum length (50KB)","code");for(const x of Be.BLOCKED_PATTERNS)if(x.test(a))throw new Pe("Code contains prohibited functions or imports","BLOCKED_CODE");const m=a.toLowerCase();for(const x of Be.SUSPICIOUS_KEYWORDS)if(m.includes(x.toLowerCase()))throw new Pe(`Code contains suspicious keyword: ${x}`,"SUSPICIOUS_CODE");const p=$s(a);if(r&&!/^[a-zA-Z0-9_-]+$/.test(r))throw new he("Invalid challenge ID format","challengeId");if(n&&!/^[a-zA-Z0-9_-]+$/.test(n))throw new he("Invalid battle ID format","battleId");return{code:p,language:s,challengeId:r,battleId:n}},Ls=async t=>{try{return(await W(`/challenges/${t}`)).challenge||null}catch(a){return console.error("Error fetching challenge:",a),null}},_t=Ls,jt=async t=>{try{return(await W(`/challenges/${t}/testcases`)).testCases||[]}catch(a){return console.error("Error fetching test cases:",a),[]}},Ps=async t=>{try{return(await W(`/challenges/${t}/validation-testcases`)).testCases||[]}catch(a){return console.error("Error fetching validation test cases:",a),[]}},tt=[],Os="https://emkc.org/api/v2/piston",Ft={javascript:{language:"javascript",version:"18.15.0"},python:{language:"python",version:"3.10.0"},python3:{language:"python",version:"3.10.0"},java:{language:"java",version:"15.0.2"},cpp:{language:"c++",version:"10.2.0"},c:{language:"c",version:"10.2.0"},typescript:{language:"typescript",version:"5.0.3"},go:{language:"go",version:"1.16.2"},rust:{language:"rust",version:"1.68.2"},ruby:{language:"ruby",version:"3.0.1"},kotlin:{language:"kotlin",version:"1.8.20"},csharp:{language:"csharp",version:"6.12.0"},swift:{language:"swift",version:"5.3.3"}};async function Ms(t,a,s=""){const r=Date.now();try{const n=Ft[a.toLowerCase()];if(!n)throw new Error(`Unsupported language: ${a}`);const m=await fetch(`${Os}/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({language:n.language,version:n.version,files:[{name:_s(a),content:t}],stdin:s,args:[],compile_timeout:1e4,run_timeout:3e3,compile_memory_limit:-1,run_memory_limit:-1})});if(!m.ok)throw new Error(`API request failed with status ${m.status}`);const p=await m.json(),x=Date.now()-r;return p.compile&&p.compile.code!==0?{success:!1,error:p.compile.stderr||p.compile.output||"Compilation failed",executionTime:x}:p.run.code!==0&&p.run.signal?{success:!1,error:p.run.stderr||p.run.output||"Runtime error",executionTime:x}:{success:!0,output:(p.run.stdout||p.run.output||"").trim(),error:p.run.stderr?p.run.stderr.trim():void 0,executionTime:x}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error occurred",executionTime:Date.now()-r}}}function _s(t){switch(t.toLowerCase()){case"javascript":return"solution.js";case"python":case"python3":return"solution.py";case"java":return"Main.java";case"cpp":case"c":return"solution.cpp";case"typescript":return"solution.ts";case"go":return"solution.go";case"rust":return"solution.rs";case"ruby":return"solution.rb";case"kotlin":return"solution.kt";case"csharp":return"Solution.cs";case"swift":return"solution.swift";default:return"solution.txt"}}async function Fs(t,a,s=""){const r=await Ms(t,a,s);return{output:r.output||"",error:r.error||null,time:r.executionTime?`${(r.executionTime/1e3).toFixed(3)}`:null,memory:null,status:r.success?"Accepted":r.error?"Error":"Unknown"}}const Wt=()=>Object.keys(Ft).filter(t=>t!=="python3").map(t=>({id:t,name:t.charAt(0).toUpperCase()+t.slice(1),languageId:t})),Ws=()=>{const{battleId:t}=Ye(),a=be(),{user:s}=xe();ge();const{setBattleActive:r}=Gt(),[n,m]=i.useState(null),[p,x]=i.useState(!0),[y,f]=i.useState(5),[T,A]=i.useState(0),[j,E]=i.useState(null),[g,b]=i.useState([]),[d,S]=i.useState(""),[v,L]=i.useState("python"),[O,D]=i.useState(!1),[P,w]=i.useState(!1),[N,F]=i.useState(!1);i.useEffect(()=>((n?.status==="active"||n?.status==="countdown")&&!N&&t?r(!0,t):r(!1,null),()=>r(!1,null)),[n?.status,N,r,t]);const[c,u]=i.useState(null),[C,I]=i.useState(!1),[M,B]=i.useState(!1),[_,V]=i.useState(!1),[q,z]=i.useState(0),U=i.useRef(null),H=i.useRef(d),J=i.useRef(g),l=i.useRef(!1),h=i.useRef(null),Y=Wt();i.useEffect(()=>{if(n?.status!=="active"||N)return;const k=R=>(R.preventDefault(),R.returnValue="You are in an active battle! Leaving will cause you to lose. Are you sure?",R.returnValue);return window.addEventListener("beforeunload",k),()=>window.removeEventListener("beforeunload",k)},[n?.status,N]);const K=i.useCallback(k=>{try{h.current||(h.current=new(window.AudioContext||window.webkitAudioContext));const R=h.current,$=R.currentTime;if(k===0){[523.25,659.25,783.99,1046.5].forEach((je,me)=>{const Ee=R.createOscillator(),Ne=R.createGain();Ee.connect(Ne),Ne.connect(R.destination),Ee.type="square",Ee.frequency.setValueAtTime(je,$+me*.05),Ne.gain.setValueAtTime(0,$),Ne.gain.linearRampToValueAtTime(.15,$+me*.05),Ne.gain.linearRampToValueAtTime(.15,$+me*.05+.15),Ne.gain.exponentialRampToValueAtTime(.001,$+.5),Ee.start($+me*.05),Ee.stop($+.6)});const G=R.createOscillator(),X=R.createGain();G.connect(X),X.connect(R.destination),G.type="sawtooth",G.frequency.setValueAtTime(130.81,$),G.frequency.exponentialRampToValueAtTime(65.41,$+.2),X.gain.setValueAtTime(.25,$),X.gain.exponentialRampToValueAtTime(.001,$+.3),G.start($),G.stop($+.4)}else{const Z=k===5?262:k===4?294:k===3?330:k===2?440:587,G=R.createOscillator(),X=R.createGain();G.connect(X),X.connect(R.destination),G.type="square",G.frequency.setValueAtTime(Z*2,$),G.frequency.exponentialRampToValueAtTime(Z,$+.08),X.gain.setValueAtTime(.2,$),X.gain.exponentialRampToValueAtTime(.001,$+.12),G.start($),G.stop($+.15);const je=R.createOscillator(),me=R.createGain();je.connect(me),me.connect(R.destination),je.type="sine",je.frequency.setValueAtTime(Z/2,$),me.gain.setValueAtTime(.15,$),me.gain.exponentialRampToValueAtTime(.001,$+.1),je.start($),je.stop($+.12)}}catch{console.log("Audio not supported")}},[]);i.useEffect(()=>{H.current=d},[d]),i.useEffect(()=>{J.current=g},[g]);const _e={python:`# Battle Mode - Write your solution fast!
def solve():
    n = int(input())
    # Your code here
    print(result)

solve()`,cpp:`#include <bits/stdc++.h>
using namespace std;

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    int n;
    cin >> n;
    // Your code here
    cout << result << endl;
    return 0;
}`,java:`import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int n = sc.nextInt();
        // Your code here
        System.out.println(result);
    }
}`,javascript:`const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

let lines = [];
rl.on('line', (line) => lines.push(line));
rl.on('close', () => {
    const n = parseInt(lines[0]);
    // Your code here
    console.log(result);
});`},ce=i.useCallback(()=>`battle_code_${t}`,[t]),de=i.useCallback(()=>`battle_language_${t}`,[t]);i.useEffect(()=>{if(!t)return;const k=localStorage.getItem(ce()),R=localStorage.getItem(de());k&&(console.log("Restoring code from localStorage"),S(k)),R&&["python","cpp","java","javascript"].includes(R)&&L(R)},[t,ce,de]),i.useEffect(()=>{if(!t||N)return;const k=setInterval(()=>{localStorage.setItem(ce(),d),localStorage.setItem(de(),v)},2e3);return()=>clearInterval(k)},[t,d,v,N,ce,de]),i.useEffect(()=>{N&&t&&(localStorage.removeItem(ce()),localStorage.removeItem(de()))},[N,t,ce,de]),i.useEffect(()=>{if(!t||!s||n?.status!=="active"||N)return;const k=()=>{document.hidden&&(z($=>$+1),V(!0))},R=()=>{n?.status==="active"&&!N&&(z($=>$+1),V(!0))};return document.addEventListener("visibilitychange",k),window.addEventListener("blur",R),()=>{document.removeEventListener("visibilitychange",k),window.removeEventListener("blur",R)}},[t,s,n?.status,N]),i.useEffect(()=>{q>=3&&n?.status==="active"&&!N&&(async()=>{try{await W(`/battles/${t}/forfeit`,{method:"POST"}),a(`/dashboard/codearena/battle/results/${t}`)}catch(R){console.error("Error forfeiting battle:",R)}})()},[q,n?.status,N,t,a]),i.useEffect(()=>{if(!t||!s)return;const k=async()=>{try{const $=await W(`/battles/${t}`);if(!$){a("/dashboard/codearena");return}if(m($),$.challenge&&!j&&$.challenge.description&&(Array.isArray($.challenge.testCases)||Array.isArray($.challenge.test_cases))){E($.challenge);const G=$.challenge.testCases&&$.challenge.testCases.length>0?$.challenge.testCases.map(X=>({input:X.input,output:X.expectedOutput||X.output||X.expected_output||""})):($.challenge.test_cases||[]).map(X=>({input:X.input,output:X.expected_output||X.output||""}));b(G)}const Z=$.participants.find(G=>G.odId===s?.id);Z?.hasSubmitted&&!N&&(F(!0),Z.submissionResult&&u({success:Z.submissionResult.passed,passed:Z.submissionResult.passed,status:Z.submissionResult.passed?"Accepted":"Wrong Answer",passedCount:Z.submissionResult.passedCount,totalCount:Z.submissionResult.totalCount,totalTime:Z.submissionResult.totalTime,executionTime:Z.submissionResult.totalTime})),$.forfeitedBy&&$.forfeitedBy!==s?.id&&B(!0),($.status==="completed"||$.status==="forfeited")&&a(`/dashboard/codearena/battle/results/${t}`),x(!1)}catch($){console.error("Failed to fetch battle data",$),a("/dashboard/codearena")}};k();const R=setInterval(k,3e3);return()=>clearInterval(R)},[t,s,N,j]),i.useEffect(()=>{const k=async R=>{if(n?.status==="active"&&!N&&!l.current)return t&&(localStorage.setItem(ce(),H.current),localStorage.setItem(de(),v),localStorage.setItem(`battle_autosubmit_${t}`,"true")),R.preventDefault(),R.returnValue="Your code will be auto-submitted when you return. Continue?",R.returnValue};return window.addEventListener("beforeunload",k),()=>{window.removeEventListener("beforeunload",k)}},[n?.status,t,N,v,ce,de]),i.useEffect(()=>{if(!t||!s||!n||N||l.current)return;if(localStorage.getItem(`battle_autosubmit_${t}`)==="true"&&n.status==="active"&&J.current.length>0){console.log("Auto-submitting code after page refresh..."),localStorage.removeItem(`battle_autosubmit_${t}`);const R=setTimeout(()=>{!N&&!l.current&&Ke()},1e3);return()=>clearTimeout(R)}},[t,s,n?.status,N,g.length]),i.useEffect(()=>{if(n?.status==="countdown"){if(y>0){K(y);const k=setTimeout(()=>f(y-1),1200);return()=>clearTimeout(k)}else if(y===0){K(0);const k=setTimeout(async()=>{t&&await W(`/battles/${t}/start`,{method:"POST"})},1500);return()=>clearTimeout(k)}}},[n?.status,y,t,K]),i.useEffect(()=>{n?.status==="countdown"&&f(3)},[n?.status]),i.useEffect(()=>{if(n?.status==="active"&&n.startTime){const k=new Date(n.startTime).getTime(),R=n.timeLimit*1e3;return U.current=setInterval(()=>{const Z=Date.now()-k,G=Math.max(0,R-Z);A(Math.ceil(G/1e3)),G<=0&&(U.current&&clearInterval(U.current),zt())},1e3),()=>{U.current&&clearInterval(U.current)}}},[n?.status,n?.startTime,n?.timeLimit]),i.useEffect(()=>{S(_e[v]||_e.python)},[v]);const zt=async()=>{!N&&n&&await Ke()},Ht=async()=>{if(!(!s||!n||!t||C||!window.confirm("âš ï¸ Are you sure you want to leave?\\n\\nLeaving will forfeit the match and your opponent will win the prize!"))){I(!0);try{await W(`/battles/${t}/forfeit`,{method:"POST"}),a("/dashboard/codearena")}catch(R){console.error("Error forfeiting battle:",R),alert("Failed to leave battle. Please try again."),I(!1)}}},Ke=async()=>{if(!(!s||!n||P||N||!t||l.current)){if(!g||g.length===0){u({success:!1,passed:!1,status:"Error",error:"No test cases available. Please try again.",passedCount:0,totalCount:0,totalTime:0,executionTime:0});return}l.current=!0,w(!0),localStorage.removeItem(`battle_autosubmit_${t}`);try{const k=await W(`/battles/${t}/submit`,{method:"POST",body:JSON.stringify({code:d,language:v})});u({success:k.passed,passed:k.passed,status:k.passed?"Accepted":"Wrong Answer",passedCount:k.passedCount,totalCount:k.totalCount,totalTime:k.totalTime,executionTime:k.totalTime}),F(!0)}catch(k){console.error("Battle submission error:",k);let R="Submission failed. Please try again.";k instanceof Pe?R=`Security Error: ${k.message}`:k instanceof he?R=`Validation Error: ${k.message}`:k instanceof Error&&(k.message.includes("API request failed")?R="âš ï¸ Code execution service temporarily unavailable. Please try again.":k.message.includes("429")||k.message.includes("Too Many Requests")?R="â³ Too many submissions. Please wait a moment and try again.":R=k.message),u({success:!1,passed:!1,status:"Error",error:R,passedCount:0,totalCount:g.length,totalTime:0,executionTime:0})}w(!1),l.current=!1,t&&(localStorage.removeItem(ce()),localStorage.removeItem(de()))}},Ut=k=>{const R=Math.floor(k/60),$=k%60;return`${R.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}`},Vt=()=>n?.participants.find(k=>k.odId!==s?.id),Yt=()=>n?.participants.find(k=>k.odId===s?.id);if(console.log("Battle status:",n?.status,"Countdown:",y,"Loading:",p),p)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(se,{className:"w-16 h-16 text-cyan-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Loading battle..."})]})});if(n?.status==="countdown"&&y>=0)return console.log("Showing countdown overlay!",y),e.jsxs("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(20)].map((k,R)=>e.jsx(o.div,{className:"absolute w-2 h-2 bg-cyan-400/30 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-200],scale:[0,1,0],opacity:[0,1,0]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:R*.1}},R))}),e.jsx(o.div,{className:"absolute inset-0 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},children:[1,2,3].map(k=>e.jsx(o.div,{className:"absolute border-2 border-cyan-500/20 rounded-full",style:{width:k*200,height:k*200},animate:{scale:[1,1.5,1],opacity:[.3,.1,.3]},transition:{duration:2,repeat:1/0,delay:k*.3}},k))}),e.jsx(o.div,{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/10 via-purple-500/10 to-[#00d4ff]/10",animate:{opacity:[.3,.5,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),e.jsx(le,{mode:"wait",children:e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"text-center z-10",children:[e.jsx(o.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},className:"mb-6",children:e.jsx(o.div,{animate:{textShadow:["0 0 20px rgba(0, 173, 181, 0.5)","0 0 40px rgba(0, 173, 181, 0.8)","0 0 20px rgba(0, 173, 181, 0.5)"]},transition:{duration:1.5,repeat:1/0},className:"text-2xl font-bold text-cyan-400 tracking-widest",children:"âš”ï¸ BATTLE ARENA âš”ï¸"})}),e.jsxs("div",{className:"flex items-center justify-center gap-8 mb-8",children:[e.jsxs(o.div,{className:"text-center",initial:{x:-100,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},children:[e.jsx(o.div,{className:"w-20 h-20 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center mb-2 shadow-lg shadow-cyan-500/50",animate:{boxShadow:["0 0 20px rgba(0, 173, 181, 0.5)","0 0 40px rgba(0, 173, 181, 0.8)","0 0 20px rgba(0, 173, 181, 0.5)"]},transition:{duration:1.5,repeat:1/0},children:e.jsx("span",{className:"text-white font-bold text-2xl",children:n.participants[0]?.odName?.charAt(0)||""})}),e.jsx("p",{className:"text-cyan-400 font-semibold",children:n.participants[0]?.odName}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["Rating: ",n.participants[0]?.rating||1e3]})]}),e.jsx(o.div,{className:"text-cyan-400 text-5xl font-black",animate:{scale:[1,1.2,1],rotate:[0,5,-5,0],textShadow:["0 0 30px rgba(255, 0, 0, 0.5)","0 0 60px rgba(255, 0, 0, 0.8)","0 0 30px rgba(255, 0, 0, 0.5)"]},transition:{duration:1,repeat:1/0},style:{background:"linear-gradient(to right, #00ADB5, #ff4444, #00ADB5)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"VS"}),e.jsxs(o.div,{className:"text-center",initial:{x:100,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},children:[e.jsx(o.div,{className:"w-20 h-20 rounded-full bg-gradient-to-br from-red-400 to-orange-500 flex items-center justify-center mb-2 shadow-lg shadow-red-500/50",animate:{boxShadow:["0 0 20px rgba(239, 68, 68, 0.5)","0 0 40px rgba(239, 68, 68, 0.8)","0 0 20px rgba(239, 68, 68, 0.5)"]},transition:{duration:1.5,repeat:1/0},children:e.jsx("span",{className:"text-white font-bold text-2xl",children:n.participants[1]?.odName?.charAt(0)||""})}),e.jsx("p",{className:"text-red-400 font-semibold",children:n.participants[1]?.odName}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["Rating: ",n.participants[1]?.rating||1e3]})]})]}),e.jsx(o.p,{className:"text-gray-400 text-xl mb-6",children:y>0?"Battle starts in":""}),e.jsx(o.div,{initial:{opacity:.3},animate:{opacity:[.3,1,.3,1],color:y===0?"#22c55e":y===1?"#ef4444":y===2?"#f59e0b":"#06b6d4"},transition:{opacity:{duration:1,times:[0,.3,.6,1]},color:{duration:.3}},className:"text-9xl font-black mb-6",style:{textShadow:"0 0 50px currentColor, 0 0 100px currentColor",filter:"drop-shadow(0 0 30px currentColor)"},children:y===0?"âš”ï¸ FIGHT! âš”ï¸":y},`countdown-${y}`),y===0&&e.jsx(o.div,{className:"absolute inset-0 bg-white pointer-events-none",initial:{opacity:.8},animate:{opacity:0},transition:{duration:.5}}),e.jsx(o.p,{className:"text-gray-400 text-lg",children:y===0?"ðŸ”¥ Show your coding skills! ðŸ”¥":"âš¡ Get ready to code!"}),e.jsxs(o.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"mt-8 flex items-center justify-center gap-2 text-yellow-400",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-bold",children:["Prize: ",n.prize," coins"]})]})]},y)})]});const ye=Vt(),Fe=Yt();return e.jsxs("div",{className:"h-screen bg-gray-900 flex flex-col overflow-hidden -mx-4 -mt-6",children:[e.jsxs("header",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Fe?.odProfilePic||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s?.id}`,alt:"You",className:"w-10 h-10 rounded-full border-2 border-cyan-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:Fe?.odName||"You"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Rating: ",Fe?.rating||1e3]})]}),Fe?.hasSubmitted&&e.jsx(te,{className:"w-5 h-5 text-green-400"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-3xl font-bold ${T<=60?"text-red-400 animate-pulse":"text-white"}`,children:Ut(T)}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:n?.challenge?.title||"Loading challenge..."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[ye?.hasSubmitted&&e.jsx(te,{className:"w-5 h-5 text-green-400"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white font-medium",children:ye?.odName||"Opponent"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Rating: ",ye?.rating||1e3]})]}),e.jsx("img",{src:ye?.odProfilePic||`https://api.dicebear.com/7.x/avataaars/svg?seed=${ye?.odId}`,alt:"Opponent",className:"w-10 h-10 rounded-full border-2 border-red-400"})]})]}),e.jsxs("div",{className:"flex justify-center mt-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1 bg-yellow-500/20 border border-yellow-500/30 rounded-full",children:[e.jsx(Q,{className:"w-4 h-4 text-yellow-400"}),e.jsxs("span",{className:"text-yellow-400 font-bold",children:[n?.prize||0," coins"]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 text-green-400 bg-green-500/10 rounded-full border border-green-500/20",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Secure Battle"})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-3 bg-gray-800/50 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-cyan-400"}),j?.title||"Loading Challenge..."]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-700 text-gray-300 rounded",children:n?.difficulty})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsx("div",{className:"bg-gray-800/80 rounded-xl shadow-lg border border-cyan-900/30 p-5 mb-4 max-h-96 overflow-y-auto custom-scrollbar",children:e.jsx("div",{className:"prose prose-invert prose-base max-w-none problem-statement-prose",dangerouslySetInnerHTML:{__html:j?.problemStatement||j?.description||'<p class="text-white-400">Loading challenge...</p>'}})}),g.length>0&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("h4",{className:"text-white font-medium",children:"Sample Cases"}),g.slice(0,2).map((k,R)=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 text-sm",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Input:"}),e.jsx("pre",{className:"text-cyan-400 font-mono mt-1",children:k.input})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Output:"}),e.jsx("pre",{className:"text-green-400 font-mono mt-1",children:k.output})]})]},R))]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col border-b border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-2 bg-gray-800/50 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium text-sm",children:"Your Code"}),N&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-400",children:[e.jsx(te,{className:"w-3 h-3"}),"Submitted"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>D(!O),disabled:N,className:"flex items-center gap-2 px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm disabled:opacity-50",children:[e.jsx("span",{className:"text-white capitalize",children:v}),e.jsx(ot,{className:"w-3 h-3 text-gray-400"})]}),e.jsx(le,{children:O&&e.jsx(o.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"absolute right-0 top-full mt-1 w-36 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 overflow-hidden",children:Y.filter(k=>["python","cpp","java","javascript"].includes(k.id)).map(k=>e.jsx("button",{onClick:()=>{L(k.id),D(!1)},className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 ${v===k.id?"text-cyan-400":"text-white"}`,children:k.name},k.id))})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(dt,{height:"100%",language:v==="cpp"?"cpp":v,value:d,onChange:k=>!N&&S(k||""),theme:"vs-dark",options:{fontSize:13,fontFamily:"JetBrains Mono, Fira Code, Consolas, monospace",minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",automaticLayout:!0,tabSize:4,readOnly:N,padding:{top:8}}})})]}),e.jsx("div",{className:"h-32 bg-gray-800/50 p-4 overflow-y-auto",children:c?e.jsxs("div",{className:`p-3 rounded-lg ${c.passed?"bg-green-900/20 border border-green-500/30":"bg-red-900/20 border border-red-500/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c.passed?e.jsx(te,{className:"w-5 h-5 text-green-400"}):e.jsx(ve,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:`font-medium ${c.passed?"text-green-400":"text-red-400"}`,children:c.passed?"All Tests Passed!":"Some Tests Failed"})]}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[c.passedCount," / ",c.totalCount," test cases â€¢ Time: ",(c.totalTime||0).toFixed(0),"ms"]}),ye?.hasSubmitted?e.jsx("p",{className:"text-sm text-cyan-400 mt-2",children:"Waiting for results..."}):e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Waiting for opponent to submit..."})]}):e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("p",{className:"text-sm",children:"Submit your code to see results"}),ye?.hasSubmitted&&e.jsx("p",{className:"text-xs text-yellow-400 mt-2",children:"âš ï¸ Opponent has already submitted!"})]})})]})]}),e.jsx(le,{children:M&&e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:e.jsxs(o.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-gray-800 rounded-2xl p-8 max-w-md w-full mx-4 text-center border border-green-500/30",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-green-500/20 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-10 h-10 text-green-400"})}),e.jsx("h3",{className:"text-2xl font-bold text-green-400 mb-2",children:"ðŸŽ‰ You Win!"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Your opponent left the battle."}),e.jsxs("p",{className:"text-yellow-400 font-bold text-xl mb-6",children:["+",n?.prize," coins awarded!"]}),e.jsx("button",{onClick:()=>a("/dashboard/codearena"),className:"w-full py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all",children:"Back to Arena"})]})})}),e.jsxs("div",{className:"bg-gray-800 border-t border-gray-700 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:Ht,disabled:C||n?.status==="completed",className:"flex items-center gap-2 px-4 py-2 bg-red-500/20 border border-red-500/30 text-red-400 rounded-lg hover:bg-red-500/30 transition-all disabled:opacity-50",children:[C?e.jsx(se,{className:"w-4 h-4 animate-spin"}):e.jsx(Jt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:C?"Leaving...":"Leave Battle"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsxs("span",{children:["Time Limit: ",n?.timeLimit?Math.floor(n.timeLimit/60):15," min"]})]})]}),e.jsx(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:Ke,disabled:P||N,className:`flex items-center gap-2 px-6 py-2.5 rounded-lg font-medium transition-all ${N?"bg-green-600 text-white cursor-not-allowed":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white"} disabled:opacity-70`,children:P?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-4 h-4 animate-spin"}),"Submitting..."]}):N?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4"}),"Submitted"]}):e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"w-4 h-4"}),"Submit Solution"]})})]}),e.jsx("style",{children:`
        .problem-statement-prose, .problem-statement-prose *, .problem-statement-prose h1, .problem-statement-prose h2, .problem-statement-prose h3 {
          color: #fff !important;
        }
        .problem-statement-prose h1, .problem-statement-prose h2, .problem-statement-prose h3 {
          margin-top: 1.2em;
          margin-bottom: 0.5em;
        }
        .problem-statement-prose ul, .problem-statement-prose ol {
          margin-left: 1.5em;
          margin-bottom: 1em;
        }
        .problem-statement-prose pre, .problem-statement-prose code {
          background: #1e293b;
          color: #facc15;
          border-radius: 0.3em;
          padding: 0.3em 0.6em;
          font-size: 1em;
        }
        .problem-statement-prose p {
          margin: 0.7em 0;
          line-height: 1.7;
        }
        .problem-statement-prose table {
          background: #0f172a;
          border-radius: 0.3em;
        }
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #334155;
          border-radius: 4px;
        }
      `}),e.jsx(le,{children:_&&e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx(o.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-gray-800 border-2 border-red-500 rounded-2xl p-6 max-w-md w-full shadow-2xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-500/20 rounded-full flex items-center justify-center",children:e.jsx(Ue,{className:"w-8 h-8 text-red-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"âš ï¸ Warning!"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"You switched away from the battle! This is not allowed during an active battle."}),e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-3 mb-4",children:[e.jsxs("p",{className:"text-red-400 font-semibold",children:["Tab switches: ",q,"/3"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:q>=3?"You have been disqualified!":`${3-q} more switch(es) and you will automatically lose!`})]}),e.jsx("button",{onClick:()=>V(!1),className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-bold rounded-xl hover:shadow-lg transition-all",children:"I Understand, Continue Battle"})]})})})})]})};class zs{BACKEND_URL="https://nextstepbackend-qhxw.onrender.com";async executeCode(a,s,r){const n=localStorage.getItem("authToken");if(!n)throw new Error("Authentication required");const m=et({code:a,language:s});try{const p=await fetch(`${this.BACKEND_URL}/api/execute`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({source_code:m.code,language_id:this.getLanguageId(s),stdin:r||""})});if(!p.ok)throw new Error(`Execution failed: ${p.statusText}`);return await p.json()}catch(p){throw console.error("Code execution error:",p),new Error("Failed to execute code. Please try again.")}}async submitChallenge(a,s,r,n,m,p,x){if(!localStorage.getItem("authToken"))throw new Error("Authentication required");const f=et({code:s,language:r,challengeId:a});try{const T=await W(`/challenges/${a}/submit`,{method:"POST",body:JSON.stringify({code:f.code,language:r,testCases:n,coinReward:m,title:p,difficulty:x})});return{success:T.success||!1,passed:T.passed||T.passedCount||0,total:T.total||T.totalCount||0,passedCount:T.passedCount||T.passed||0,totalCount:T.totalCount||T.total||0,message:T.message||(T.success?"All test cases passed!":"Some test cases failed"),coinsChanged:T.coinsChanged||0,testResults:T.testResults}}catch(T){throw console.error("Challenge submission error:",T),new Error("Failed to submit solution. Please try again.")}}async submitBattleSolution(a,s,r){if(!localStorage.getItem("authToken"))throw new Error("Authentication required");const m=et({code:s,language:r,battleId:a});try{return await W(`/battles/${a}/submit`,{method:"POST",body:JSON.stringify({code:m.code,language:r})})}catch(p){throw console.error("Battle submission error:",p),new Error("Failed to submit battle solution. Please try again.")}}getLanguageId(a){return{javascript:63,python:71,java:62,cpp:54,c:50,csharp:51,ruby:72,go:60,rust:73,php:68,swift:83,kotlin:78}[a.toLowerCase()]||63}async verifyBattleEntry(a,s){try{return(await W(`/battles/verify-entry?userId=${a}&fee=${s}`)).canEnter||!1}catch(r){return console.error("Battle entry verification error:",r),!1}}}const rt=new zs,Hs=[{id:"python",name:"Python"},{id:"cpp",name:"C++"},{id:"java",name:"Java"},{id:"javascript",name:"JavaScript"}],Us=()=>{const{challengeId:t}=Ye(),a=be(),s=lt(),{user:r}=xe();ge();const[n,m]=i.useState(null),[p,x]=i.useState([]),[y,f]=i.useState(!0),[T,A]=i.useState(""),[j,E]=i.useState("python"),[g,b]=i.useState(!1),[d,S]=i.useState(!1),[v,L]=i.useState(!1),[O,D]=i.useState(null),[P,w]=i.useState(null),[N,F]=i.useState(""),[c,u]=i.useState(!1),[C,I]=i.useState("description"),[M,B]=i.useState(!1),[_,V]=i.useState(!1),q=Hs,z={python:`# Write your solution here
def solve():
    # Read input
    n = int(input())
    
    # Your code here
    result = n
    
    # Print output
    print(result)

solve()`,cpp:`#include <bits/stdc++.h>
using namespace std;

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    
    // Read input
    int n;
    cin >> n;
    
    // Your code here
    int result = n;
    
    // Print output
    cout << result << endl;
    
    return 0;
}`,java:`import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        
        // Read input
        int n = sc.nextInt();
        
        // Your code here
        int result = n;
        
        // Print output
        System.out.println(result);
    }
}`,javascript:`// Read input from stdin
const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

let lines = [];
rl.on('line', (line) => {
    lines.push(line);
});

rl.on('close', () => {
    // Parse input
    const n = parseInt(lines[0]);
    
    // Your code here
    const result = n;
    
    // Print output
    console.log(result);
});`};i.useEffect(()=>{(async()=>{if(t){f(!0);try{const h=s.state?.challenge;if(h)m(h),h.testCases&&x(Array.isArray(h.testCases)?h.testCases:[]);else{const Y=await _t(t);if(Y){m(Y);const K=await jt(t);x(K)}else m(null)}f(!1)}catch(h){console.error("Error loading challenge:",h),m(null),f(!1)}}})()},[t,s]),i.useEffect(()=>{A(z[j]||z.python)},[j]);const U=async()=>{S(!0),w(null),D(null);try{const l=c?N:p[0]?.input||"",h=await rt.executeCode(T,j,l);w(h)}catch(l){let h="Failed to run code. Please try again.";l instanceof Pe?h=`Security Error: ${l.message}`:l instanceof he?h=`Validation Error: ${l.message}`:l instanceof Error&&(h=l.message),w({output:"",stderr:h,time:"0",memory:"0",status:"Error"})}S(!1)},H=async()=>{if(!t){alert("Invalid challenge ID");return}if(p.length===0){alert("No test cases available for this problem. Please try again or use the Run button with custom input.");return}L(!0),D(null),w(null);try{const l=await rt.submitChallenge(t,T,j,p.map(h=>({input:h.input,expected_output:h.expectedOutput,expectedOutput:h.expectedOutput})),n?.coinReward,n?.title,n?.difficulty);l.success&&n&&r?(V(!0),D({success:!0,passedCount:l.passedCount,totalCount:l.totalCount,totalTime:0,totalMemory:0,results:l.testResults?.map((h,Y)=>({testCase:Y+1,passed:h.passed,input:h.input,expected:h.expected,output:h.output}))||p.map((h,Y)=>({testCase:Y+1,passed:!0}))}),l.coinsChanged>0&&alert(`ðŸŽ‰ ${l.message}`)):(D({success:!1,passedCount:l.passedCount,totalCount:l.totalCount,totalTime:0,totalMemory:0,results:l.testResults?.map((h,Y)=>({testCase:Y+1,passed:h.passed,input:h.input,expected:h.expected,output:h.output,error:h.error}))||p.map((h,Y)=>({testCase:Y+1,passed:!1}))}),l.coinsChanged<0?alert(`âŒ ${l.message}`):l.message&&alert(l.message))}catch(l){console.error("Submission error:",l);let h="Submission failed. Please try again.";l instanceof Pe?h=`Security Error: ${l.message}`:l instanceof he?h=`Validation Error: ${l.message}`:l instanceof Error&&(h=l.message),D({success:!1,results:[],passedCount:0,totalCount:p.length,totalTime:0,totalMemory:0,compilationError:h})}L(!1)},J=l=>{switch(l){case"easy":return"text-green-400 bg-green-400/10 border-green-400/30";case"medium":return"text-yellow-400 bg-yellow-400/10 border-yellow-400/30";case"hard":return"text-red-400 bg-red-400/10 border-red-400/30";case"expert":return"text-purple-400 bg-purple-400/10 border-purple-400/30";default:return"text-gray-400 bg-gray-400/10 border-gray-400/30"}};return y?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"h-screen bg-gray-900 flex flex-col overflow-hidden -mx-4 -mt-6",children:[e.jsxs("header",{className:"bg-gradient-to-r from-gray-800 via-gray-900 to-black border-b border-gray-700 px-4 py-3 flex items-center justify-between relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-20 bg-gradient-to-bl from-cyan-500/20 to-transparent rounded-full -translate-y-10 translate-x-20"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>a("/dashboard/codearena/practice"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(St,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg font-bold text-white flex items-center gap-2",children:[n?.title||"Loading...",_&&e.jsx(te,{className:"w-5 h-5 text-green-400"})]}),e.jsx("div",{className:"flex items-center gap-3 text-sm",children:n&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full border ${J(n.difficulty)}`,children:n.difficulty?n.difficulty.charAt(0).toUpperCase()+n.difficulty.slice(1):"Unknown"}),e.jsxs("span",{className:"text-gray-400",children:["Category: ",n.category||"N/A"]}),e.jsxs("span",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(ee,{className:"w-4 h-4"}),n.coinReward]})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>b(!g),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-600 hover:to-gray-500 rounded-lg transition-all shadow-lg border border-gray-600 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/10 to-blue-500/10"}),e.jsx(ie,{className:"w-4 h-4 text-cyan-400 relative"}),e.jsx("span",{className:"text-white capitalize font-semibold relative",children:j}),e.jsx(ot,{className:"w-4 h-4 text-gray-400 relative"})]}),e.jsx(le,{children:g&&e.jsx(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 top-full mt-2 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 overflow-hidden",children:q.filter(l=>["python","cpp","java","javascript"].includes(l.id)).map(l=>e.jsx("button",{onClick:()=>{E(l.id),b(!1)},className:`w-full px-4 py-2 text-left hover:bg-gray-700 transition-colors ${j===l.id?"text-cyan-400 bg-gray-700/50":"text-white"}`,children:l.name},l.id))})})]}),n&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-gray-400 hover:text-white transition-colors cursor-pointer",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Database Challenge"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-green-400 bg-green-500/10 rounded-lg border border-green-500/20",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Secure Mode"})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/2 border-r border-gray-700 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-700",children:[e.jsx("button",{onClick:()=>I("description"),className:`px-4 py-3 text-sm font-medium transition-colors ${C==="description"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Description"}),e.jsx("button",{onClick:()=>I("submissions"),className:`px-4 py-3 text-sm font-medium transition-colors ${C==="submissions"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Submissions"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:C==="description"?e.jsx("div",{className:"space-y-4",children:y?e.jsx("div",{className:"flex items-center justify-center py-10",children:e.jsx(se,{className:"w-8 h-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"prose prose-invert max-w-none problem-statement",dangerouslySetInnerHTML:{__html:n?.problemStatement||""}}),n?.examples&&n.examples.length>0&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Examples"}),n.examples.map((l,h)=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-2 divide-x divide-gray-700",children:[e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Input"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.input})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Output"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.output})]})]}),l.explanation&&e.jsxs("div",{className:"px-3 pb-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Explanation"}),e.jsx("p",{className:"text-sm text-gray-300",children:l.explanation})]})]},h))]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Sample Test Cases (",p.length,")"]}),e.jsxs("button",{onClick:async()=>{if(t){f(!0);const l=await jt(t);x(l),f(!1)}},className:"flex items-center gap-1 text-sm text-cyan-400 hover:text-cyan-300",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Refresh"]})]}),p.length>0?p.map((l,h)=>e.jsx(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:h*.1},className:"bg-gradient-to-br from-gray-800/80 to-gray-900/80 rounded-xl border border-gray-700 overflow-hidden shadow-lg hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"grid grid-cols-2 divide-x divide-gray-700",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-900/20 to-transparent",children:[e.jsx("p",{className:"text-xs text-[#00ADB5] mb-2 font-semibold flex items-center gap-1",children:"ðŸ“ Input"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap bg-gray-900/50 p-2 rounded",children:l.input})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-900/20 to-transparent",children:[e.jsx("p",{className:"text-xs text-green-400 mb-2 font-semibold flex items-center gap-1",children:"âœ… Output"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap bg-gray-900/50 p-2 rounded",children:l.expectedOutput})]})]})},h)):e.jsxs("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 p-6 text-center",children:[e.jsx("p",{className:"text-gray-400 mb-2",children:"No test cases loaded yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Click Refresh to load test cases or use custom input"})]})]}),n?.tags&&n.tags.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{onClick:()=>B(!M),className:"flex items-center gap-2 text-yellow-400 hover:text-yellow-300 transition-colors",children:[e.jsx(Ct,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:M?"Hide Hints":"Show Hints (Tags)"})]}),e.jsx(le,{children:M&&e.jsx(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 flex flex-wrap gap-2",children:n.tags.map((l,h)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-700 text-gray-300 rounded",children:l},h))})})]})]})}):e.jsxs("div",{className:"text-center py-10 text-gray-400",children:[e.jsx(Q,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Your submission history will appear here"})]})})]}),e.jsxs("div",{className:"w-1/2 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(dt,{height:"100%",language:j==="cpp"?"cpp":j,value:T,onChange:l=>A(l||""),theme:"vs-dark",options:{fontSize:14,fontFamily:"JetBrains Mono, Fira Code, Consolas, monospace",minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",glyphMargin:!1,folding:!0,lineDecorationsWidth:10,automaticLayout:!0,tabSize:4,wordWrap:"on",padding:{top:10}}})}),e.jsxs("div",{className:"border-t border-gray-700 px-4 py-2 flex items-center gap-4 bg-gray-800/50",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:l=>u(l.target.checked),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded accent-cyan-500"}),"Custom Input"]}),c&&e.jsx("textarea",{value:N,onChange:l=>F(l.target.value),placeholder:"Enter custom input...",className:"flex-1 px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm text-white resize-none h-8"})]}),e.jsx("div",{className:"h-48 border-t border-gray-700 bg-gray-800/50 overflow-y-auto",children:O||P?e.jsxs("div",{className:"p-4",children:[P&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${P.error?"text-red-400":"text-green-400"}`,children:P.status}),P.time&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(we,{className:"w-3 h-3"}),P.time,"s"]}),P.memory&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(Oe,{className:"w-3 h-3"}),(P.memory/1024).toFixed(2)," MB"]})]}),P.output&&e.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Output:"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:P.output})]}),P.stderr&&e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Error:"}),e.jsx("pre",{className:"text-sm text-red-300 font-mono whitespace-pre-wrap",children:P.stderr})]})]}),O&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${O.success?"bg-green-900/20 border border-green-500/30":"bg-red-900/20 border border-red-500/30"}`,children:[O.success?e.jsx(te,{className:"w-6 h-6 text-green-400"}):e.jsx(ve,{className:"w-6 h-6 text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${O.success?"text-green-400":"text-red-400"}`,children:O.success?"All Tests Passed!":"Some Tests Failed"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[O.passedCount," / ",O.totalCount," test cases passed"]})]}),O.success&&n&&e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-yellow-400",children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-bold",children:["+",n.coinReward]})]})]}),O.compilationError&&e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Compilation Error:"}),e.jsx("pre",{className:"text-sm text-red-300 font-mono whitespace-pre-wrap",children:O.compilationError})]}),O.results&&O.results.length>0&&e.jsx("div",{className:"space-y-2",children:O.results.map((l,h)=>e.jsx("div",{className:`p-2 rounded border ${l.passed?"bg-green-900/10 border-green-500/20":"bg-red-900/10 border-red-500/20"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[l.passed?e.jsx(te,{className:"w-4 h-4 text-green-400"}):e.jsx(ve,{className:"w-4 h-4 text-red-400"}),e.jsxs("span",{className:"text-sm text-white",children:["Test Case ",l.testCase]}),l.time&&e.jsxs("span",{className:"text-xs text-gray-400",children:[l.time,"s"]})]})},h))})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsx("p",{className:"text-sm",children:"Run or submit your code to see results"})})}),e.jsxs("div",{className:"border-t border-gray-700 p-4 flex items-center justify-between bg-gray-800",children:[e.jsxs("button",{onClick:()=>A(z[j]||""),className:"flex items-center gap-2 px-4 py-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Reset Code"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(o.button,{whileHover:{scale:1.02,boxShadow:"0 10px 30px rgba(59, 130, 246, 0.3)"},whileTap:{scale:.98},onClick:U,disabled:d||v,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-[#00ADB5] to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg relative overflow-hidden",children:[d&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-indigo-400/20"}),d?e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full relative"}):e.jsx(Et,{className:"w-4 h-4 relative"}),e.jsx("span",{className:"relative",children:"Run"})]}),e.jsxs(o.button,{whileHover:{scale:1.02,boxShadow:"0 10px 30px rgba(34, 197, 94, 0.3)"},whileTap:{scale:.98},onClick:H,disabled:d||v,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 via-emerald-500 to-green-600 hover:from-green-600 hover:via-emerald-600 hover:to-green-700 text-white rounded-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg relative overflow-hidden",children:[v&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-400/20 to-emerald-400/20"}),v?e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full relative"}):e.jsx(ct,{className:"w-4 h-4 relative"}),e.jsx("span",{className:"relative",children:"âš¡ Submit"})]})]})]})]})]}),e.jsx("style",{children:`
        .problem-statement {
          color: #e5e7eb;
        }
        .problem-statement .header {
          font-size: 1.25rem;
          font-weight: 600;
          margin-bottom: 1rem;
        }
        .problem-statement .time-limit,
        .problem-statement .memory-limit {
          color: #9ca3af;
          font-size: 0.875rem;
        }
        .problem-statement pre {
          background: #1f2937;
          padding: 0.75rem;
          border-radius: 0.5rem;
          overflow-x: auto;
        }
        .problem-statement .section-title {
          font-size: 1.125rem;
          font-weight: 600;
          margin-top: 1.5rem;
          margin-bottom: 0.5rem;
          color: #60a5fa;
        }
        .problem-statement .input-specification,
        .problem-statement .output-specification,
        .problem-statement .note {
          margin-top: 1rem;
        }
        .problem-statement .sample-tests {
          margin-top: 1.5rem;
        }
        .problem-statement .input,
        .problem-statement .output {
          background: #1f2937;
          padding: 0.5rem;
          border-radius: 0.25rem;
          margin: 0.5rem 0;
        }
      `})]})},Vs=()=>{const{user:t}=xe(),{fetchGlobalLeaderboard:a,fetchWeeklyLeaderboard:s,fetchMonthlyLeaderboard:r,getUserWallet:n}=ge(),[m,p]=i.useState("global"),[x,y]=i.useState([]),[f,T]=i.useState(!0),[A,j]=i.useState(null),[E,g]=i.useState(null);i.useEffect(()=>{(async()=>{T(!0);try{let S=[];switch(m){case"global":S=await a();break;case"weekly":S=await s();break;case"monthly":S=await r();break}if(y(S),t){const v=await n(t.id);g(v);const L=S.find(O=>O.odId===t.id);L&&j(L)}}catch(S){console.error("Error loading leaderboard:",S),y([])}finally{T(!1)}})()},[m,t]);const b=d=>{switch(d){case 1:return e.jsx(pe,{className:"w-5 h-5 text-yellow-500"});case 2:return e.jsx(De,{className:"w-5 h-5 text-gray-400"});case 3:return e.jsx(De,{className:"w-5 h-5 text-amber-600"});default:return null}};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-6 pb-20 md:pb-6",children:[e.jsx(o.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/30 rounded-xl",children:e.jsx(Q,{className:"w-6 h-6 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"ðŸ† Leaderboard"}),e.jsx("p",{className:"text-gray-500 dark:text-white text-sm",children:"Compete with the best coders"})]})]}),e.jsx("div",{className:"flex gap-2 bg-gray-100 dark:bg-gray-700 p-2 rounded-lg",children:[{id:"global",label:"All Time",icon:Q},{id:"weekly",label:"Weekly",icon:Nt},{id:"monthly",label:"Monthly",icon:we}].map(d=>e.jsxs(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(d.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${m===d.id?"bg-[#00ADB5] text-white":"text-gray-600 dark:text-white hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[e.jsx(d.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:d.label})]},d.id))})]})}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6 text-center",children:"Top Performers"}),e.jsxs("div",{className:"flex items-end justify-center gap-4 md:gap-8",children:[x[1]&&e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 rounded-full bg-gray-500 flex items-center justify-center text-xl md:text-2xl font-bold text-white shadow-md border-2 border-gray-400",children:x[1]?.avatar||x[1]?.odName?.[0]||"?"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-gray-600 rounded-full flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"2"})})]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-semibold text-sm md:text-base text-center truncate max-w-[80px] md:max-w-[100px]",children:x[1]?.odName}),e.jsxs("p",{className:"text-gray-600 dark:text-white text-xs",children:["Level ",x[1]?.level]}),e.jsxs("div",{className:"mt-3 h-20 w-20 md:w-24 rounded-t-xl bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-[#00ADB5] font-bold text-lg",children:x[1]?.rating}),e.jsxs("span",{className:"text-gray-600 dark:text-white text-xs",children:[x[1]?.problemsSolved," solved"]})]})]}),x[0]&&e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col items-center -mt-4",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full bg-amber-500 flex items-center justify-center text-2xl md:text-3xl font-bold text-white shadow-xl border-3 border-amber-400",children:x[0]?.avatar||x[0]?.odName?.[0]||"?"}),e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-amber-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(pe,{className:"w-5 h-5 text-white"})})]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-bold text-base md:text-lg text-center truncate max-w-[100px] md:max-w-[120px]",children:x[0]?.odName}),e.jsxs("p",{className:"text-gray-600 dark:text-white text-xs",children:["Level ",x[0]?.level]}),e.jsxs("div",{className:"mt-3 h-28 w-24 md:w-28 rounded-t-xl bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-700 shadow-md flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-[#00ADB5] font-bold text-xl",children:x[0]?.rating}),e.jsxs("span",{className:"text-gray-600 dark:text-white text-xs",children:[x[0]?.problemsSolved," solved"]})]})]}),x[2]&&e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 rounded-full bg-orange-500 flex items-center justify-center text-xl md:text-2xl font-bold text-white shadow-md border-2 border-orange-400",children:x[2]?.avatar||x[2]?.odName?.[0]||"?"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-orange-600 rounded-full flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"3"})})]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-semibold text-sm md:text-base text-center truncate max-w-[80px] md:max-w-[100px]",children:x[2]?.odName}),e.jsxs("p",{className:"text-gray-600 dark:text-white text-xs",children:["Level ",x[2]?.level]}),e.jsxs("div",{className:"mt-3 h-16 w-20 md:w-24 rounded-t-xl bg-orange-50 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-700 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-[#00ADB5] font-bold text-lg",children:x[2]?.rating}),e.jsxs("span",{className:"text-gray-600 dark:text-white text-xs",children:[x[2]?.problemsSolved," solved"]})]})]})]})]}),E&&e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 border border-[#00ADB5]/30 dark:border-blue-700 rounded-xl p-5",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-xl font-bold text-white shadow-lg",children:E?.userName?.[0]||"Y"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-[#00ADB5] rounded-full flex items-center justify-center text-xs font-bold text-white border-2 border-white dark:border-gray-800",children:A?.rank||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:E?.userName||"You"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-white",children:"Your Current Rank"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[#00ADB5] font-bold text-xl",children:A?.rating||E?.coins||1e3}),e.jsx("p",{className:"text-xs text-gray-500",children:"Rating"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-emerald-600 font-bold text-xl",children:A?.problemsSolved||0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:"Solved"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-purple-600 font-bold text-xl",children:A?.battlesWon||0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:"Wins"})]})]})]})}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600 text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx("div",{className:"col-span-1 text-center",children:"#"}),e.jsx("div",{className:"col-span-5",children:"Player"}),e.jsx("div",{className:"col-span-2 text-center",children:"Rating"}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:"Solved"}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:"Wins"})]}),f?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(se,{className:"w-8 h-8 text-[#00ADB5] animate-spin"})}):x.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500 dark:text-white",children:[e.jsx(Q,{className:"w-12 h-12 mb-3 opacity-30"}),e.jsx("p",{className:"text-lg font-medium",children:"No rankings yet"}),e.jsx("p",{className:"text-sm",children:"Start solving challenges to appear on the leaderboard!"})]}):e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:x.map((d,S)=>e.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:S*.03},className:`grid grid-cols-12 gap-2 px-4 py-4 items-center hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${d.odId===t?.id?"bg-[#00ADB5]/10 dark:bg-[#00ADB5]/20 border-l-4 border-[#00ADB5]":""}`,children:[e.jsx("div",{className:"col-span-1 flex items-center justify-center",children:d.rank<=3?e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${d.rank===1?"bg-yellow-100":d.rank===2?"bg-gray-100":"bg-amber-100"}`,children:b(d.rank)}):e.jsx("span",{className:"text-gray-500 dark:text-white font-medium",children:d.rank})}),e.jsxs("div",{className:"col-span-5 flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold text-white flex-shrink-0 ${d.rank===1?"bg-amber-500":d.rank===2?"bg-gray-500":d.rank===3?"bg-orange-500":"bg-gray-400"}`,children:d.avatar||d.odName?.[0]||"?"}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-gray-900 dark:text-white font-medium truncate flex items-center gap-2",children:[d.odName,d.odId===t?.id&&e.jsx("span",{className:"text-xs bg-[#00ADB5]/20 dark:bg-blue-900/50 text-[#00ADB5] dark:text-[#00ADB5] px-2 py-0.5 rounded-full font-medium",children:"You"})]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-white flex items-center gap-1",children:[e.jsx(Ae,{className:"w-3 h-3 text-amber-500"}),"Level ",d.level]})]})]}),e.jsx("div",{className:"col-span-2 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(qe,{className:"w-4 h-4 text-[#00ADB5]"}),e.jsx("span",{className:"text-[#00ADB5] font-bold",children:d.rating})]})}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:e.jsx("span",{className:"text-green-600 font-medium",children:d.problemsSolved})}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:e.jsx("span",{className:"text-purple-600 font-medium",children:d.battlesWon})})]},d.odId||S))})]}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[e.jsx(Kt,{className:"w-5 h-5 text-amber-600"}),"Weekly Rewards"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:[{rank:"1st Place",coins:100,icon:pe,bgColor:"bg-amber-50 dark:bg-amber-900/30",iconBg:"bg-amber-500",borderColor:"border-amber-200 dark:border-amber-700"},{rank:"2nd Place",coins:50,icon:De,bgColor:"bg-gray-50 dark:bg-gray-700",iconBg:"bg-gray-500",borderColor:"border-gray-200 dark:border-gray-600"},{rank:"3rd Place",coins:200,icon:De,bgColor:"bg-orange-50 dark:bg-orange-900/30",iconBg:"bg-orange-500",borderColor:"border-orange-200 dark:border-orange-700"}].map((d,S)=>e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6+S*.1},className:`flex items-center gap-4 p-4 rounded-lg border ${d.bgColor} ${d.borderColor} hover:shadow-md transition-all`,children:[e.jsx("div",{className:`p-3 rounded-lg ${d.iconBg} shadow-sm`,children:e.jsx(d.icon,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:d.rank}),e.jsxs("p",{className:"text-amber-600 font-bold text-lg",children:[d.coins.toLocaleString()," coins"]})]})]},S))})]})]})})},wt=t=>Array.isArray(t)?t.map(a=>({input:a.input||"",expectedOutput:a.expectedOutput||a.expected_output||"",isHidden:a.isHidden||!1,points:a.points||0})):[],Ys=()=>{const{challengeId:t}=Ye(),a=be(),s=lt(),[r,n]=i.useState(null),[m,p]=i.useState(!0),[x,y]=i.useState(""),[f,T]=i.useState("python"),[A,j]=i.useState(!1),[E,g]=i.useState(!1),[b,d]=i.useState(!1),[S,v]=i.useState(null),[L,O]=i.useState(null),[D,P]=i.useState(""),[w,N]=i.useState(!1),[F,c]=i.useState("description"),[u,C]=i.useState(!1),[I,M]=i.useState(!1),[B,_]=i.useState({}),V=Wt();i.useEffect(()=>{(async()=>{if(t){p(!0);try{let h=s.state?.challenge;if(h&&!h.problemStatement){const K={easy:"Easy",Easy:"Easy",medium:"Medium",Medium:"Medium",hard:"Hard",Hard:"Hard",expert:"Hard"}[h.difficulty]||"Medium";h={id:h.id,title:h.title,description:h.description,difficulty:K,category:h.category||h.topic,points:100,coinReward:h.coinReward||10,timeLimit:5e3,memoryLimit:256,problemStatement:h.description,inputFormat:"Standard input",outputFormat:"Standard output",constraints:[h.constraints||"N/A"],examples:[],testCases:wt(h.testCases||h.test_cases||[]),hints:[],tags:[h.category||h.topic],isPremium:!1,isDaily:!1,totalSubmissions:0,successfulSubmissions:0,acceptanceRate:0,createdAt:new Date,updatedAt:new Date}}h||(h=await _t(t)),h&&(n(h),h.starterCode?.[f]?y(h.starterCode[f]||""):y(q(f))),p(!1)}catch(h){console.error("Error loading challenge:",h),p(!1)}}})()},[t,s]),i.useEffect(()=>{r?.starterCode?.[f]?y(r.starterCode[f]||""):y(q(f))},[f,r]);const q=l=>{const h={python:`# Write your solution here
def solve():
    # Read input
    n = int(input())
    
    # Your code here
    result = n
    
    # Print output
    print(result)

solve()`,cpp:`#include <bits/stdc++.h>
using namespace std;

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    
    // Read input
    int n;
    cin >> n;
    
    // Your code here
    int result = n;
    
    // Print output
    cout << result << endl;
    
    return 0;
}`,java:`import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        
        // Read input
        int n = sc.nextInt();
        
        // Your code here
        int result = n;
        
        // Print output
        System.out.println(result);
    }
}`,javascript:`// Read input from stdin
const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

let lines = [];
rl.on('line', (line) => {
    lines.push(line);
});

rl.on('close', () => {
    // Parse input
    const n = parseInt(lines[0]);
    
    // Your code here
    const result = n;
    
    // Print output
    console.log(result);
});`};return h[l]||h.python},z=async()=>{if(r){g(!0),O(null),v(null);try{const l=r.testCases.filter(K=>!K.isHidden),h=w?D:l[0]?.input||"",Y=await Fs(x,f,h);O(Y)}catch(l){O({output:"",error:l?.message||"Failed to run code. Please try again.",time:null,memory:null,status:"Error"})}g(!1)}},U=async()=>{if(!(!r||!t)){d(!0),v(null),O(null);try{let l=r.testCases||[];if(l.length===0&&(l=wt(await Ps(t)||[])),l.length===0){v({success:!1,results:[],passedCount:0,totalCount:0,totalTime:0,totalMemory:0,compilationError:"No test cases available for this challenge."}),d(!1);return}const h=l.map(K=>({input:K.input||"",expectedOutput:K.expectedOutput||K.expected_output||""})),Y=await rt.submitChallenge(t,x,f,h,r.coinReward||10,r.title,r.difficulty);v({success:Y.success,passedCount:Y.passedCount,totalCount:Y.totalCount,totalTime:0,totalMemory:0,results:Y.testResults?.map((K,_e)=>({testCase:_e+1,passed:K.passed,input:K.input,expected:K.expected,output:K.output,error:K.error}))||[]}),Y.success&&M(!0)}catch(l){console.error("Submission error:",l),v({success:!1,results:[],passedCount:0,totalCount:0,totalTime:0,totalMemory:0,compilationError:l?.message||"Submission failed. Please try again."})}d(!1)}},H=l=>{switch(l){case"easy":return"text-green-400 bg-green-400/10 border-green-400/30";case"medium":return"text-yellow-400 bg-yellow-400/10 border-yellow-400/30";case"hard":return"text-red-400 bg-red-400/10 border-red-400/30";case"expert":return"text-purple-400 bg-purple-400/10 border-purple-400/30";default:return"text-gray-400 bg-gray-400/10 border-gray-400/30"}};if(m)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full"})});if(!r)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Challenge Not Found"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"The challenge you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>a("/dashboard/codearena/practice"),className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-colors",children:"Back to Challenges"})]})});const J=r.testCases.filter(l=>!l.isHidden);return e.jsxs("div",{className:"h-screen bg-gray-900 flex flex-col overflow-hidden -mx-4 -mt-6",children:[e.jsxs("header",{className:"bg-gray-800/90 border-b border-gray-700 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>a("/dashboard/codearena/practice"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(St,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg font-bold text-white flex items-center gap-2",children:[r.title,I&&e.jsx(te,{className:"w-5 h-5 text-green-400"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full border ${H(r.difficulty)}`,children:r.difficulty?r.difficulty.charAt(0).toUpperCase()+r.difficulty.slice(1):"Unknown"}),e.jsx("span",{className:"text-gray-400",children:r.category}),e.jsxs("span",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(ee,{className:"w-4 h-4"}),r.coinReward]})]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>j(!A),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:[e.jsx(ie,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{className:"text-white capitalize",children:f}),e.jsx(ot,{className:"w-4 h-4 text-gray-400"})]}),e.jsx(le,{children:A&&e.jsx(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 top-full mt-2 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 overflow-hidden",children:V.filter(l=>["python","cpp","java","javascript"].includes(l.id)).map(l=>e.jsx("button",{onClick:()=>{T(l.id),j(!1)},className:`w-full px-4 py-2 text-left hover:bg-gray-700 transition-colors ${f===l.id?"text-cyan-400 bg-gray-700/50":"text-white"}`,children:l.name},l.id))})})]})})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/2 border-r border-gray-700 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-700",children:[e.jsx("button",{onClick:()=>c("description"),className:`px-4 py-3 text-sm font-medium transition-colors ${F==="description"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Description"}),e.jsx("button",{onClick:()=>c("submissions"),className:`px-4 py-3 text-sm font-medium transition-colors ${F==="submissions"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Submissions"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:F==="description"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"prose prose-invert max-w-none problem-statement",dangerouslySetInnerHTML:{__html:r.problemStatement||""}}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Examples"}),(r.examples||[]).map((l,h)=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-2 divide-x divide-gray-700",children:[e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Input"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.input})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Output"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.output})]})]}),l.explanation&&e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-800/30",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Explanation"}),e.jsx("p",{className:"text-sm text-gray-300",children:l.explanation})]})]},h))]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Sample Test Cases (",J.length,")"]}),J.map((l,h)=>e.jsx("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-2 divide-x divide-gray-700",children:[e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Input"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.input})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Expected Output"}),e.jsxs("button",{onClick:()=>_(Y=>({...Y,[h]:!Y[h]})),className:"text-xs text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:[B[h]?e.jsx(da,{className:"w-3 h-3"}):e.jsx(Zt,{className:"w-3 h-3"}),B[h]?"Hide":"Show"]})]}),B[h]?e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.expectedOutput}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:'Click "Show" to reveal'})]})]})},h))]}),r.hints&&r.hints.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{onClick:()=>C(!u),className:"flex items-center gap-2 text-yellow-400 hover:text-yellow-300 transition-colors",children:[e.jsx(Ct,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:u?"Hide Hints":"Show Hints"})]}),e.jsx(le,{children:u&&e.jsx(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 space-y-2",children:r.hints.map((l,h)=>e.jsxs("div",{className:"p-3 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-xs text-yellow-400",children:["Hint ",h+1]}),e.jsxs("span",{className:"text-xs text-yellow-400/70",children:[typeof l=="object"?l.coinCost:5," coins"]})]}),e.jsx("p",{className:"text-sm text-gray-300",children:typeof l=="object"?l.text:l})]},h))})})]}),r.tags&&r.tags.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map((l,h)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-700 text-gray-300 rounded",children:l},h))})]})]}):e.jsxs("div",{className:"text-center py-10 text-gray-400",children:[e.jsx(Q,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Your submission history will appear here"})]})})]}),e.jsxs("div",{className:"w-1/2 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(dt,{height:"100%",language:f==="cpp"?"cpp":f,value:x,onChange:l=>y(l||""),theme:"vs-dark",options:{fontSize:14,fontFamily:"JetBrains Mono, Fira Code, Consolas, monospace",minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",glyphMargin:!1,folding:!0,lineDecorationsWidth:10,automaticLayout:!0,tabSize:4,wordWrap:"on",padding:{top:10}}})}),e.jsxs("div",{className:"border-t border-gray-700 px-4 py-2 flex items-center gap-4 bg-gray-800/50",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w,onChange:l=>N(l.target.checked),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded accent-cyan-500"}),"Custom Input"]}),w&&e.jsx("textarea",{value:D,onChange:l=>P(l.target.value),placeholder:"Enter custom input...",className:"flex-1 px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm text-white resize-none h-8"})]}),e.jsx("div",{className:"h-48 border-t border-gray-700 bg-gray-800/50 overflow-y-auto",children:S||L?e.jsxs("div",{className:"p-4",children:[L&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${L.error?"text-red-400":"text-green-400"}`,children:L.status}),L.time&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(we,{className:"w-3 h-3"}),L.time,"s"]}),L.memory&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(Oe,{className:"w-3 h-3"}),(L.memory/1024).toFixed(2)," MB"]})]}),L.output&&e.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Output:"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:L.output})]}),L.error&&e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Error:"}),e.jsx("pre",{className:"text-sm text-red-300 font-mono whitespace-pre-wrap",children:L.error})]})]}),S&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${S.success?"bg-green-900/20 border border-green-500/30":"bg-red-900/20 border border-red-500/30"}`,children:[S.success?e.jsx(te,{className:"w-6 h-6 text-green-400"}):e.jsx(ve,{className:"w-6 h-6 text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${S.success?"text-green-400":"text-red-400"}`,children:S.success?"All Tests Passed!":"Some Tests Failed"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[S.passedCount," / ",S.totalCount," test cases passed"]})]}),S.success&&r&&e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-yellow-400",children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-bold",children:["+",r.coinReward]})]})]}),S.compilationError&&e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Compilation Error:"}),e.jsx("pre",{className:"text-sm text-red-300 font-mono whitespace-pre-wrap",children:S.compilationError})]}),S.results&&S.results.length>0&&e.jsx("div",{className:"space-y-2",children:S.results.map((l,h)=>e.jsxs("div",{className:`p-2 rounded border ${l.passed?"bg-green-900/10 border-green-500/20":"bg-red-900/10 border-red-500/20"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l.passed?e.jsx(te,{className:"w-4 h-4 text-green-400"}):e.jsx(ve,{className:"w-4 h-4 text-red-400"}),e.jsxs("span",{className:"text-sm text-white",children:["Test Case ",l.testCase]}),l.time&&e.jsxs("span",{className:"text-xs text-gray-400",children:[l.time,"s"]})]}),!l.passed&&l.actualOutput&&e.jsxs("div",{className:"mt-2 pl-6",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Your output:"}),e.jsx("pre",{className:"text-xs text-red-300 font-mono",children:l.actualOutput}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Expected:"}),e.jsx("pre",{className:"text-xs text-green-300 font-mono",children:l.expectedOutput})]})]},h))})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsx("p",{className:"text-sm",children:"Run or submit your code to see results"})})}),e.jsxs("div",{className:"border-t border-gray-700 p-4 flex items-center justify-between bg-gray-800",children:[e.jsxs("button",{onClick:()=>{r?.starterCode?.[f]?y(r.starterCode[f]||""):y(q(f))},className:"flex items-center gap-2 px-4 py-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Reset Code"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:z,disabled:E||b,className:"flex items-center gap-2 px-5 py-2.5 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[E?e.jsx(se,{className:"w-4 h-4 animate-spin"}):e.jsx(Et,{className:"w-4 h-4"}),"Run"]}),e.jsxs(o.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:U,disabled:E||b,className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[b?e.jsx(se,{className:"w-4 h-4 animate-spin"}):e.jsx(ct,{className:"w-4 h-4"}),"Submit"]})]})]})]})]}),e.jsx("style",{children:`
        .problem-statement {
          color: #e5e7eb;
        }
        .problem-statement .header {
          font-size: 1.25rem;
          font-weight: 600;
          margin-bottom: 1rem;
        }
        .problem-statement .time-limit,
        .problem-statement .memory-limit {
          color: #9ca3af;
          font-size: 0.875rem;
        }
        .problem-statement pre {
          background: #1f2937;
          padding: 0.75rem;
          border-radius: 0.5rem;
          overflow-x: auto;
        }
        .problem-statement code {
          background: #374151;
          padding: 0.125rem 0.375rem;
          border-radius: 0.25rem;
          font-size: 0.875rem;
        }
        .problem-statement .section-title {
          font-size: 1.125rem;
          font-weight: 600;
          margin-top: 1.5rem;
          margin-bottom: 0.5rem;
          color: #60a5fa;
        }
        .problem-statement ul {
          padding-left: 1.5rem;
          list-style-type: disc;
        }
        .problem-statement ol {
          padding-left: 1.5rem;
          list-style-type: decimal;
        }
        .problem-statement li {
          margin: 0.25rem 0;
        }
      `})]})},qs=[{problems:[{id:"A001",title:"Maximum Subarray Sum",difficulty:"Medium",timeLimit:"1s",memoryLimit:"256MB",description:"Given an integer array nums, find the contiguous subarray (containing at least one number) which has the largest sum and return its sum.",inputFormat:`First line contains integer n (1 â‰¤ n â‰¤ 10^5) - the length of array.
Second line contains n integers a_i (-10^4 â‰¤ a_i â‰¤ 10^4) - array elements.`,outputFormat:"Print a single integer - the maximum sum of contiguous subarray.",constraints:["1 â‰¤ n â‰¤ 100000","-10000 â‰¤ nums[i] â‰¤ 10000"],tags:["array","dynamic-programming","kadane"],testCases:[{input:`9
-2 1 -3 4 -1 2 1 -5 4`,output:"6",explanation:"Subarray [4,-1,2,1] has the largest sum = 6"},{input:`1
5`,output:"5",explanation:"Single element array"},{input:`5
-1 -2 -3 -4 -5`,output:"-1",explanation:"All negative, choose the largest"}]},{id:"A002",title:"Rotate Array",difficulty:"Easy",timeLimit:"2s",memoryLimit:"256MB",description:"Given an array, rotate the array to the right by k steps, where k is non-negative.",inputFormat:`First line contains two integers n and k (1 â‰¤ n â‰¤ 10^5, 0 â‰¤ k â‰¤ 10^9) - array length and rotation steps.
Second line contains n integers a_i (1 â‰¤ a_i â‰¤ 10^9) - array elements.`,outputFormat:"Print n integers - the rotated array.",constraints:["1 â‰¤ n â‰¤ 100000","0 â‰¤ k â‰¤ 10^9","1 â‰¤ nums[i] â‰¤ 10^9"],tags:["array","math"],testCases:[{input:`7 3
1 2 3 4 5 6 7`,output:"5 6 7 1 2 3 4",explanation:"Rotate right by 3 steps"},{input:`3 2
-1 -100 3`,output:"-100 3 -1",explanation:"Rotate right by 2 steps"},{input:`2 5
1 2`,output:"2 1",explanation:"k=5 is same as k=1 for length 2"}]},{id:"A003",title:"Find Missing Number",difficulty:"Easy",timeLimit:"1s",memoryLimit:"256MB",description:"Given an array nums containing n distinct numbers in the range [0, n], return the only number in the range that is missing from the array.",inputFormat:`First line contains integer n (1 â‰¤ n â‰¤ 10^4).
Second line contains n integers - array elements (each in range [0, n]).`,outputFormat:"Print a single integer - the missing number.",constraints:["1 â‰¤ n â‰¤ 10000","0 â‰¤ nums[i] â‰¤ n","All numbers are distinct"],tags:["array","math","bit-manipulation"],testCases:[{input:`3
3 0 1`,output:"2",explanation:"n=3, array has [0,1,3], missing 2"},{input:`2
0 1`,output:"2",explanation:"Range [0,2], missing 2"},{input:`9
9 6 4 2 3 5 7 0 1`,output:"8",explanation:"Missing number is 8"}]},{id:"A004",title:"Product of Array Except Self",difficulty:"Medium",timeLimit:"2s",memoryLimit:"256MB",description:"Given an integer array nums, return an array answer such that answer[i] is equal to the product of all the elements of nums except nums[i]. You must write an algorithm that runs in O(n) time and without using the division operation.",inputFormat:`First line contains integer n (2 â‰¤ n â‰¤ 10^5).
Second line contains n integers a_i (1 â‰¤ |a_i| â‰¤ 30) - array elements.`,outputFormat:"Print n integers - the product array.",constraints:["2 â‰¤ n â‰¤ 100000","-30 â‰¤ nums[i] â‰¤ 30","Product of any prefix/suffix fits in 32-bit integer"],tags:["array","prefix-sum"],testCases:[{input:`4
1 2 3 4`,output:"24 12 8 6",explanation:"[2*3*4, 1*3*4, 1*2*4, 1*2*3]"},{input:`5
-1 1 0 -3 3`,output:"0 0 9 0 0",explanation:"Product except self with zero"}]},{id:"A005",title:"Container With Most Water",difficulty:"Medium",timeLimit:"1s",memoryLimit:"256MB",description:"You are given an integer array height of length n. There are n vertical lines drawn such that the two endpoints of the i-th line are (i, 0) and (i, height[i]). Find two lines that together with the x-axis form a container, such that the container contains the most water. Return the maximum amount of water a container can store.",inputFormat:`First line contains integer n (2 â‰¤ n â‰¤ 10^5).
Second line contains n integers h_i (0 â‰¤ h_i â‰¤ 10^4) - heights.`,outputFormat:"Print a single integer - maximum water area.",constraints:["2 â‰¤ n â‰¤ 100000","0 â‰¤ height[i] â‰¤ 10000"],tags:["array","two-pointers","greedy"],testCases:[{input:`9
1 8 6 2 5 4 8 3 7`,output:"49",explanation:"Lines at index 1 and 8, area = min(8,7) * 7 = 49"},{input:`2
1 1`,output:"1",explanation:"Only two lines, area = 1"},{input:`6
4 3 2 1 4 5`,output:"16",explanation:"Lines at index 0 and 5, area = min(4,5) * 5 = 20? No, distance is 5"}]},{id:"A006",title:"Find All Duplicates in Array",difficulty:"Medium",timeLimit:"1s",memoryLimit:"256MB",description:"Given an integer array nums of length n where all integers are in the range [1, n] and each integer appears once or twice, return an array of all the integers that appears twice. You must solve it without extra space and in O(n) runtime.",inputFormat:`First line contains integer n (1 â‰¤ n â‰¤ 10^5).
Second line contains n integers a_i (1 â‰¤ a_i â‰¤ n).`,outputFormat:"Print all duplicate numbers in any order (space-separated). If no duplicates, print empty line.",constraints:["1 â‰¤ n â‰¤ 100000","1 â‰¤ nums[i] â‰¤ n","Each element appears once or twice"],tags:["array","hash-table"],testCases:[{input:`8
4 3 2 7 8 2 3 1`,output:"2 3",explanation:"2 and 3 appear twice"},{input:`2
1 1`,output:"1",explanation:"1 appears twice"},{input:`1
1`,output:"",explanation:"No duplicates"}]}]}],Gs="/questions.json";let Ie=null,at=0;const Js=36e5,nt=async()=>{if(Ie&&Date.now()-at<Js)return console.log("âœ“ Using cached questions:",Ie.length),Ie;try{console.log("ðŸ“¥ Attempting to fetch from local /questions.json...");const t=await fetch(Gs);if(t.ok){const a=await t.json(),s=vt(a);if(s.length>0)return console.log(`âœ“ Loaded ${s.length} questions from local file`),Ie=s,at=Date.now(),s}}catch{console.warn("âš ï¸ Local file fetch failed, using bundled data...")}try{const a=vt(qs);if(a.length>0)return console.log(`âœ“ Loaded ${a.length} questions from bundled data`),Ie=a,at=Date.now(),a}catch(t){console.error("âŒ Failed to load bundled questions:",t)}return console.error("âŒ All question sources failed"),[]};function vt(t){if(!t)return[];let a=[];if(Array.isArray(t))a=t;else{const s=t;if(Array.isArray(s.problems))a=s.problems;else if(Array.isArray(s.questions))a=s.questions;else return[]}return a.map(s=>{const r=s,n=String(r.difficulty??r.level??"").trim().toLowerCase();let m="medium";n.startsWith("e")?m="easy":n.startsWith("m")?m="medium":n.startsWith("h")&&(m="hard");const p=r.id??r._id??"",x=r.title??r.name??"Untitled",y=r.description??r.prompt??"";let f="General";typeof r.category=="string"?f=String(r.category):Array.isArray(r.tags)&&r.tags.length>0?f=String(r.tags[0]):typeof r.topic=="string"&&(f=String(r.topic));const T=Number(r.coinReward??r.coins??r.reward??0)||0,A=Array.isArray(r.testCases)?r.testCases:Array.isArray(r.test_cases)?r.test_cases:[],j=E=>{const g=E,b=String(g.input??g.stdin??""),d=String(g.output??g.expected_output??g.expectedOutput??""),S=!!(g.isHidden??g.hidden??!1),v=typeof g.points=="number"?g.points:void 0;return{input:b,expectedOutput:d,expected_output:d,isHidden:S,points:v}};return{id:String(p),title:String(x),description:String(y),category:f,difficulty:m,coinReward:T,coins:T,constraints:String(r.constraints??r.limits??""),solution_hint:String(r.solution_hint??r.hint??""),testCases:A.map(j),test_cases:A.map(E=>{const g=j(E);return{input:g.input,expected_output:g.expected_output}})}})}const Ks=async()=>{const t=await nt(),a=new Set(t.map(s=>s.category));return Array.from(a).sort()},Qs=()=>{const t=be(),{user:a}=xe(),{getUserProgress:s}=ge(),[r,n]=i.useState([]),[m,p]=i.useState([]),[x,y]=i.useState(!0),[f,T]=i.useState(""),[A,j]=i.useState("all"),[E,g]=i.useState("all"),[b,d]=i.useState([]),[S,v]=i.useState(1),[L,O]=i.useState(new Set),D=20,P=[{id:"all",label:"All",color:"bg-gray-100 text-gray-700 border-gray-200"},{id:"easy",label:"Easy",color:"bg-green-50 text-green-700 border-green-200"},{id:"medium",label:"Medium",color:"bg-yellow-50 text-yellow-700 border-yellow-200"},{id:"hard",label:"Hard",color:"bg-red-50 text-red-700 border-red-200"}];i.useEffect(()=>{(async()=>{if(a?.id)try{const u=await s(a.id);if(u?.solvedChallenges){const C=new Set(u.solvedChallenges.map(I=>I.challengeId?.toString()||I.challengeId));O(C)}}catch(u){console.error("Error fetching solved challenges:",u)}})()},[a?.id,s]),i.useEffect(()=>{(async()=>{y(!0);try{const u=await nt();console.log("Questions loaded:",u.length);const C=await Ks();console.log("Topics:",C.length);const I=u.map(M=>({id:M.id,title:M.title,description:M.description,difficulty:M.difficulty,topic:M.category,tags:[M.category],coinReward:M.coins,acceptanceRate:75,category:M.category,isDaily:!1,isPremium:!1,testCases:M.test_cases,sampleCode:"",examples:"",constraints:M.constraints,solution_hint:M.solution_hint}));console.log("Challenges prepared:",I.length),n(I),p(I.slice(0,D)),d(C),y(!1)}catch(u){console.error("Error loading questions:",u),y(!1)}})()},[]),i.useEffect(()=>{let c=[...r];if(A!=="all"&&(c=c.filter(I=>I.difficulty===A)),E!=="all"&&(c=c.filter(I=>I.topic===E)),f){const I=f.toLowerCase();c=c.filter(M=>M.title.toLowerCase().includes(I)||M.description.toLowerCase().includes(I)||M.tags.some(B=>B.toLowerCase().includes(I)))}console.log("Filtered challenges:",c.length,"from",r.length);const u=(S-1)*D,C=c.slice(u,u+D);console.log("Paginated challenges:",C.length),p(C)},[r,A,E,f,S]);const w=async()=>{y(!0);try{const u=(await nt()).map(C=>({id:C.id,title:C.title,description:C.description,difficulty:C.difficulty,topic:C.category,tags:[C.category],coinReward:C.coins,acceptanceRate:75,category:C.category,isDaily:!1,isPremium:!1,testCases:C.test_cases,sampleCode:"",solution_hint:C.solution_hint}));n(u),v(1)}catch(c){console.error("Error refreshing questions:",c)}y(!1)},N=c=>{t(`/dashboard/codearena/challenge/${c.id}`,{state:{challenge:c}})},F=[{label:"Total",value:r.length.toLocaleString(),icon:ie,color:"text-[#00ADB5] bg-[#00ADB5]/10"},{label:"Solved",value:L.size,icon:te,color:"text-emerald-600 bg-emerald-50"},{label:"Easy",value:r.filter(c=>c.difficulty==="easy").length,icon:Oe,color:"text-green-600 bg-green-50"},{label:"Medium",value:r.filter(c=>c.difficulty==="medium").length,icon:ue,color:"text-yellow-600 bg-yellow-50"},{label:"Hard",value:r.filter(c=>c.difficulty==="hard").length,icon:Ae,color:"text-red-600 bg-red-50"}];return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-6 pb-20 md:pb-6",children:[e.jsx(o.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-xl",children:e.jsx(ue,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"âš¡ Practice Challenges"}),e.jsx("p",{className:"text-gray-500 dark:text-white text-sm",children:"Solve coding challenges from 3000+ questions and earn coins"})]})]}),e.jsxs(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:w,disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-[#00ADB5] hover:bg-[#00ADB5]/80 text-white font-medium rounded-lg transition-all disabled:opacity-50",children:[e.jsx(Ce,{className:`w-4 h-4 ${x?"animate-spin":""}`}),"Refresh"]})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:F.map((c,u)=>e.jsxs(o.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:u*.1},whileHover:{y:-2,scale:1.02},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-lg transition-all group",children:[e.jsx("div",{className:`inline-flex p-2 rounded-lg ${c.color} dark:bg-opacity-20 mb-3 group-hover:scale-110 transition-transform`,children:e.jsx(c.icon,{className:"w-4 h-4"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:c.value}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-white",children:c.label})]},c.label))}),e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(kt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search challenges...",value:f,onChange:c=>{T(c.target.value),v(1)},className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-[#00ADB5] transition-all"})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:P.map(c=>e.jsx(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{j(c.id),v(1)},className:`px-4 py-2 rounded-lg text-sm font-medium border transition-all ${A===c.id?c.color:"bg-gray-50 dark:bg-gray-900 text-gray-600 dark:text-white border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:c.label},c.id))}),b.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{g("all"),v(1)},className:`px-4 py-2 rounded-full text-xs font-medium transition-all ${E==="all"?"bg-[#00ADB5] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"All Topics"}),b.slice(0,10).map(c=>e.jsx(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{g(c),v(1)},className:`px-4 py-2 rounded-full text-xs font-medium transition-all ${E===c?"bg-[#00ADB5] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:c},c)),b.length>10&&e.jsxs("span",{className:"px-4 py-2 text-xs text-gray-500 dark:text-white",children:["+",b.length-10," more"]})]})]}),x?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs(o.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8",children:[e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-8 h-8 border-2 border-[#00ADB5] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-white",children:"Loading 3000+ questions from GitHub..."})]})}):m.length===0?e.jsxs(o.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-20 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsx(Qt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-lg",children:"No challenges found"}),e.jsx("p",{className:"text-gray-500 dark:text-white text-sm mt-2",children:"Try adjusting your filters"})]}):e.jsx("div",{className:"space-y-3",children:m.map((c,u)=>{const C=L.has(c.id?.toString()||c.id);return e.jsx(o.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{delay:u*.05,duration:.4},whileHover:{y:-2,scale:1.02},className:`bg-white dark:bg-gray-800 border rounded-xl p-6 hover:shadow-lg transition-all group ${C?"border-green-300 dark:border-green-600 bg-green-50/50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg group-hover:text-[#00ADB5] dark:group-hover:text-[#00ADB5] transition-colors",children:c.title}),C&&e.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-400 text-xs font-semibold rounded-full border border-green-200 dark:border-green-700",children:[e.jsx(te,{className:"w-3 h-3"}),"SOLVED"]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-white mb-3 group-hover:text-gray-700 dark:group-hover:text-gray-300 transition-colors line-clamp-2",children:c.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm mb-3",children:[e.jsx(o.span,{whileHover:{scale:1.05},className:`px-3 py-1 rounded-full text-xs font-semibold ${c.difficulty==="easy"?"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-700":c.difficulty==="medium"?"bg-yellow-50 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 border border-yellow-200 dark:border-yellow-700":"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-700"}`,children:c.difficulty?c.difficulty.charAt(0).toUpperCase()+c.difficulty.slice(1):"Unknown"}),e.jsx("span",{className:"text-gray-600 dark:text-white text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:c.category}),e.jsxs("span",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400 text-xs font-medium",children:[e.jsx(ee,{className:"w-3 h-3"}),c.coinReward||c.coins||0]})]})]}),e.jsx("div",{className:"flex items-center gap-2 ml-6",children:e.jsxs(o.button,{whileHover:{scale:1.05,boxShadow:"0 10px 30px rgba(59, 130, 246, 0.3)"},whileTap:{scale:.95},onClick:()=>N(c),className:`flex items-center gap-2 px-6 py-3 text-white text-sm font-semibold rounded-lg transition-all ${C?"bg-green-500 hover:bg-green-600":"bg-[#00ADB5] hover:bg-[#00ADB5]/80"}`,children:[e.jsx("span",{className:"relative",children:C?"Solve Again":"Solve"}),e.jsx(Ge,{className:"w-4 h-4 relative"})]})})]})},c.id)})}),!x&&m.length>0&&e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-center gap-3",children:[e.jsx(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>v(c=>Math.max(1,c-1)),disabled:S===1,className:"px-6 py-3 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium shadow-sm",children:"Previous"}),e.jsxs("span",{className:"px-4 py-3 text-gray-700 dark:text-gray-300 text-sm bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:["Page ",S]}),e.jsx(o.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>v(c=>c+1),disabled:m.length<D,className:"px-6 py-3 bg-[#00ADB5] hover:bg-[#00ADB5]/80 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium shadow-sm",children:"Next"})]})]})})},Xs=()=>{const[t,a]=i.useState(!1),[s,r]=i.useState(!1),[n,m]=i.useState(null),[p,x]=i.useState(null),y=async()=>{try{const j=(await W("/challenges")).challenges?.length||0;return x(j),j}catch(A){return console.error("Error checking challenges:",A),0}},f=async()=>{a(!0),m(null);try{let A=0;for(const j of tt)await W("/challenges",{method:"POST",body:JSON.stringify({...j,createdAt:new Date,updatedAt:new Date})}),A++;m({type:"success",text:`Successfully added ${A} challenges to backend!`}),await y()}catch(A){console.error("Error seeding challenges:",A),m({type:"error",text:`Error: ${A.message||"Failed to seed challenges"}`})}a(!1)},T=async()=>{if(confirm("Are you sure you want to delete ALL challenges? This cannot be undone.")){r(!0),m(null);try{const j=(await W("/challenges")).challenges||[];let E=0;for(const g of j)await W(`/challenges/${g.id}`,{method:"DELETE"}),E++;m({type:"info",text:`Deleted ${E} challenges from backend.`}),x(0)}catch(A){console.error("Error deleting challenges:",A),m({type:"error",text:`Error: ${A.message||"Failed to delete challenges"}`})}r(!1)}};return i.useEffect(()=>{y()},[]),e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-lg p-8 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex p-3 bg-[#00ADB5]/20 dark:bg-blue-900/50 rounded-full mb-4",children:e.jsx(oa,{className:"w-8 h-8 text-[#00ADB5] dark:text-[#00ADB5]"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"CodeArena Seed Tool"}),e.jsx("p",{className:"text-gray-500 dark:text-white",children:"Add sample challenges to your backend database"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-white",children:"Challenges to add:"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:tt.length})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-white",children:"Existing in backend:"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:p!==null?p:e.jsx(Ce,{className:"w-4 h-4 animate-spin text-gray-400"})})]})]}),n&&e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:`mb-6 p-4 rounded-lg flex items-start gap-3 ${n.type==="success"?"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700":n.type==="error"?"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700":"bg-[#00ADB5]/10 dark:bg-[#00ADB5]/20 border border-[#00ADB5]/30 dark:border-blue-700"}`,children:[n.type==="success"?e.jsx(te,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}):n.type==="error"?e.jsx(ut,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}):e.jsx(ut,{className:"w-5 h-5 text-[#00ADB5] dark:text-[#00ADB5] flex-shrink-0 mt-0.5"}),e.jsx("p",{className:`text-sm ${n.type==="success"?"text-green-700 dark:text-green-400":n.type==="error"?"text-red-700 dark:text-red-400":"text-blue-700 dark:text-[#00ADB5]"}`,children:n.text})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:f,disabled:t||s,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-[#00ADB5] text-white font-medium rounded-lg hover:bg-[#00ADB5]/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[t?e.jsx(se,{className:"w-5 h-5 animate-spin"}):e.jsx(ea,{className:"w-5 h-5"}),t?"Adding Challenges...":"Seed Challenges"]}),e.jsxs("button",{onClick:()=>y(),disabled:t||s,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(Ce,{className:"w-5 h-5"}),"Refresh Count"]}),e.jsxs("button",{onClick:T,disabled:t||s||p===0,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 font-medium rounded-lg hover:bg-red-100 dark:hover:bg-red-900/50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors border border-red-200 dark:border-red-700",children:[s?e.jsx(se,{className:"w-5 h-5 animate-spin"}):e.jsx(ta,{className:"w-5 h-5"}),s?"Deleting...":"Delete All Challenges"]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Challenges to be added:"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:tt.map((A,j)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:A.title}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${A.difficulty==="easy"?"bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-400":A.difficulty==="medium"?"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-400":"bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-400"}`,children:A.difficulty})]},j))})]})]})})},Zs=({wallet:t,onClose:a})=>{const{user:s}=xe(),{fetchUserTransactions:r,getUserProgress:n}=ge(),[m,p]=i.useState([]),[x,y]=i.useState(!0),[f,T]=i.useState("overview"),[A,j]=i.useState({problemsSolved:0,battlesWon:0,currentStreak:0});i.useEffect(()=>{(async()=>{if(s)try{const S=(await n?.(s.id))?.solvedChallenges?.length||t?.achievements?.problemsSolved||0;let v=0,L=0;try{v=t?.achievements?.battlesWon||0,L=t?.streak?.current||0}catch(O){console.error("Error fetching battles for wallet:",O),v=t?.achievements?.battlesWon||0,L=t?.streak?.current||0}j({problemsSolved:S,battlesWon:v,currentStreak:L})}catch(d){console.error("Error fetching real stats:",d),j({problemsSolved:t?.achievements?.problemsSolved||0,battlesWon:t?.achievements?.battlesWon||0,currentStreak:t?.streak?.current||0})}})()},[s,t,n]),i.useEffect(()=>{(async()=>{if(s)try{const d=await r(s.id);p(d||[])}catch(d){console.error("Error loading transactions:",d),p([])}finally{y(!1)}})()},[s,r]);const E=(b,d)=>{if(b==="earn")switch(d){case"challenge":return ue;case"battle":return ae;case"tournament":return Q;default:return mt}else switch(d){case"hint":return Ae;case"entry_fee":return ae;default:return ee}},g=b=>b?(b.toDate?b.toDate():new Date(b)).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-end",onClick:a,children:e.jsxs(o.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},onClick:b=>b.stopPropagation(),className:"h-full w-full max-w-sm bg-gray-900 border-l border-gray-700/50 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(fa,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"My Wallet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Manage your coins & rewards"})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-700/50 rounded-lg transition-colors",children:e.jsx(it,{className:"w-5 h-5 text-gray-400"})})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500/20 via-amber-500/20 to-orange-500/20 border border-yellow-500/30 rounded-2xl p-6",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Total Balance"}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-yellow-400 to-amber-500 flex items-center justify-center",children:e.jsx("span",{className:"text-xl font-bold text-gray-900",children:"â‚¿"})}),e.jsx("span",{className:"text-4xl font-bold text-white",children:t?.coins?.toLocaleString()||0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-400 mb-1",children:[e.jsx(qe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Earned"})]}),e.jsx("p",{className:"text-white font-bold",children:t?.totalEarned?.toLocaleString()||0})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 mb-1",children:[e.jsx(Tt,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Spent"})]}),e.jsx("p",{className:"text-white font-bold",children:t?.totalSpent?.toLocaleString()||0})]})]})]})}),e.jsx("div",{className:"flex gap-2 px-4",children:[{id:"overview",label:"Overview"},{id:"history",label:"History"}].map(b=>e.jsx("button",{onClick:()=>T(b.id),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-all ${f===b.id?"bg-cyan-500/20 text-cyan-400":"bg-gray-800/50 text-gray-400 hover:text-white"}`,children:b.label},b.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:f==="overview"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-purple-400"}),e.jsxs("span",{className:"text-white font-medium",children:["Level ",t?.level||1]})]}),e.jsxs("span",{className:"text-sm text-gray-400",children:[t?.experience||0," / ",(t?.level||1)*100," XP"]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx(o.div,{initial:{width:0},animate:{width:`${(t?.experience||0)/((t?.level||1)*100)*100}%`},className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsx(ue,{className:"w-5 h-5 text-green-400 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:A.problemsSolved}),e.jsx("p",{className:"text-sm text-gray-400",children:"Problems Solved"})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsx(ae,{className:"w-5 h-5 text-[#00ADB5] mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:A.battlesWon}),e.jsx("p",{className:"text-sm text-gray-400",children:"Battles Won"})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsx(Q,{className:"w-5 h-5 text-yellow-400 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t?.achievements?.tournamentsWon||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tournaments"})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsx(Oe,{className:"w-5 h-5 text-orange-400 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:A.currentStreak}),e.jsx("p",{className:"text-sm text-gray-400",children:"Win Streak"})]})]}),t?.badges&&t.badges.length>0&&e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(mt,{className:"w-5 h-5 text-pink-400"}),"Badges"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.badges.map((b,d)=>e.jsxs("div",{className:"px-3 py-1.5 bg-gray-700/50 rounded-lg text-sm text-white flex items-center gap-2",title:b.description,children:[e.jsx("span",{children:b.icon}),e.jsx("span",{children:b.name})]},d))})]})]}):e.jsx("div",{className:"space-y-3",children:x?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full"})}):m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(st,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No transactions yet"})]}):m.map((b,d)=>{const S=E(b.type,b.category),v=b.type==="earn";return e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:d*.05},className:"flex items-center justify-between p-3 bg-gray-800/50 border border-gray-700/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${v?"bg-green-500/20":"bg-red-500/20"}`,children:e.jsx(S,{className:`w-4 h-4 ${v?"text-green-400":"text-red-400"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:b.description}),e.jsx("p",{className:"text-xs text-gray-400",children:g(b.createdAt)})]})]}),e.jsxs("div",{className:`flex items-center gap-1 font-bold ${v?"text-green-400":"text-red-400"}`,children:[v?e.jsx(na,{className:"w-4 h-4"}):e.jsx(sa,{className:"w-4 h-4"}),e.jsxs("span",{children:[v?"+":"-",b.amount]})]})]},b.id||d)})})})]})})};class er extends i.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){console.error("CodeArena Error:",a,s)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-red-200 dark:border-red-800 p-8 max-w-md w-full text-center",children:[e.jsx(At,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-4",children:"There was an error loading CodeArena. Please refresh the page or try again later."}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/30 p-3 rounded-lg mb-4 text-left",children:e.jsx("pre",{className:"text-xs text-red-700 dark:text-red-400 whitespace-pre-wrap",children:this.state.error?.message||"Unknown error"})}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-[#00ADB5] text-white rounded-lg hover:bg-[#00ADB5]/80 transition-colors",children:"Refresh Page"})]})}):this.props.children}}const tr=()=>{const t=be(),a=lt(),{user:s}=xe(),{getUserWallet:r,initializeWallet:n,subscribeToWallet:m,fetchGlobalLeaderboard:p,getUserProgress:x}=ge(),[y,f]=i.useState("home"),[T,A]=i.useState(null),[j,E]=i.useState({problemsSolved:0,battlesWon:0,currentStreak:0,globalRank:"-"}),[g,b]=i.useState(!0),[d,S]=i.useState(!1),[v,L]=i.useState(null),O=async(w,N)=>{try{const[F,c,u]=await Promise.all([W(`/battles/user-stats/${w}`).catch(()=>null),x?.(w).catch(()=>null),p?.().catch(()=>null)]),C=c?.solvedChallenges?.length||N?.achievements?.problemsSolved||0,I=F?.battlesWon||N?.achievements?.battlesWon||0,M=F?.currentStreak||N?.streak?.current||0;let B="-";if(u){const _=u.find(V=>V.odId===w);_&&(B=_.rank)}E({problemsSolved:C,battlesWon:I,currentStreak:M,globalRank:B})}catch(F){console.error("Error fetching user stats:",F),E({problemsSolved:0,battlesWon:0,currentStreak:0,globalRank:"-"})}};i.useEffect(()=>{(async()=>{if(s&&s.id)try{b(!1),O(s.id,null),await r(s.id)||await n(s.id);const F=m(s.id,async c=>{A(c)});return()=>F()}catch(N){console.error("Error initializing wallet:",N),L("Failed to initialize wallet. Please check your connection and try again."),b(!1)}else console.log("No user or user.id, skipping wallet init"),b(!1)})()},[s?.id]),i.useEffect(()=>{const w=a.pathname;w.includes("/battle/history")?f("history"):w.includes("/battle")?f("battle"):w.includes("/practice")?f("practice"):w.includes("/leaderboard")?f("leaderboard"):f("home")},[a]);const D=[{label:"Problems Solved",value:j.problemsSolved,icon:ie,color:"text-emerald-600 bg-emerald-50"},{label:"Battles Won",value:j.battlesWon,icon:ae,color:"text-[#00ADB5] bg-[#00ADB5]/10"},{label:"Current Streak",value:j.currentStreak,icon:Ae,color:"text-orange-600 bg-orange-50"},{label:"Global Rank",value:j.globalRank,icon:Q,color:"text-amber-600 bg-amber-50"}],P=[{title:"Quick Battle",description:"Compete in a 1v1 coding duel",icon:ae,color:"bg-red-500",path:"battle"},{title:"Practice Mode",description:"Solve problems from Codeforces",icon:ue,color:"bg-[#00ADB5]",path:"practice"},{title:"Leaderboard",description:"View global rankings",icon:Q,color:"bg-amber-500",path:"leaderboard"}];return g?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(se,{className:"w-8 h-8 text-[#00ADB5] animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-white",children:"Loading CodeArena..."})]})}):v?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-red-200 dark:border-red-700 p-8 max-w-md w-full text-center",children:[e.jsx(At,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Error Loading CodeArena"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-4",children:v}),e.jsx("button",{onClick:()=>{L(null),b(!0),window.location.reload()},className:"px-4 py-2 bg-[#00ADB5] text-white rounded-lg hover:bg-[#00ADB5]/80 transition-colors",children:"Try Again"})]})}):s?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-[#00ADB5] rounded-lg",children:e.jsx(ie,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"CodeArena"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:"Battle. Code. Win."})]})]}),e.jsx("nav",{className:"hidden md:flex items-center gap-1",children:[{id:"home",label:"Home",icon:ie,path:""},{id:"battle",label:"Battle",icon:ae,path:"battle"},{id:"history",label:"History",icon:st,path:"battle/history"},{id:"practice",label:"Practice",icon:ue,path:"practice"},{id:"leaderboard",label:"Ranks",icon:Q,path:"leaderboard"}].map(w=>e.jsxs("button",{onClick:()=>t(`/dashboard/codearena/${w.path}`),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${y===w.id?"bg-[#00ADB5]/10 dark:bg-[#00ADB5]/20 text-[#00ADB5] dark:text-[#00ADB5]":"text-gray-600 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx(w.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:w.label})]},w.id))}),e.jsxs("button",{onClick:()=>S(!0),className:"flex items-center gap-2 px-4 py-2 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-700 rounded-lg hover:bg-amber-100 dark:hover:bg-amber-900/50 transition-all",children:[e.jsx(ee,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),e.jsx("span",{className:"text-amber-700 dark:text-amber-300 font-semibold",children:T?.coins?.toLocaleString()||0})]})]})})}),e.jsx("main",{className:"max-w-6xl mx-auto px-4 py-6",children:e.jsxs(Xt,{children:[e.jsx(ne,{path:"/",element:e.jsx(ar,{stats:D,quickActions:P,navigate:t})}),e.jsx(ne,{path:"/battle",element:e.jsx(Na,{wallet:T})}),e.jsx(ne,{path:"/battle/history",element:e.jsx(ba,{})}),e.jsx(ne,{path:"/battle/:battleId",element:e.jsx(Ws,{})}),e.jsx(ne,{path:"/battle/results/:battleId",element:e.jsx(Sa,{})}),e.jsx(ne,{path:"/practice",element:e.jsx(Qs,{})}),e.jsx(ne,{path:"/practice/:challengeId",element:e.jsx(Us,{})}),e.jsx(ne,{path:"/challenge/:challengeId",element:e.jsx(Ys,{})}),e.jsx(ne,{path:"/leaderboard",element:e.jsx(Vs,{})}),e.jsx(ne,{path:"/seed",element:e.jsx(Xs,{})})]})}),e.jsx(le,{children:d&&e.jsx(Zs,{wallet:T,onClose:()=>S(!1)})}),e.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 px-4 py-2 z-50",children:e.jsx("div",{className:"flex justify-around",children:[{id:"home",label:"Home",icon:ie,path:""},{id:"battle",label:"Battle",icon:ae,path:"battle"},{id:"history",label:"History",icon:st,path:"battle/history"},{id:"leaderboard",label:"Ranks",icon:Q,path:"leaderboard"}].map(w=>e.jsxs("button",{onClick:()=>t(`/dashboard/codearena/${w.path}`),className:`flex flex-col items-center gap-1 p-2 ${y===w.id?"text-[#00ADB5]":"text-gray-400"}`,children:[e.jsx(w.icon,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:w.label})]},w.id))})})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 max-w-md w-full text-center",children:[e.jsx(ie,{className:"w-12 h-12 text-[#00ADB5] mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Login Required"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-4",children:"Please log in to access CodeArena."}),e.jsx("button",{onClick:()=>t("/login"),className:"px-4 py-2 bg-[#00ADB5] text-white rounded-lg hover:bg-[#00ADB5]/80 transition-colors",children:"Go to Login"})]})})},ar=({stats:t,quickActions:a,navigate:s})=>{const{fetchGlobalLeaderboard:r}=ge(),[n,m]=i.useState([]),[p,x]=i.useState([]),[y,f]=i.useState(!0),[T,A]=i.useState(!0);return i.useEffect(()=>{const j=async()=>{try{const d=await W("/battles?status=active"),S=await W("/battles?status=waiting"),v=await W("/battles?status=countdown"),L=d.battles||[],O=S.battles||[],D=v.battles||[],P=[...L,...D,...O].slice(0,5).map(w=>({id:w.id||w._id,status:w.status,difficulty:w.difficulty,entryFee:w.entryFee,prize:w.prize,participants:w.participants?.length>0?w.participants.map(N=>({odId:N.odId||N.userId,userName:N.userName||N.odName||"Player",userAvatar:N.userAvatar||N.odProfilePic})):[{odId:w.creatorId,userName:w.creatorName||"Player",userAvatar:w.creatorProfilePic}]}));m(P)}catch(d){console.error("Error loading battles:",d),m([])}finally{f(!1)}},E=async()=>{try{if(r){const d=await r();x(d?.slice(0,3)||[])}}catch(d){console.error("Error loading top players:",d),x([])}finally{A(!1)}};j(),E();const g=setInterval(j,3e4),b=setInterval(E,6e4);return()=>{clearInterval(g),clearInterval(b)}},[]),e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-6 pb-20 md:pb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Welcome Back! ðŸ‘‹"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-6",children:"Ready to test your coding skills? Battle other developers or practice with Codeforces problems."}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>s("/dashboard/codearena/battle"),className:"flex items-center gap-2 px-5 py-2.5 bg-[#00ADB5] text-white font-medium rounded-lg hover:bg-[#00ADB5]/80 transition-colors",children:[e.jsx(ae,{className:"w-4 h-4"}),"Find Match"]}),e.jsxs("button",{onClick:()=>s("/dashboard/codearena/practice"),className:"flex items-center gap-2 px-5 py-2.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),"Practice"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.map((j,E)=>e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:E*.05},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("div",{className:`inline-flex p-2 rounded-lg ${j.color} mb-3`,children:e.jsx(j.icon,{className:"w-4 h-4"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:j.value}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-white",children:j.label})]},j.label))}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:a.map((j,E)=>e.jsxs(o.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1+E*.05},onClick:()=>s(`/dashboard/codearena/${j.path}`),className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 text-left hover:border-gray-300 dark:hover:border-gray-600 hover:shadow-sm transition-all group",children:[e.jsx("div",{className:`inline-flex p-3 rounded-lg ${j.color} mb-4`,children:e.jsx(j.icon,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:j.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-white mb-4",children:j.description}),e.jsxs("div",{className:"flex items-center gap-1 text-[#00ADB5] dark:text-[#00ADB5] text-sm font-medium group-hover:gap-2 transition-all",children:[e.jsx("span",{children:"Get Started"}),e.jsx(Ge,{className:"w-4 h-4"})]})]},j.title))}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-green-600"}),"Live Battles"]}),e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-50 dark:bg-green-900/30 px-2 py-1 rounded-full",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),y?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(se,{className:"w-5 h-5 text-gray-400 animate-spin"})}):n.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-white",children:[e.jsx(He,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No active battles"}),e.jsx("button",{onClick:()=>s("/dashboard/codearena/battle"),className:"mt-2 text-xs text-[#00ADB5] hover:underline",children:"Start a battle"})]}):e.jsx("div",{className:"space-y-3",children:n.map((j,E)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex -space-x-2",children:j.participants?.slice(0,2).map((g,b)=>e.jsx("div",{className:`w-7 h-7 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center text-xs font-bold text-white ${b===0?"bg-[#00ADB5]":"bg-purple-500"}`,children:g.userName?.[0]||"?"},b))}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[j.participants?.[0]?.userName||"Player"," vs ",j.participants?.[1]?.userName||"Waiting..."]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white capitalize",children:j.difficulty||"Medium"})]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${j.status==="waiting"?"text-[#00ADB5] bg-[#00ADB5]/10 dark:bg-[#00ADB5]/20":"text-orange-600 bg-orange-50 dark:bg-orange-900/30"}`,children:j.status==="waiting"?"Waiting":"In Progress"})]},j.id||E))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-amber-500"}),"Top Players"]}),e.jsx("button",{onClick:()=>s("/dashboard/codearena/leaderboard"),className:"text-sm text-[#00ADB5] dark:text-[#00ADB5] hover:underline",children:"View All"})]}),T?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(se,{className:"w-5 h-5 text-gray-400 animate-spin"})}):p.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-white",children:[e.jsx(pe,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No rankings yet"}),e.jsx("button",{onClick:()=>s("/dashboard/codearena/practice"),className:"mt-2 text-xs text-[#00ADB5] hover:underline",children:"Start solving challenges"})]}):e.jsx("div",{className:"space-y-3",children:p.map(j=>{const E=["text-amber-500 bg-amber-50 dark:bg-amber-900/30","text-gray-400 bg-gray-100 dark:bg-gray-700","text-orange-500 bg-orange-50 dark:bg-orange-900/30"];return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold ${E[j.rank-1]||"text-gray-600 dark:text-white bg-gray-50 dark:bg-gray-700"}`,children:j.rank}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:j.odName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-white",children:[j.problemsSolved," solved"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[#00ADB5] dark:text-[#00ADB5]",children:[e.jsx(qe,{className:"w-3 h-3"}),e.jsx("span",{className:"text-sm font-medium",children:j.rating})]})]},j.odId)})})]})]})]})},hr=()=>e.jsx(er,{children:e.jsx(tr,{})});export{hr as default};
