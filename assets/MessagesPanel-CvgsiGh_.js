import{i as A,r as i,j as e,M as u,K as m,V as M,X as S,n as U}from"./index-YQPxzjda.js";import{b as D,C as T}from"./ChatWindow-DvLOtmOF.js";function L(){const{user:n}=A(),[d,w]=i.useState([]),[g,f]=i.useState(null),[j,p]=i.useState(!1),[b,l]=i.useState(!1),[x,N]=i.useState("");i.useEffect(()=>{if(!n?.id)return;const t=D(n.id,s=>{w(s)});return()=>t()},[n?.id]);const y=d.filter(t=>{const s=t.participants.find(r=>r!==n?.id)||"";return(t.participantNames[s]||"").toLowerCase().includes(x.toLowerCase())||t.projectTitle.toLowerCase().includes(x.toLowerCase())}),h=d.reduce((t,s)=>t+(s.unreadCount[n?.id||""]||0),0),v=t=>{const s=new Date,o=t instanceof Date?t:new Date(t),r=s.getTime()-o.getTime(),a=Math.floor(r/6e4),c=Math.floor(r/36e5),k=Math.floor(r/864e5);return isNaN(r)?"":a<1?"Just now":a<60?`${a}m`:c<24?`${c}h`:`${k}d`},C=t=>{f(t),p(!0),l(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>l(!b),className:"relative p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(u,{className:"w-6 h-6 text-gray-600 dark:text-white"}),h>0&&e.jsx(m.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 w-5 h-5 rounded-full text-white text-xs font-bold flex items-center justify-center",style:{backgroundColor:"#00ADB5"},children:h>9?"9+":h})]}),e.jsx(M,{children:b&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>l(!1)}),e.jsxs(m.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:"absolute right-0 mt-2 w-96 bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 z-50 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",style:{background:"linear-gradient(135deg, #00ADB5 0%, #00d4ff 100%)"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"Messages"]}),e.jsx("button",{onClick:()=>l(!1),className:"p-1 rounded-lg hover:bg-white/20 transition-colors",children:e.jsx(S,{className:"w-5 h-5 text-white"})})]}),e.jsxs("div",{className:"mt-3 relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/60"}),e.jsx("input",{type:"text",placeholder:"Search conversations...",value:x,onChange:t=>N(t.target.value),className:"w-full pl-9 pr-4 py-2 bg-white/20 backdrop-blur-sm border border-white/30 rounded-lg text-white placeholder-white/60 focus:outline-none focus:ring-2 focus:ring-white/50 text-sm"})]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:y.length===0?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(u,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:d.length===0?"No conversations yet":"No matching conversations"})]}):y.map(t=>{const s=t.participants.find(c=>c!==n?.id)||"",o=t.participantNames[s]||"User",r=t.participantAvatars[s]||"",a=t.unreadCount[n?.id||""]||0;return e.jsxs(m.button,{onClick:()=>C(t),whileHover:{backgroundColor:"rgba(0, 173, 181, 0.05)"},className:"w-full p-4 border-b border-gray-100 dark:border-gray-700 flex items-start gap-3 text-left transition-colors",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden",style:{border:a>0?"2px solid #00ADB5":"2px solid transparent"},children:r?e.jsx("img",{src:r,alt:o,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:"#00ADB5"},children:o.charAt(0).toUpperCase()})}),a>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 rounded-full text-white text-xs font-bold flex items-center justify-center",style:{backgroundColor:"#00ADB5"},children:a})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("h4",{className:`font-semibold truncate ${a>0?"text-gray-900 dark:text-white":"text-gray-700 dark:text-gray-300"}`,children:o}),e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 flex-shrink-0",children:v(t.lastMessageTime)})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mb-1",children:t.projectTitle}),e.jsx("p",{className:`text-sm truncate ${a>0?"text-gray-900 dark:text-white font-medium":"text-gray-500 dark:text-gray-400"}`,children:t.lastMessage||"No messages yet"})]})]},t.id)})})]})]})})]}),g&&e.jsx(T,{chat:g,isOpen:j,onClose:()=>{p(!1),f(null)}})]})}export{L as M};
