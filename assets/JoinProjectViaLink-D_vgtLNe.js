import{H as C,k as E,u as S,r as s,j as e,x as u,a8 as f,v as p}from"./index-BzRIhZ-q.js";import{L as y}from"./loader-circle-DVLeULxj.js";import{C as $}from"./circle-x-C9iWB6md.js";import{C as J}from"./circle-alert--z75wfPX.js";function P(){const{inviteToken:n}=C(),{user:d}=E(),l=S(),[r,v]=s.useState(null),[k,x]=s.useState(!0),[m,g]=s.useState(!1),[o,c]=s.useState(null),[w,N]=s.useState(!1),h=()=>localStorage.getItem("authToken");s.useEffect(()=>{(async()=>{if(!n){c("Invalid invite link"),x(!1);return}try{const t=h(),i={};t&&(i.Authorization=`Bearer ${t}`);const j=await fetch(`${p}/project-invites/join/${n}`,{headers:i}),b=await j.json();if(!j.ok)throw new Error(b.error||"Invalid invite link");v(b.invite)}catch(t){console.error("Error validating invite:",t),c(t instanceof Error?t.message:"Failed to validate invite")}finally{x(!1)}})()},[n]);const I=async()=>{if(!d){localStorage.setItem("pendingInvite",`/project/join/${n}`),l("/login");return}try{g(!0),c(null);const a=h(),t=await fetch(`${p}/project-invites/join/${n}/accept`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}}),i=await t.json();if(!t.ok)throw new Error(i.error||"Failed to join project");N(!0),setTimeout(()=>{l(`/dashboard/projects/workspace/${i.projectId}`)},1500)}catch(a){console.error("Error joining project:",a),c(a instanceof Error?a.message:"Failed to join project")}finally{g(!1)}};return k?e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-950 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"w-12 h-12 text-teal-500 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Validating invite link..."})]})}):o&&!r?e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-950 flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl p-8 max-w-md w-full text-center shadow-xl",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx($,{className:"w-8 h-8 text-red-500"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Invalid Invite"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:o}),e.jsx("button",{onClick:()=>l("/dashboard"),className:"px-6 py-2 bg-teal-500 hover:bg-teal-600 text-white rounded-lg font-medium",children:"Go to Dashboard"})]})}):w?e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-950 flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl p-8 max-w-md w-full text-center shadow-xl",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(u,{className:"w-8 h-8 text-green-500"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Successfully Joined!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Redirecting to project workspace..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-950 flex items-center justify-center p-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl p-8 max-w-md w-full shadow-xl",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-teal-100 dark:bg-teal-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(f,{className:"w-8 h-8 text-teal-500"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"You're Invited!"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You've been invited to join a project"})]}),r&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-4 mb-6",children:[e.jsx("h2",{className:"font-semibold text-lg text-gray-900 dark:text-white mb-1",children:r.projectTitle}),r.projectDescription&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2",children:r.projectDescription}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:["Invited by ",e.jsx("span",{className:"font-medium",children:r.invitedByName})]})]}),o&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm mb-4",children:[e.jsx(J,{className:"w-4 h-4 flex-shrink-0"}),o]}),!d&&e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-400",children:"Please log in to accept this invite"})}),e.jsx("button",{onClick:I,disabled:m,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-teal-500 hover:bg-teal-600 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white rounded-xl font-semibold",children:m?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-5 h-5 animate-spin"}),"Joining..."]}):d?e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"w-5 h-5"}),"Accept & Join Project"]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-5 h-5"}),"Login to Join"]})}),e.jsx("button",{onClick:()=>l("/dashboard"),className:"w-full mt-3 px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"Cancel"})]})})}export{P as default};
