import{c as ne,u as pe,i as fe,r as i,j as e,N as te,J as c,T as ue,b as Q,O as ee,p as Nt,q as F,k as be,Q as oe,n as kt,h as we,U as He,X as it,Z as Oe,t as Ye,C as re,f as qe,V as qt,W as Te,Y as Se,$ as Gt,o as le,m as lt,z as St,D as Ce,L as Ct,d as Jt,B as Qt,a0 as mt,a1 as st,a2 as Kt,a3 as ie}from"./index-Do6L6L7r.js";import{C as ve}from"./circle-x-B3yhirB_.js";import{C as Ge}from"./chevron-right-C5wyxB07.js";import{S as Ue}from"./shield-DXfnhg_j.js";import{S as Ae}from"./star-BcwNFYuN.js";import{C as ot}from"./chevron-down-DuNN5z-J.js";import{S as ct}from"./send-DG_CacyJ.js";import{P as At}from"./play-Cb-cqSH8.js";import{E as Xt}from"./eye-DivBG1bn.js";import{C as ut}from"./circle-alert-BwK7_eww.js";import{U as Zt}from"./upload-ITar4G7a.js";import{T as ea}from"./trash-2-DtG7D2H5.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],aa=ne("arrow-down-right",ta);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],ra=ne("arrow-up-right",sa);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],ge=ne("crown",na);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],la=ne("database",ia);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"M11 20H2",key:"nlcfvz"}],["path",{d:"M11 4.562v16.157a1 1 0 0 0 1.242.97L19 20V5.562a2 2 0 0 0-1.515-1.94l-4-1A2 2 0 0 0 11 4.561z",key:"au4z13"}],["path",{d:"M11 4H8a2 2 0 0 0-2 2v14",key:"74r1mk"}],["path",{d:"M14 12h.01",key:"1jfl7z"}],["path",{d:"M22 20h-3",key:"vhrsz"}]],ca=ne("door-open",oa);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ma=ne("eye-off",da);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ae=ne("loader-circle",ua);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],De=ne("medal",xa);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ha=ne("rotate-ccw",ga);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Et=ne("trending-down",pa);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Tt=ne("triangle-alert",fa);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],ya=ne("wallet",ba),ja=()=>{const t=pe(),{user:a}=fe(),[s,r]=i.useState([]),[n,m]=i.useState(!0),[p,h]=i.useState("all"),[y,w]=i.useState({totalBattles:0,wins:0,losses:0,winRate:0,totalEarnings:0});i.useEffect(()=>{(async()=>{if(!a){m(!1);return}try{const o=(await F(`/battles/user/${a.id}`)).battles||[];console.log("User battles:",o.length),console.log("Current user ID:",a.id),console.log("User participated in:",o.length,"battles");const C=o.filter(L=>L.status==="completed"||L.status==="forfeited");C.sort((L,d)=>{const E=x=>x?typeof x=="object"&&"toDate"in x&&x.toDate?x.toDate().getTime():x instanceof Date?x.getTime():typeof x=="number"?x:0:0;return E(d.createdAt)-E(L.createdAt)}),console.log("Completed battles:",C.length),C.length>0&&console.log("Sample battle:",C[0]),r(C);let k=0,P=0,$=0;o.forEach(L=>{L.winnerId===a.id?(k++,$+=L.prize||0):L.winnerId&&L.winnerId!==a.id&&(P++,$-=L.entryFee||0)}),w({totalBattles:o.length,wins:k,losses:P,winRate:o.length>0?Math.round(k/o.length*100):0,totalEarnings:$})}catch(j){console.error("Error fetching battle history:",j)}finally{m(!1)}})()},[a]);const S=()=>p==="all"?s:p==="won"?s.filter(g=>g.winnerId===a?.id):p==="lost"?s.filter(g=>g.winnerId&&g.winnerId!==a?.id):s,A=g=>{if(!g)return"N/A";let j;return typeof g=="object"&&"toDate"in g&&g.toDate?j=g.toDate():g instanceof Date?j=g:j=new Date(g),new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(j)},b=g=>g.participants?.find(o=>{const C=o;return C.odId!==a?.id&&C.userId!==a?.id}),B=g=>g.participants?.find(o=>{const C=o;return C.odId===a?.id||C.userId===a?.id});return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"w-12 h-12 text-[#00ADB5] animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading battle history..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-900 dark:to-gray-800",children:[e.jsxs("header",{className:"relative overflow-hidden py-8 md:py-12",style:{background:"linear-gradient(135deg, #00ADB5 0%, #00d4ff 100%)"},children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/10 to-transparent"}),e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-white/10 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2"})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 relative z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e.jsx(te,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:"Battle History"}),e.jsx("p",{className:"text-white/80 text-sm",children:"Your past matches and performance"})]})]})}),e.jsxs("button",{onClick:()=>t("/dashboard/codearena/battle"),className:"px-5 py-2.5 bg-white text-[#00ADB5] font-semibold rounded-xl hover:bg-white/90 transition-all shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"New Battle"]})]})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-2 md:grid-cols-5 gap-3 md:gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 p-4 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-100 dark:bg-gray-700 flex items-center justify-center",children:e.jsx(ue,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Total Battles"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y.totalBattles})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/30 dark:to-emerald-900/30 rounded-2xl shadow-lg border border-green-100 dark:border-green-800 p-4 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-100 dark:bg-green-800/50 flex items-center justify-center",children:e.jsx(Q,{className:"w-5 h-5 text-green-600 dark:text-green-400"})})}),e.jsx("p",{className:"text-xs text-green-600 dark:text-green-400 mb-1",children:"Victories"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:y.wins})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/30 dark:to-orange-900/30 rounded-2xl shadow-lg border border-red-100 dark:border-red-800 p-4 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-100 dark:bg-red-800/50 flex items-center justify-center",children:e.jsx(ve,{className:"w-5 h-5 text-red-600 dark:text-red-400"})})}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mb-1",children:"Defeats"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:y.losses})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cyan-50 to-teal-50 dark:from-cyan-900/30 dark:to-teal-900/30 rounded-2xl shadow-lg border border-cyan-100 dark:border-cyan-800 p-4 hover:shadow-xl transition-all",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-10 h-10 rounded-xl bg-[#00ADB5]/20 flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-[#00ADB5]"})})}),e.jsx("p",{className:"text-xs text-[#00ADB5] mb-1",children:"Win Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-[#00ADB5]",children:[y.winRate,"%"]})]}),e.jsxs("div",{className:`rounded-2xl shadow-lg border p-4 hover:shadow-xl transition-all ${y.totalEarnings>=0?"bg-gradient-to-br from-amber-50 to-yellow-50 dark:from-amber-900/30 dark:to-yellow-900/30 border-amber-100 dark:border-amber-800":"bg-white dark:bg-gray-800 border-gray-100 dark:border-gray-700"}`,children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${y.totalEarnings>=0?"bg-amber-100 dark:bg-amber-800/50":"bg-gray-100 dark:bg-gray-700"}`,children:e.jsx(ee,{className:`w-5 h-5 ${y.totalEarnings>=0?"text-amber-600 dark:text-amber-400":"text-gray-600"}`})})}),e.jsx("p",{className:`text-xs mb-1 ${y.totalEarnings>=0?"text-amber-600 dark:text-amber-400":"text-gray-500"}`,children:"Total Earnings"}),e.jsxs("p",{className:`text-2xl font-bold ${y.totalEarnings>=0?"text-amber-600 dark:text-amber-400":"text-red-600"}`,children:[y.totalEarnings>=0?"+":"",y.totalEarnings]})]})]}),e.jsx(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex items-center gap-2 bg-white dark:bg-gray-800 rounded-xl shadow-md border border-gray-100 dark:border-gray-700 p-1.5 w-fit",children:[{id:"all",label:"All Battles",count:s.length},{id:"won",label:"Victories",count:s.filter(g=>g.winnerId===a?.id).length},{id:"lost",label:"Defeats",count:s.filter(g=>g.winnerId&&g.winnerId!==a?.id).length}].map(g=>e.jsxs("button",{onClick:()=>h(g.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2 ${p===g.id?"bg-gradient-to-r from-[#00ADB5] to-[#00d4ff] text-white shadow-md":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[g.label,e.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded-full ${p===g.id?"bg-white/20":"bg-gray-200 dark:bg-gray-600"}`,children:g.count})]},g.id))}),e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"space-y-3",children:S().length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-100 dark:border-gray-700 p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-100 dark:bg-gray-700 mx-auto mb-4 flex items-center justify-center",children:e.jsx(te,{className:"w-10 h-10 text-gray-400 dark:text-gray-500"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:"No battles found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto",children:p==="all"?"You haven't participated in any battles yet. Start your first battle and prove your coding skills!":p==="won"?"No victories yet. Keep practicing and you'll get there!":"No defeats recorded. You're doing great!"}),e.jsxs("button",{onClick:()=>t("/dashboard/codearena/battle"),className:"px-6 py-3 bg-gradient-to-r from-[#00ADB5] to-[#00d4ff] text-white font-semibold rounded-xl hover:shadow-lg transition-all transform hover:scale-105 inline-flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5"}),"Start Your First Battle"]})]}):S().map((g,j)=>{const o=g.winnerId===a?.id,C=b(g),k=B(g),P=g.status==="forfeited"&&g.forfeitedBy!==a?.id,$=g.status==="forfeited"&&g.forfeitedBy===a?.id;return e.jsxs(c.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{delay:j*.05},whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},onClick:()=>t(`/dashboard/codearena/battle/results/${g.id}`),className:`bg-white dark:bg-gray-800 rounded-2xl shadow-md border-2 p-4 cursor-pointer hover:shadow-xl transition-all group ${o?"border-green-200 dark:border-green-700/50 hover:border-green-400 dark:hover:border-green-600":"border-red-200 dark:border-red-700/50 hover:border-red-400 dark:hover:border-red-600"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center shadow-lg ${o?"bg-gradient-to-br from-green-400 to-emerald-500":"bg-gradient-to-br from-red-400 to-orange-500"}`,children:o?e.jsx(Q,{className:"w-7 h-7 text-white"}):e.jsx(ve,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-lg font-bold ${o?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:o?"ðŸ† Victory":"ðŸ’” Defeat"}),P&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-400 rounded-full font-medium",children:"Opponent Left"}),$&&e.jsx("span",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-full font-medium",children:"Forfeited"})]}),e.jsxs("p",{className:"text-gray-700 dark:text-gray-300 font-medium",children:["vs ",e.jsx("span",{className:"text-gray-900 dark:text-white",children:C?.odName||"Unknown Player"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(Nt,{className:"w-3.5 h-3.5"}),A(g.endTime||g.createdAt)]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium capitalize ${g.difficulty==="easy"?"bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-400":g.difficulty==="medium"?"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-400":"bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-400"}`,children:g.difficulty})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[k?.submissionResult&&e.jsxs("div",{className:"text-center hidden md:block bg-gray-50 dark:bg-gray-700/50 px-4 py-2 rounded-xl",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-0.5",children:"Tests Passed"}),e.jsxs("p",{className:`text-lg font-bold ${k.submissionResult.passed?"text-green-600 dark:text-green-400":"text-orange-600 dark:text-orange-400"}`,children:[k.submissionResult.passedCount,"/",k.submissionResult.totalCount]})]}),e.jsxs("div",{className:`text-center px-4 py-2 rounded-xl ${o?"bg-green-50 dark:bg-green-900/30":"bg-red-50 dark:bg-red-900/30"}`,children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-0.5",children:"Coins"}),e.jsxs("p",{className:`text-lg font-bold flex items-center justify-center gap-1 ${o?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[e.jsx(ee,{className:"w-4 h-4"}),o?"+":"-",o?g.prize:g.entryFee]})]}),e.jsx("div",{className:"hidden md:flex w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 items-center justify-center group-hover:bg-[#00ADB5] group-hover:text-white transition-all",children:e.jsx(Ge,{className:"w-5 h-5 text-gray-400 group-hover:text-white group-hover:translate-x-0.5 transition-all"})})]})]}),g.winReason&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-700",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:"Result: "}),g.winReason]})})]},g.id)})})]})]})},Bt=async t=>{try{const a=await F("/battles/create",{method:"POST",body:JSON.stringify(t)});return console.log(`Created battle ${a.battleId}`),a.battleId}catch(a){throw console.error("Error creating random battle:",a),a}},wa=async(t,a)=>{try{return(await F(`/battles/find?difficulty=${t}&entryFee=${a}`)).battle?._id||null}catch(s){return console.error("Error finding available battle:",s),null}},va=async t=>{try{const{difficulty:a,entryFee:s}=t,r=await wa(a,s);if(r)return r;const n=await Bt(t);if(!n)throw new Error("Failed to create battle");return n}catch(a){throw console.error("Error joining or creating battle:",a),a}},Na=async(t,a,s)=>{try{if(t.originalBattleId){const r=await F(`/battles/${t.originalBattleId}/rematch`,{method:"POST",body:JSON.stringify({to:a,toName:s||"Opponent",fromName:t.userName,difficulty:t.difficulty,entryFee:t.entryFee,userName:t.userName,userAvatar:t.userAvatar,rating:t.rating})});return console.log(`Created rematch battle ${r.battleId}`),r.battleId}return Bt(t)}catch(r){throw console.error("Error creating rematch battle:",r),r}},ka=[{id:"easy",label:"Easy",color:"bg-green-500",rating:"800-1200",time:15},{id:"medium",label:"Medium",color:"bg-yellow-500",rating:"1200-1600",time:20},{id:"hard",label:"Hard",color:"bg-red-500",rating:"1600-2000",time:30}],xt=[{fee:5,prize:9},{fee:10,prize:18},{fee:20,prize:36},{fee:50,prize:90}],Sa=({wallet:t})=>{const a=pe(),{user:s}=fe(),{userprofile:r,deductCoins:n}=be(),[m,p]=i.useState("medium"),[h,y]=i.useState(xt[1]),[w,S]=i.useState(!1),[A,b]=i.useState(!1),[B,g]=i.useState([]),[j,o]=i.useState(null),[C,k]=i.useState(0);i.useEffect(()=>{if(!s)return;const u=async()=>{try{const O=((await F(`/battles?status=waiting&difficulty=${m}`)).battles||[]).filter(D=>D.creatorId!==s.id);g(O)}catch(_){console.error("Error fetching waiting battles:",_)}};u();const T=setInterval(u,5e3);return()=>clearInterval(T)},[s,m]),i.useEffect(()=>{if(!j||!w||!s)return;const u=async()=>{try{const _=await F(`/battles/${j}`);if(_&&(_.status==="countdown"||_.status==="active"||_.participants&&_.participants.length>=2)){console.log("Opponent found! Navigating to battle..."),a(`/dashboard/codearena/battle/${j}`);return}const O=((await F(`/battles?status=waiting&difficulty=${m}`)).battles||[]).filter(D=>D.creatorId!==s.id&&D.id!==j&&D.entryFee===h.fee);if(O.length>0){const D=O[0];console.log("Auto-match: Found existing battle, joining...",D.id);try{await F(`/battles/${j}`,{method:"DELETE"})}catch{console.log("Could not delete own battle, may already be matched")}await F(`/battles/${D.id}/join`,{method:"POST",body:JSON.stringify({userId:s.id,userName:r?.name||s.email?.split("@")[0]||"User",userAvatar:r?.profilePic||"",rating:t?.rating||1e3})}),a(`/dashboard/codearena/battle/${D.id}`)}}catch(_){console.error("Error polling battle status:",_)}};u();const T=setInterval(u,2e3);return()=>clearInterval(T)},[j,w,a,s,m,h.fee,r,t]),i.useEffect(()=>{if(!j||!w)return;const u=async()=>{try{const T=localStorage.getItem("token");navigator.sendBeacon(`https://nextstepbackend-qhxw.onrender.com/api/battles/${j}/cancel`,JSON.stringify({token:T}))}catch(T){console.error("Error cancelling battle:",T)}};return window.addEventListener("beforeunload",u),()=>{window.removeEventListener("beforeunload",u),j&&w&&F(`/battles/${j}`,{method:"DELETE"}).catch(()=>{})}},[j,w]),i.useEffect(()=>{let u;return w&&(u=setInterval(()=>{k(T=>T+1)},1e3)),()=>clearInterval(u)},[w]);const P=async()=>{if(console.log("handleFindMatch called",{user:s,wallet:t,selectedEntry:h}),!s){alert("Please log in to find a match");return}if(!t){alert("Wallet not loaded. Please wait or refresh the page.");return}if((t.coins||0)<h.fee){alert(`Insufficient coins! You have ${t.coins||0} coins but need ${h.fee} coins.`);return}S(!0),k(0);try{const u=B.find(T=>T.difficulty===m&&T.entryFee===h.fee&&T.creatorId!==s.id);await n(s.id,h.fee,"Battle entry fee"),u?await L(u):await $()}catch(u){console.error("Error finding match:",u),alert("Failed to find match. Please try again."),S(!1)}},$=async()=>{try{if(b(!0),!t){alert("Wallet not initialized. Please refresh the page."),S(!1);return}if((t.coins||0)<h.fee){alert(`Insufficient coins! You have ${t.coins||0} coins but need ${h.fee} coins.`),S(!1);return}const u={difficulty:m,entryFee:h.fee,userId:s.id,userName:r?.name||s.email?.split("@")[0]||"User",userAvatar:r?.profilePic||"",rating:t?.rating||1e3};console.log("Creating battle with request:",u);const T=await va(u);console.log("Battle created with ID:",T),o(T)}catch(u){console.error("Error creating battle:",u),alert(u instanceof Error?u.message:"Failed to create battle"),S(!1)}finally{b(!1)}},L=async u=>{try{if(!t){alert("Wallet not initialized. Please refresh the page."),S(!1);return}if((t.coins||0)<u.entryFee){alert(`Insufficient coins! You have ${t.coins||0} coins but need ${u.entryFee} coins.`),S(!1);return}console.log("Joining battle:",u.id),await F(`/battles/${u.id}/join`,{method:"POST",body:JSON.stringify({userId:s.id,userName:r?.name||s.email?.split("@")[0]||"User",userAvatar:r?.profilePic||"",rating:t?.rating||1e3})}),a(`/dashboard/codearena/battle/${u.id}`)}catch(T){console.error("Error joining battle:",T),alert(T instanceof Error?T.message:"Failed to join battle"),S(!1)}},d=async()=>{if(j)try{await n(s.id,-h.fee,"Battle cancelled - refund"),await F(`/battles/${j}`,{method:"DELETE"})}catch(u){console.error("Error cancelling battle:",u)}S(!1),o(null),k(0)},E=u=>{const T=Math.floor(u/60),_=u%60;return`${T}:${_.toString().padStart(2,"0")}`},x=t?.coins??0,I=x>=h.fee,v=!t||!I||w||A;return console.log("BattleLobby render:",{wallet:t,walletCoins:x,selectedEntry:h,hasEnoughCoins:I,isButtonDisabled:v}),e.jsxs("div",{className:"space-y-6 pb-20 md:pb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg",children:e.jsx(te,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Battle Arena"}),e.jsx("p",{className:"text-gray-500 dark:text-white text-xs",children:"Compete against other coders in real-time"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-amber-50 dark:bg-amber-900/30 rounded-lg",children:[e.jsx(ee,{className:"w-4 h-4 text-amber-600"}),e.jsxs("span",{className:"text-amber-700 dark:text-amber-400 font-semibold text-sm",children:["Balance: ",t?.coins?.toLocaleString()||0," coins"]})]})]}),e.jsx(oe,{children:w&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(c.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white dark:bg-gray-800 rounded-2xl p-8 max-w-md w-full mx-4 text-center",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-6",children:[e.jsx(c.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"absolute inset-0 rounded-full border-4 border-[#00ADB5]/30 dark:border-[#00ADB5]/40 border-t-blue-600"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(kt,{className:"w-8 h-8 text-[#00ADB5]"})})]}),e.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-[#00ADB5] to-purple-600 bg-clip-text text-transparent mb-2",children:"ðŸ” Finding Opponent..."}),e.jsxs("p",{className:"text-gray-600 dark:text-white mb-6 text-lg",children:["Searching for a ",e.jsx("span",{className:"font-bold text-[#00ADB5]",children:m})," battle ðŸŽ¯"]}),e.jsxs("div",{className:"flex items-center justify-center gap-3 text-3xl font-mono bg-gradient-to-r from-[#00ADB5] to-purple-600 bg-clip-text text-transparent mb-6 font-bold",children:[e.jsx(we,{className:"w-6 h-6 text-[#00ADB5]"}),E(C)]}),e.jsxs("div",{className:"flex items-center justify-center gap-6 text-sm text-gray-600 mb-8",children:[e.jsxs(c.span,{animate:{scale:[1,1.1,1]},transition:{duration:1.5,repeat:1/0},className:"flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-green-100 to-emerald-100 rounded-full",children:[e.jsx(He,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{className:"font-semibold text-green-700",children:[B.length," players waiting"]})]}),e.jsxs("span",{className:"flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-amber-100 to-yellow-100 rounded-full",children:[e.jsx(ee,{className:"w-4 h-4 text-amber-600"}),e.jsxs("span",{className:"font-semibold text-amber-700",children:["Entry: ",h.fee]})]})]}),e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:d,className:"flex items-center justify-center gap-2 w-full py-4 bg-gradient-to-r from-red-500 to-pink-500 text-white font-bold rounded-2xl hover:from-red-600 hover:to-pink-600 transition-all shadow-lg",children:[e.jsx(it,{className:"w-5 h-5"}),"Cancel Battle ðŸš«"]})]})})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm mb-3",children:"Select Difficulty"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-6",children:ka.map(u=>e.jsxs(c.button,{whileHover:{scale:1.03,y:-2},whileTap:{scale:.97},onClick:()=>p(u.id),className:`p-3 rounded-xl border-2 transition-all relative overflow-hidden ${m===u.id?"border-[#00ADB5] bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 shadow-md":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:shadow-md bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-700"}`,children:[m===u.id&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/10 to-purple-400/10 rounded-xl"}),e.jsx("div",{className:`w-3 h-3 rounded-full ${u.color} mb-2 mx-auto shadow-sm`}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:u.label}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:u.rating}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-white mt-0.5",children:[e.jsx(we,{className:"w-3 h-3 inline mr-0.5"}),u.time,"m"]})]},u.id))}),e.jsxs("h3",{className:"font-semibold text-sm text-gray-800 dark:text-gray-200 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"ðŸ’°"})," Entry Fee & Prize"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:xt.map(u=>e.jsxs(c.button,{whileHover:{scale:t?.coins>=u.fee?1.03:1},whileTap:{scale:t?.coins>=u.fee?.97:1},onClick:()=>y(u),disabled:t?.coins<u.fee,className:`p-3 rounded-xl border-2 transition-all relative overflow-hidden ${h.fee===u.fee?"border-amber-400 bg-gradient-to-br from-amber-50 to-yellow-50 dark:from-amber-900/30 dark:to-yellow-900/30 shadow-md":t?.coins<u.fee?"border-gray-200 dark:border-gray-600 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 opacity-50 cursor-not-allowed":"border-gray-200 dark:border-gray-600 hover:border-amber-300 dark:hover:border-amber-600 hover:shadow-md bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-700"}`,children:[h.fee===u.fee&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-amber-400/10 to-yellow-400/10 rounded-xl"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-amber-600 font-medium text-sm",children:[e.jsx(ee,{className:"w-3.5 h-3.5"}),u.fee]}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-green-600 text-xs mt-0.5",children:[e.jsx(Q,{className:"w-3 h-3"}),"Win ",u.prize]})]},u.fee))}),e.jsx(c.button,{whileHover:{scale:v?1:1.02},whileTap:{scale:v?1:.98},onClick:P,disabled:v,className:`w-full py-3 rounded-xl font-semibold text-base flex items-center justify-center gap-2 transition-all shadow-md ${v?"bg-gradient-to-r from-gray-300 to-gray-400 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-[#00ADB5] via-purple-600 to-indigo-600 text-white hover:from-blue-700 hover:via-purple-700 hover:to-indigo-700 cursor-pointer"}`,children:A?e.jsxs(e.Fragment,{children:[e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-4 h-4"}),"Find Match",e.jsx(Ge,{className:"w-4 h-4"})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2 text-xs text-green-600 dark:text-green-400",children:[e.jsx(Ue,{className:"w-3 h-3"}),e.jsx("span",{children:"Secure Battle System"})]}),!t&&e.jsx("p",{className:"text-center text-amber-500 text-xs mt-2",children:"Loading wallet... Please wait"}),t&&!I&&e.jsxs("p",{className:"text-center text-red-500 text-xs mt-2",children:["Need ",h.fee-x," more coins (You have ",x,")"]}),t&&I&&e.jsxs("p",{className:"text-center text-green-500 text-xs mt-2",children:["Ready to battle! (",x," coins available)"]})]}),B.length>0&&e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-white to-green-50 dark:from-gray-800 dark:to-green-900/20 rounded-xl border border-green-200 dark:border-green-700 shadow p-4 relative overflow-hidden",children:[e.jsxs("h3",{className:"font-bold text-sm text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg",children:e.jsx(He,{className:"w-4 h-4 text-white"})}),"Open Battles",e.jsxs(c.span,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"text-xs bg-gradient-to-r from-green-500 to-emerald-500 text-white px-2 py-0.5 rounded-full font-semibold",children:[B.length," live"]})]}),e.jsx("div",{className:"space-y-2",children:B.map(u=>e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:u.creatorProfilePic||`https://api.dicebear.com/7.x/avataaars/svg?seed=${u.creatorId}`,alt:u.creatorName,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:u.creatorName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-white",children:[u.creatorRating," â€¢ ",u.difficulty]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-1 text-amber-600 font-medium text-sm",children:[e.jsx(ee,{className:"w-3 h-3"}),u.entryFee]}),e.jsxs("div",{className:"text-xs text-green-600",children:["Win ",u.prize]})]}),e.jsx("button",{onClick:async()=>{t?.coins>=u.entryFee&&(await n(s.id,u.entryFee,"Battle entry fee"),await L(u))},disabled:t?.coins<u.entryFee,className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-all ${t?.coins>=u.entryFee?"bg-[#00ADB5] text-white hover:bg-[#00ADB5]/80":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:"Join"})]})]},u.id))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-sm mb-3",children:"How Battles Work"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-3",children:[{icon:ee,title:"Pay Entry Fee",description:"Contribute coins to prize pool"},{icon:te,title:"Solve Problem",description:"Race to solve faster"},{icon:Q,title:"Winner Takes All",description:"Win the prize pool"}].map((u,T)=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-[#00ADB5]/20 dark:bg-[#00ADB5]/20 rounded-lg",children:e.jsx(u.icon,{className:"w-4 h-4 text-[#00ADB5]"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white text-sm",children:u.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:u.description})]})]},T))})]})]})},Ca=()=>{const t=["#00ADB5","#FFD700","#FF6B6B","#4ECDC4","#45B7D1"];for(let s=0;s<100;s++){const r=document.createElement("div");r.style.cssText=`
      position: fixed;
      width: 10px;
      height: 10px;
      background: ${t[Math.floor(Math.random()*t.length)]};
      left: ${Math.random()*100}vw;
      top: -10px;
      border-radius: ${Math.random()>.5?"50%":"0"};
      pointer-events: none;
      z-index: 9999;
      animation: confetti-fall ${2+Math.random()*2}s ease-out forwards;
    `,document.body.appendChild(r),setTimeout(()=>r.remove(),4e3)}};if(typeof document<"u"&&!document.getElementById("confetti-styles")){const t=document.createElement("style");t.id="confetti-styles",t.textContent=`
    @keyframes confetti-fall {
      to {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }
  `,document.head.appendChild(t)}const Aa=()=>{const{battleId:t}=Ye(),a=pe(),{user:s}=fe(),{userprofile:r}=be(),[n,m]=i.useState(null),[p,h]=i.useState(!0),[y,w]=i.useState(!1),[S,A]=i.useState(null),[b,B]=i.useState(null),[g,j]=i.useState(0),[o,C]=i.useState(!1),[k,P]=i.useState(""),[$,L]=i.useState(!1),[d,E]=i.useState(!1);i.useEffect(()=>{(async()=>{if(t)try{const u=await F(`/battles/${t}`),T=u.battle||u;if(console.log("Battle results data:",T),!T||!T.participants){a("/dashboard/codearena");return}m(T);const _=T.participants?.find(U=>U.odId===s?.id),z=T.participants?.find(U=>U.odId!==s?.id);A(_||null),B(z||null);const O=T.winnerId===s?.id;w(O),T.status==="forfeited"&&T.forfeitedBy!==s?.id&&C(!0);let D="";if(T.winReason)D=T.winReason;else if(T.status==="forfeited")T.forfeitedBy===s?.id?D="You left the battle":D="Opponent left the battle";else if(_&&z){const U=_.submissionResult?.passedCount||0,q=z.submissionResult?.passedCount||0,V=_.submissionResult?.totalTime||1/0,X=z.submissionResult?.totalTime||1/0;O?U>q?D=`You passed more test cases (${U} vs ${q})`:U===q&&V<X?D="Same test cases passed, but you were faster!":z.hasSubmitted?D="You solved it better!":D="Opponent did not submit":q>U?D=`Opponent passed more test cases (${q} vs ${U})`:U===q&&X<V?D="Same test cases passed, but opponent was faster":_.hasSubmitted?D="Opponent solved it better":D="You did not submit in time"}P(D),j(O?Math.floor(25+Math.random()*10):-Math.floor(15+Math.random()*10)),h(!1),O&&setTimeout(()=>{Ca()},500)}catch(u){console.error("Error fetching battle results:",u),h(!1)}})()},[t,s,a]);const x=v=>{const u=Math.floor(v/60),T=v%60;return`${u}m ${T}s`},I=async()=>{if(!(!s||!b||!n||$||d)){L(!0);try{const v=n.entryFee||50,u=n.difficulty||"easy",T=await Na({difficulty:u,entryFee:v,userId:s.id,userName:r?.name||"Player",userAvatar:r?.avatarUrl,rating:S?.rating||1e3,originalBattleId:t},b.odId,b.odName);if(T){E(!0),Te.success(`âš”ï¸ Rematch request sent to ${b.odName}! Waiting for response...`,{duration:5e3,icon:"âš”ï¸"});const z=setInterval(async()=>{try{const D=(await F(`/battles/${T}`)).battle;D?.status==="countdown"&&D?.participants?.length===2?(clearInterval(z),Te.success(`ðŸŽ‰ ${b.odName} accepted the rematch! Starting battle...`,{duration:3e3,icon:"ðŸŽ‰"}),a(`/dashboard/codearena/battle/${T}`)):D?.status==="rejected"&&(clearInterval(z),E(!1),Te.error(`${b?.odName||"Opponent"} declined the rematch request.`,{duration:4e3,icon:"âŒ"}))}catch(O){console.error("Error polling rematch status:",O),clearInterval(z),E(!1)}},5e3);setTimeout(()=>{clearInterval(z),d&&(E(!1),Te("Rematch request timed out. Please try again.",{duration:4e3,icon:"â°"}))},3e5)}}catch(v){console.error("Error creating rematch:",v),Te.error("Failed to send rematch request. Please try again."),E(!1)}finally{L(!1)}}};return p?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center",children:e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 py-8 px-4 relative overflow-hidden",children:[e.jsx(c.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>a("/dashboard/codearena/battle"),className:"absolute top-4 right-4 z-50 w-12 h-12 bg-gray-800/80 hover:bg-gray-700 border border-gray-600 rounded-full flex items-center justify-center text-gray-400 hover:text-white transition-all shadow-lg",children:e.jsx(it,{className:"w-6 h-6"})}),e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"absolute top-10 left-10 w-40 h-40 bg-gradient-to-br from-cyan-500/20 to-transparent rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-40 right-20 w-60 h-60 bg-gradient-to-br from-purple-500/15 to-transparent rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-20 left-20 w-32 h-32 bg-gradient-to-br from-yellow-500/20 to-transparent rounded-full blur-2xl"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[e.jsxs(c.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"text-center mb-10 relative",children:[y?e.jsxs(e.Fragment,{children:[e.jsxs(c.div,{animate:{rotate:[0,-10,10,-10,10,0],scale:[1,1.1,1]},transition:{duration:.8,delay:.3,repeat:1/0,repeatDelay:3},className:"w-40 h-40 mx-auto mb-6 bg-gradient-to-br from-yellow-400 via-orange-400 to-amber-500 rounded-full flex items-center justify-center shadow-2xl shadow-yellow-500/50 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-300/30 to-orange-300/30 rounded-full animate-pulse"}),e.jsx(Q,{className:"w-20 h-20 text-white relative z-10"})]}),e.jsx(c.h1,{initial:{y:20},animate:{y:0},transition:{delay:.5},className:"text-6xl font-bold bg-gradient-to-r from-yellow-400 via-orange-400 to-yellow-500 bg-clip-text text-transparent mb-4",children:"ðŸ† Victory!"}),e.jsx(c.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"text-2xl text-gray-300 mb-4",children:o?"ðŸšª Your opponent left the battle!":"âœ¨ Congratulations! You won the battle! âœ¨"}),o&&e.jsx(c.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.9},className:"text-lg text-yellow-400",children:"Prize coins have been awarded to you!"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(c.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"w-36 h-36 mx-auto mb-6 bg-gradient-to-br from-gray-600 via-gray-700 to-gray-800 rounded-full flex items-center justify-center shadow-2xl shadow-gray-500/30 relative overflow-hidden",children:[e.jsx(c.div,{className:"absolute inset-0 bg-gradient-to-r from-gray-500/20 to-gray-400/20 rounded-full",animate:{opacity:[.3,.5,.3]},transition:{duration:2,repeat:1/0}}),e.jsx(De,{className:"w-18 h-18 text-gray-400 relative z-10"})]}),e.jsx(c.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"text-5xl font-bold bg-gradient-to-r from-gray-400 via-gray-500 to-gray-400 bg-clip-text text-transparent mb-4",children:"ðŸ’” Defeat"}),e.jsx(c.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-xl text-gray-300 mb-2",children:"Good effort! Keep practicing!"}),e.jsx(c.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},className:"text-md text-cyan-400",children:"ðŸ’ª Every defeat is a step towards victory!"})]}),k&&e.jsx(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:1},className:`mt-6 px-6 py-3 rounded-xl border ${y?"bg-green-500/10 border-green-500/30 text-green-400":"bg-red-500/10 border-red-500/30 text-red-400"}`,children:e.jsxs("p",{className:"text-lg font-medium",children:["ðŸ“‹ ",k]})})]}),e.jsxs(c.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-gradient-to-br from-gray-800/60 via-gray-900/60 to-black/60 backdrop-blur-sm border border-gray-700/50 rounded-2xl p-8 mb-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-bl from-cyan-500/10 to-transparent rounded-full -translate-y-10 translate-x-10"}),e.jsxs("div",{className:"grid grid-cols-3 gap-6 items-center",children:[e.jsxs(c.div,{initial:{x:-30,opacity:0},animate:{x:0,opacity:1},transition:{delay:.4},className:"text-center",children:[e.jsx(c.div,{whileHover:{scale:1.1,rotate:5},className:`w-24 h-24 mx-auto mb-4 rounded-full flex items-center justify-center text-2xl font-bold text-white shadow-lg ${y?"bg-gradient-to-br from-yellow-400 to-amber-500 ring-4 ring-yellow-500/50 shadow-yellow-500/30":"bg-gradient-to-br from-cyan-400 to-blue-500 ring-2 ring-cyan-500/30 shadow-cyan-500/20"}`,children:r?.name?.[0]||"Y"}),e.jsx("p",{className:"text-white font-bold text-lg",children:r?.name||"You"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["Level ",S?.level||1]}),y&&e.jsxs(c.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.8,type:"spring"},className:"flex items-center justify-center gap-2 mt-2 text-yellow-400",children:[e.jsx(ge,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"ðŸ† Winner"})]})]}),e.jsx("div",{className:"text-center",children:e.jsx(c.div,{animate:{rotateY:[0,180,360]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"VS"})}),e.jsxs(c.div,{initial:{x:30,opacity:0},animate:{x:0,opacity:1},transition:{delay:.4},className:"text-center",children:[e.jsx(c.div,{whileHover:{scale:1.1,rotate:-5},className:`w-24 h-24 mx-auto mb-4 rounded-full flex items-center justify-center text-2xl font-bold text-white shadow-lg ${y?"bg-gradient-to-br from-red-400 to-orange-500 ring-2 ring-red-500/30 shadow-red-500/20":"bg-gradient-to-br from-yellow-400 to-amber-500 ring-4 ring-yellow-500/50 shadow-yellow-500/30"}`,children:b?.odName?.[0]||"O"}),e.jsx("p",{className:"text-white font-bold text-lg",children:b?.odName||"Opponent"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-2",children:["Level ",b?.level||1]}),!y&&e.jsxs(c.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.8,type:"spring"},className:"flex items-center justify-center gap-2 mt-2 text-yellow-400",children:[e.jsx(ge,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-semibold",children:"ðŸ† Winner"})]})]})]})]}),e.jsxs(c.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"bg-gray-800/50 border border-gray-700/50 rounded-2xl p-6 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5 text-cyan-400"}),"Battle Stats"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-2xl font-bold text-white",children:[S?.submissionResult?.passedCount||0,"/",S?.submissionResult?.totalCount||0]})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Tests Passed"})]})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-2xl font-bold text-white",children:[b?.submissionResult?.passedCount||0,"/",b?.submissionResult?.totalCount||0]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-2xl font-bold text-white",children:x(Math.round((S?.submissionResult?.totalTime||0)/1e3))})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Time Taken"})]})}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-2xl font-bold text-white",children:x(Math.round((b?.submissionResult?.totalTime||0)/1e3))})})]})]})]}),e.jsxs(c.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"grid md:grid-cols-2 gap-4 mb-6",children:[e.jsx("div",{className:`p-6 rounded-2xl border ${y?"bg-gradient-to-br from-yellow-500/20 to-amber-500/20 border-yellow-500/30":"bg-gray-800/50 border-gray-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Coins Earned"}),e.jsx("p",{className:`text-3xl font-bold ${y?"text-yellow-400":"text-gray-400"}`,children:y?`+${n?.prizePool||0}`:"+0"})]}),e.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${y?"bg-yellow-500/20":"bg-gray-700/50"}`,children:e.jsx(ee,{className:`w-7 h-7 ${y?"text-yellow-400":"text-gray-500"}`})})]})}),e.jsx("div",{className:`p-6 rounded-2xl border ${g>0?"bg-gradient-to-br from-green-500/20 to-emerald-500/20 border-green-500/30":"bg-gradient-to-br from-red-500/20 to-orange-500/20 border-red-500/30"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Rating Change"}),e.jsxs("p",{className:`text-3xl font-bold ${g>0?"text-green-400":"text-red-400"}`,children:[g>0?"+":"",g]})]}),e.jsx("div",{className:`w-14 h-14 rounded-full flex items-center justify-center ${g>0?"bg-green-500/20":"bg-red-500/20"}`,children:g>0?e.jsx(qe,{className:"w-7 h-7 text-green-400"}):e.jsx(Et,{className:"w-7 h-7 text-red-400"})})]})})]}),e.jsxs(c.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"bg-gray-800/50 border border-gray-700/50 rounded-2xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-purple-400"}),e.jsx("span",{className:"text-white font-medium",children:"Experience Gained"})]}),e.jsxs("span",{className:"text-purple-400 font-bold",children:["+",y?50:20," XP"]})]}),e.jsx("div",{className:"h-3 bg-gray-700 rounded-full overflow-hidden",children:e.jsx(c.div,{initial:{width:0},animate:{width:`${y?70:45}%`},transition:{delay:.7,duration:1,ease:"easeOut"},className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full"})}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"350/500 XP to Level Up"})]}),e.jsxs(c.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(c.button,{whileHover:d?{}:{scale:1.05,y:-2,boxShadow:"0 20px 40px rgba(239, 68, 68, 0.4)"},whileTap:d?{}:{scale:.98},onClick:I,disabled:$||d,className:`flex-1 flex items-center justify-center gap-3 py-4 px-6 text-white font-bold text-lg rounded-xl shadow-lg transition-all relative overflow-hidden group disabled:cursor-not-allowed ${d?"bg-gradient-to-r from-yellow-600 via-amber-600 to-orange-600 shadow-yellow-500/30":"bg-gradient-to-r from-red-500 via-orange-500 to-amber-500 shadow-red-500/30 hover:shadow-red-500/50"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-400/20 to-orange-400/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),$?e.jsx(ae,{className:"w-6 h-6 relative animate-spin"}):d?e.jsx(ae,{className:"w-6 h-6 relative animate-spin"}):e.jsx(te,{className:"w-6 h-6 relative"}),e.jsx("span",{className:"relative",children:$?"Sending...":d?`â³ Waiting for ${b?.odName?.split(" ")[0]||"Opponent"}...`:`ðŸ”¥ Rematch ${b?.odName?.split(" ")[0]||"Opponent"}`})]}),e.jsxs(c.button,{whileHover:{scale:1.05,y:-2,boxShadow:"0 20px 40px rgba(59, 130, 246, 0.4)"},whileTap:{scale:.98},onClick:()=>a("/dashboard/codearena/battle"),className:"flex-1 flex items-center justify-center gap-3 py-4 px-6 bg-gradient-to-r from-cyan-500 via-blue-500 to-indigo-600 text-white font-bold text-lg rounded-xl shadow-lg shadow-cyan-500/30 hover:shadow-cyan-500/50 transition-all relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-400/20 to-blue-400/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),e.jsx(ha,{className:"w-6 h-6 relative"}),e.jsx("span",{className:"relative",children:"âš”ï¸ New Battle"})]}),e.jsxs(c.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.98},onClick:()=>a("/dashboard/codearena"),className:"flex-1 flex items-center justify-center gap-3 py-4 px-6 bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-600 hover:to-gray-500 text-white font-bold text-lg rounded-xl border border-gray-600 hover:border-gray-500 shadow-lg transition-all relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-500/20 to-gray-400/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"}),e.jsx(qt,{className:"w-6 h-6 relative"}),e.jsx("span",{className:"relative",children:"ðŸ  Back to Arena"})]})]})]})]})};function gt(t,a){(a==null||a>t.length)&&(a=t.length);for(var s=0,r=Array(a);s<a;s++)r[s]=t[s];return r}function Ea(t){if(Array.isArray(t))return t}function Ta(t,a,s){return(a=Ma(a))in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function Ba(t,a){var s=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(s!=null){var r,n,m,p,h=[],y=!0,w=!1;try{if(m=(s=s.call(t)).next,a!==0)for(;!(y=(r=m.call(s)).done)&&(h.push(r.value),h.length!==a);y=!0);}catch(S){w=!0,n=S}finally{try{if(!y&&s.return!=null&&(p=s.return(),Object(p)!==p))return}finally{if(w)throw n}}return h}}function Ia(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ht(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function pt(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?ht(Object(s),!0).forEach(function(r){Ta(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ht(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function Da(t,a){if(t==null)return{};var s,r,n=Ra(t,a);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(t);for(r=0;r<m.length;r++)s=m[r],a.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Ra(t,a){if(t==null)return{};var s={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(a.indexOf(r)!==-1)continue;s[r]=t[r]}return s}function $a(t,a){return Ea(t)||Ba(t,a)||Oa(t,a)||Ia()}function La(t,a){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var r=s.call(t,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function Ma(t){var a=La(t,"string");return typeof a=="symbol"?a:a+""}function Oa(t,a){if(t){if(typeof t=="string")return gt(t,a);var s={}.toString.call(t).slice(8,-1);return s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set"?Array.from(t):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?gt(t,a):void 0}}function Pa(t,a,s){return a in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function ft(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),s.push.apply(s,r)}return s}function bt(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?ft(Object(s),!0).forEach(function(r){Pa(t,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ft(Object(s)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(s,r))})}return t}function _a(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return function(r){return a.reduceRight(function(n,m){return m(n)},r)}}function Re(t){return function a(){for(var s=this,r=arguments.length,n=new Array(r),m=0;m<r;m++)n[m]=arguments[m];return n.length>=t.length?t.apply(this,n):function(){for(var p=arguments.length,h=new Array(p),y=0;y<p;y++)h[y]=arguments[y];return a.apply(s,[].concat(n,h))}}}function Ve(t){return{}.toString.call(t).includes("Object")}function Fa(t){return!Object.keys(t).length}function Le(t){return typeof t=="function"}function Wa(t,a){return Object.prototype.hasOwnProperty.call(t,a)}function za(t,a){return Ve(a)||he("changeType"),Object.keys(a).some(function(s){return!Wa(t,s)})&&he("changeField"),a}function Ha(t){Le(t)||he("selectorType")}function Ua(t){Le(t)||Ve(t)||he("handlerType"),Ve(t)&&Object.values(t).some(function(a){return!Le(a)})&&he("handlersType")}function Va(t){t||he("initialIsRequired"),Ve(t)||he("initialType"),Fa(t)&&he("initialContent")}function Ya(t,a){throw new Error(t[a]||t.default)}var qa={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},he=Re(Ya)(qa),We={changes:za,selector:Ha,handler:Ua,initial:Va};function Ga(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};We.initial(t),We.handler(a);var s={current:t},r=Re(Ka)(s,a),n=Re(Qa)(s),m=Re(We.changes)(t),p=Re(Ja)(s);function h(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(S){return S};return We.selector(w),w(s.current)}function y(w){_a(r,n,m,p)(w)}return[h,y]}function Ja(t,a){return Le(a)?a(t.current):a}function Qa(t,a){return t.current=bt(bt({},t.current),a),a}function Ka(t,a,s){return Le(a)?a(t.current):Object.keys(s).forEach(function(r){var n;return(n=a[r])===null||n===void 0?void 0:n.call(a,t.current[r])}),s}var Xa={create:Ga},Za={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function es(t){return function a(){for(var s=this,r=arguments.length,n=new Array(r),m=0;m<r;m++)n[m]=arguments[m];return n.length>=t.length?t.apply(this,n):function(){for(var p=arguments.length,h=new Array(p),y=0;y<p;y++)h[y]=arguments[y];return a.apply(s,[].concat(n,h))}}}function ts(t){return{}.toString.call(t).includes("Object")}function as(t){return t||yt("configIsRequired"),ts(t)||yt("configType"),t.urls?(ss(),{paths:{vs:t.urls.monacoBase}}):t}function ss(){console.warn(It.deprecation)}function rs(t,a){throw new Error(t[a]||t.default)}var It={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},yt=es(rs)(It),ns={config:as},is=function(){for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return function(n){return s.reduceRight(function(m,p){return p(m)},n)}};function Dt(t,a){return Object.keys(a).forEach(function(s){a[s]instanceof Object&&t[s]&&Object.assign(a[s],Dt(t[s],a[s]))}),pt(pt({},t),a)}var ls={type:"cancelation",msg:"operation is manually canceled"};function Ke(t){var a=!1,s=new Promise(function(r,n){t.then(function(m){return a?n(ls):r(m)}),t.catch(n)});return s.cancel=function(){return a=!0},s}var os=["monaco"],cs=Xa.create({config:Za,isInitialized:!1,resolve:null,reject:null,monaco:null}),Rt=$a(cs,2),Pe=Rt[0],Je=Rt[1];function ds(t){var a=ns.config(t),s=a.monaco,r=Da(a,os);Je(function(n){return{config:Dt(n.config,r),monaco:s}})}function ms(){var t=Pe(function(a){var s=a.monaco,r=a.isInitialized,n=a.resolve;return{monaco:s,isInitialized:r,resolve:n}});if(!t.isInitialized){if(Je({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),Ke(Xe);if(window.monaco&&window.monaco.editor)return $t(window.monaco),t.resolve(window.monaco),Ke(Xe);is(us,gs)(hs)}return Ke(Xe)}function us(t){return document.body.appendChild(t)}function xs(t){var a=document.createElement("script");return t&&(a.src=t),a}function gs(t){var a=Pe(function(r){var n=r.config,m=r.reject;return{config:n,reject:m}}),s=xs("".concat(a.config.paths.vs,"/loader.js"));return s.onload=function(){return t()},s.onerror=a.reject,s}function hs(){var t=Pe(function(s){var r=s.config,n=s.resolve,m=s.reject;return{config:r,resolve:n,reject:m}}),a=window.require;a.config(t.config),a(["vs/editor/editor.main"],function(s){var r=s.m||s;$t(r),t.resolve(r)},function(s){t.reject(s)})}function $t(t){Pe().monaco||Je({monaco:t})}function ps(){return Pe(function(t){var a=t.monaco;return a})}var Xe=new Promise(function(t,a){return Je({resolve:t,reject:a})}),Lt={config:ds,init:ms,__getMonacoInstance:ps},fs={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Ze=fs,bs={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},ys=bs;function js({children:t}){return Se.createElement("div",{style:ys.container},t)}var ws=js,vs=ws;function Ns({width:t,height:a,isEditorReady:s,loading:r,_ref:n,className:m,wrapperProps:p}){return Se.createElement("section",{style:{...Ze.wrapper,width:t,height:a},...p},!s&&Se.createElement(vs,null,r),Se.createElement("div",{ref:n,style:{...Ze.fullWidth,...!s&&Ze.hide},className:m}))}var ks=Ns,Mt=i.memo(ks);function Ss(t){i.useEffect(t,[])}var Ot=Ss;function Cs(t,a,s=!0){let r=i.useRef(!0);i.useEffect(r.current||!s?()=>{r.current=!1}:t,a)}var se=Cs;function $e(){}function ke(t,a,s,r){return As(t,r)||Es(t,a,s,r)}function As(t,a){return t.editor.getModel(Pt(t,a))}function Es(t,a,s,r){return t.editor.createModel(a,s,r?Pt(t,r):void 0)}function Pt(t,a){return t.Uri.parse(a)}function Ts({original:t,modified:a,language:s,originalLanguage:r,modifiedLanguage:n,originalModelPath:m,modifiedModelPath:p,keepCurrentOriginalModel:h=!1,keepCurrentModifiedModel:y=!1,theme:w="light",loading:S="Loading...",options:A={},height:b="100%",width:B="100%",className:g,wrapperProps:j={},beforeMount:o=$e,onMount:C=$e}){let[k,P]=i.useState(!1),[$,L]=i.useState(!0),d=i.useRef(null),E=i.useRef(null),x=i.useRef(null),I=i.useRef(C),v=i.useRef(o),u=i.useRef(!1);Ot(()=>{let O=Lt.init();return O.then(D=>(E.current=D)&&L(!1)).catch(D=>D?.type!=="cancelation"&&console.error("Monaco initialization: error:",D)),()=>d.current?z():O.cancel()}),se(()=>{if(d.current&&E.current){let O=d.current.getOriginalEditor(),D=ke(E.current,t||"",r||s||"text",m||"");D!==O.getModel()&&O.setModel(D)}},[m],k),se(()=>{if(d.current&&E.current){let O=d.current.getModifiedEditor(),D=ke(E.current,a||"",n||s||"text",p||"");D!==O.getModel()&&O.setModel(D)}},[p],k),se(()=>{let O=d.current.getModifiedEditor();O.getOption(E.current.editor.EditorOption.readOnly)?O.setValue(a||""):a!==O.getValue()&&(O.executeEdits("",[{range:O.getModel().getFullModelRange(),text:a||"",forceMoveMarkers:!0}]),O.pushUndoStop())},[a],k),se(()=>{d.current?.getModel()?.original.setValue(t||"")},[t],k),se(()=>{let{original:O,modified:D}=d.current.getModel();E.current.editor.setModelLanguage(O,r||s||"text"),E.current.editor.setModelLanguage(D,n||s||"text")},[s,r,n],k),se(()=>{E.current?.editor.setTheme(w)},[w],k),se(()=>{d.current?.updateOptions(A)},[A],k);let T=i.useCallback(()=>{if(!E.current)return;v.current(E.current);let O=ke(E.current,t||"",r||s||"text",m||""),D=ke(E.current,a||"",n||s||"text",p||"");d.current?.setModel({original:O,modified:D})},[s,a,n,t,r,m,p]),_=i.useCallback(()=>{!u.current&&x.current&&(d.current=E.current.editor.createDiffEditor(x.current,{automaticLayout:!0,...A}),T(),E.current?.editor.setTheme(w),P(!0),u.current=!0)},[A,w,T]);i.useEffect(()=>{k&&I.current(d.current,E.current)},[k]),i.useEffect(()=>{!$&&!k&&_()},[$,k,_]);function z(){let O=d.current?.getModel();h||O?.original?.dispose(),y||O?.modified?.dispose(),d.current?.dispose()}return Se.createElement(Mt,{width:B,height:b,isEditorReady:k,loading:S,_ref:x,className:g,wrapperProps:j})}var Bs=Ts;i.memo(Bs);function Is(t){let a=i.useRef();return i.useEffect(()=>{a.current=t},[t]),a.current}var Ds=Is,ze=new Map;function Rs({defaultValue:t,defaultLanguage:a,defaultPath:s,value:r,language:n,path:m,theme:p="light",line:h,loading:y="Loading...",options:w={},overrideServices:S={},saveViewState:A=!0,keepCurrentModel:b=!1,width:B="100%",height:g="100%",className:j,wrapperProps:o={},beforeMount:C=$e,onMount:k=$e,onChange:P,onValidate:$=$e}){let[L,d]=i.useState(!1),[E,x]=i.useState(!0),I=i.useRef(null),v=i.useRef(null),u=i.useRef(null),T=i.useRef(k),_=i.useRef(C),z=i.useRef(),O=i.useRef(r),D=Ds(m),U=i.useRef(!1),q=i.useRef(!1);Ot(()=>{let H=Lt.init();return H.then(Y=>(I.current=Y)&&x(!1)).catch(Y=>Y?.type!=="cancelation"&&console.error("Monaco initialization: error:",Y)),()=>v.current?X():H.cancel()}),se(()=>{let H=ke(I.current,t||r||"",a||n||"",m||s||"");H!==v.current?.getModel()&&(A&&ze.set(D,v.current?.saveViewState()),v.current?.setModel(H),A&&v.current?.restoreViewState(ze.get(m)))},[m],L),se(()=>{v.current?.updateOptions(w)},[w],L),se(()=>{!v.current||r===void 0||(v.current.getOption(I.current.editor.EditorOption.readOnly)?v.current.setValue(r):r!==v.current.getValue()&&(q.current=!0,v.current.executeEdits("",[{range:v.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),v.current.pushUndoStop(),q.current=!1))},[r],L),se(()=>{let H=v.current?.getModel();H&&n&&I.current?.editor.setModelLanguage(H,n)},[n],L),se(()=>{h!==void 0&&v.current?.revealLine(h)},[h],L),se(()=>{I.current?.editor.setTheme(p)},[p],L);let V=i.useCallback(()=>{if(!(!u.current||!I.current)&&!U.current){_.current(I.current);let H=m||s,Y=ke(I.current,r||t||"",a||n||"",H||"");v.current=I.current?.editor.create(u.current,{model:Y,automaticLayout:!0,...w},S),A&&v.current.restoreViewState(ze.get(H)),I.current.editor.setTheme(p),h!==void 0&&v.current.revealLine(h),d(!0),U.current=!0}},[t,a,s,r,n,m,w,S,A,p,h]);i.useEffect(()=>{L&&T.current(v.current,I.current)},[L]),i.useEffect(()=>{!E&&!L&&V()},[E,L,V]),O.current=r,i.useEffect(()=>{L&&P&&(z.current?.dispose(),z.current=v.current?.onDidChangeModelContent(H=>{q.current||P(v.current.getValue(),H)}))},[L,P]),i.useEffect(()=>{if(L){let H=I.current.editor.onDidChangeMarkers(Y=>{let l=v.current.getModel()?.uri;if(l&&Y.find(f=>f.path===l.path)){let f=I.current.editor.getModelMarkers({resource:l});$?.(f)}});return()=>{H?.dispose()}}return()=>{}},[L,$]);function X(){z.current?.dispose(),b?A&&ze.set(m,v.current.saveViewState()):v.current.getModel()?.dispose(),v.current.dispose()}return Se.createElement(Mt,{width:B,height:g,isEditorReady:L,loading:y,_ref:u,className:j,wrapperProps:o})}var $s=Rs,Ls=i.memo($s),dt=Ls;const Be={MAX_CODE_LENGTH:5e4,MIN_CODE_LENGTH:10,ALLOWED_LANGUAGES:["python","javascript","cpp","java","c","go","rust"],BLOCKED_PATTERNS:[/import\s+os/gi,/import\s+subprocess/gi,/import\s+sys/gi,/exec\s*\(/gi,/eval\s*\(/gi,/system\s*\(/gi,/__import__/gi,/open\s*\(/gi,/file\s*\(/gi,/socket/gi,/urllib/gi,/requests/gi,/http/gi,/net/gi,/process/gi,/runtime/gi],SUSPICIOUS_KEYWORDS:["rm -rf","del /s","format c:","sudo","chmod 777","while(true)","for(;;)","while True:","infinite","fork()","thread","async","await"]};class Me extends Error{code;constructor(a,s){super(a),this.name="SecurityError",this.code=s}}class xe extends Error{field;constructor(a,s){super(a),this.name="ValidationError",this.field=s}}const Ms=t=>t.replace(/<[^>]*>/g,"").replace(/&[^;]+;/g,"").replace(/javascript:/gi,"").replace(/data:/gi,"").trim(),et=t=>{const{code:a,language:s,challengeId:r,battleId:n}=t;if(!Be.ALLOWED_LANGUAGES.includes(s))throw new xe(`Unsupported programming language: ${s}`,"language");if(!a||a.length<Be.MIN_CODE_LENGTH)throw new xe("Code is too short","code");if(a.length>Be.MAX_CODE_LENGTH)throw new xe("Code exceeds maximum length (50KB)","code");for(const h of Be.BLOCKED_PATTERNS)if(h.test(a))throw new Me("Code contains prohibited functions or imports","BLOCKED_CODE");const m=a.toLowerCase();for(const h of Be.SUSPICIOUS_KEYWORDS)if(m.includes(h.toLowerCase()))throw new Me(`Code contains suspicious keyword: ${h}`,"SUSPICIOUS_CODE");const p=Ms(a);if(r&&!/^[a-zA-Z0-9_-]+$/.test(r))throw new xe("Invalid challenge ID format","challengeId");if(n&&!/^[a-zA-Z0-9_-]+$/.test(n))throw new xe("Invalid battle ID format","battleId");return{code:p,language:s,challengeId:r,battleId:n}},Os=async t=>{try{return(await F(`/challenges/${t}`)).challenge||null}catch(a){return console.error("Error fetching challenge:",a),null}},_t=Os,jt=async t=>{try{return(await F(`/challenges/${t}/testcases`)).testCases||[]}catch(a){return console.error("Error fetching test cases:",a),[]}},Ps=async t=>{try{return(await F(`/challenges/${t}/validation-testcases`)).testCases||[]}catch(a){return console.error("Error fetching validation test cases:",a),[]}},tt=[],_s="https://emkc.org/api/v2/piston",Ft={javascript:{language:"javascript",version:"18.15.0"},python:{language:"python",version:"3.10.0"},python3:{language:"python",version:"3.10.0"},java:{language:"java",version:"15.0.2"},cpp:{language:"c++",version:"10.2.0"},c:{language:"c",version:"10.2.0"},typescript:{language:"typescript",version:"5.0.3"},go:{language:"go",version:"1.16.2"},rust:{language:"rust",version:"1.68.2"},ruby:{language:"ruby",version:"3.0.1"},kotlin:{language:"kotlin",version:"1.8.20"},csharp:{language:"csharp",version:"6.12.0"},swift:{language:"swift",version:"5.3.3"}};async function Fs(t,a,s=""){const r=Date.now();try{const n=Ft[a.toLowerCase()];if(!n)throw new Error(`Unsupported language: ${a}`);const m=await fetch(`${_s}/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({language:n.language,version:n.version,files:[{name:Ws(a),content:t}],stdin:s,args:[],compile_timeout:1e4,run_timeout:3e3,compile_memory_limit:-1,run_memory_limit:-1})});if(!m.ok)throw new Error(`API request failed with status ${m.status}`);const p=await m.json(),h=Date.now()-r;return p.compile&&p.compile.code!==0?{success:!1,error:p.compile.stderr||p.compile.output||"Compilation failed",executionTime:h}:p.run.code!==0&&p.run.signal?{success:!1,error:p.run.stderr||p.run.output||"Runtime error",executionTime:h}:{success:!0,output:(p.run.stdout||p.run.output||"").trim(),error:p.run.stderr?p.run.stderr.trim():void 0,executionTime:h}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error occurred",executionTime:Date.now()-r}}}function Ws(t){switch(t.toLowerCase()){case"javascript":return"solution.js";case"python":case"python3":return"solution.py";case"java":return"Main.java";case"cpp":case"c":return"solution.cpp";case"typescript":return"solution.ts";case"go":return"solution.go";case"rust":return"solution.rs";case"ruby":return"solution.rb";case"kotlin":return"solution.kt";case"csharp":return"Solution.cs";case"swift":return"solution.swift";default:return"solution.txt"}}async function zs(t,a,s=""){const r=await Fs(t,a,s);return{output:r.output||"",error:r.error||null,time:r.executionTime?`${(r.executionTime/1e3).toFixed(3)}`:null,memory:null,status:r.success?"Accepted":r.error?"Error":"Unknown"}}const Wt=()=>Object.keys(Ft).filter(t=>t!=="python3").map(t=>({id:t,name:t.charAt(0).toUpperCase()+t.slice(1),languageId:t})),Hs=()=>{const{battleId:t}=Ye(),a=pe(),{user:s}=fe();be();const{setBattleActive:r}=Gt(),[n,m]=i.useState(null),[p,h]=i.useState(!0),[y,w]=i.useState(5),[S,A]=i.useState(0),[b,B]=i.useState(null),[g,j]=i.useState([]),[o,C]=i.useState(""),[k,P]=i.useState("python"),[$,L]=i.useState(!1),[d,E]=i.useState(!1),[x,I]=i.useState(!1);i.useEffect(()=>(n?.status==="active"&&!x?r(!0):r(!1),()=>r(!1)),[n?.status,x,r]);const[v,u]=i.useState(null),[T,_]=i.useState(!1),[z,O]=i.useState(!1),[D,U]=i.useState(!1),[q,V]=i.useState(0),X=i.useRef(null),H=i.useRef(o),Y=i.useRef(g),l=i.useRef(!1),f=i.useRef(null),W=Wt();i.useEffect(()=>{if(n?.status!=="active"||x)return;const N=R=>(R.preventDefault(),R.returnValue="You are in an active battle! Leaving will cause you to lose. Are you sure?",R.returnValue);return window.addEventListener("beforeunload",N),()=>window.removeEventListener("beforeunload",N)},[n?.status,x]);const J=i.useCallback(N=>{try{f.current||(f.current=new(window.AudioContext||window.webkitAudioContext));const R=f.current,M=R.currentTime;if(N===0){[523.25,659.25,783.99,1046.5].forEach((je,me)=>{const Ee=R.createOscillator(),Ne=R.createGain();Ee.connect(Ne),Ne.connect(R.destination),Ee.type="square",Ee.frequency.setValueAtTime(je,M+me*.05),Ne.gain.setValueAtTime(0,M),Ne.gain.linearRampToValueAtTime(.15,M+me*.05),Ne.gain.linearRampToValueAtTime(.15,M+me*.05+.15),Ne.gain.exponentialRampToValueAtTime(.001,M+.5),Ee.start(M+me*.05),Ee.stop(M+.6)});const G=R.createOscillator(),K=R.createGain();G.connect(K),K.connect(R.destination),G.type="sawtooth",G.frequency.setValueAtTime(130.81,M),G.frequency.exponentialRampToValueAtTime(65.41,M+.2),K.gain.setValueAtTime(.25,M),K.gain.exponentialRampToValueAtTime(.001,M+.3),G.start(M),G.stop(M+.4)}else{const Z=N===5?262:N===4?294:N===3?330:N===2?440:587,G=R.createOscillator(),K=R.createGain();G.connect(K),K.connect(R.destination),G.type="square",G.frequency.setValueAtTime(Z*2,M),G.frequency.exponentialRampToValueAtTime(Z,M+.08),K.gain.setValueAtTime(.2,M),K.gain.exponentialRampToValueAtTime(.001,M+.12),G.start(M),G.stop(M+.15);const je=R.createOscillator(),me=R.createGain();je.connect(me),me.connect(R.destination),je.type="sine",je.frequency.setValueAtTime(Z/2,M),me.gain.setValueAtTime(.15,M),me.gain.exponentialRampToValueAtTime(.001,M+.1),je.start(M),je.stop(M+.12)}}catch{console.log("Audio not supported")}},[]);i.useEffect(()=>{H.current=o},[o]),i.useEffect(()=>{Y.current=g},[g]);const _e={python:`# Battle Mode - Write your solution fast!
def solve():
    n = int(input())
    # Your code here
    print(result)

solve()`,cpp:`#include <bits/stdc++.h>
using namespace std;

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    int n;
    cin >> n;
    // Your code here
    cout << result << endl;
    return 0;
}`,java:`import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        int n = sc.nextInt();
        // Your code here
        System.out.println(result);
    }
}`,javascript:`const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

let lines = [];
rl.on('line', (line) => lines.push(line));
rl.on('close', () => {
    const n = parseInt(lines[0]);
    // Your code here
    console.log(result);
});`},ce=i.useCallback(()=>`battle_code_${t}`,[t]),de=i.useCallback(()=>`battle_language_${t}`,[t]);i.useEffect(()=>{if(!t)return;const N=localStorage.getItem(ce()),R=localStorage.getItem(de());N&&(console.log("Restoring code from localStorage"),C(N)),R&&["python","cpp","java","javascript"].includes(R)&&P(R)},[t,ce,de]),i.useEffect(()=>{if(!t||x)return;const N=setInterval(()=>{localStorage.setItem(ce(),o),localStorage.setItem(de(),k)},2e3);return()=>clearInterval(N)},[t,o,k,x,ce,de]),i.useEffect(()=>{x&&t&&(localStorage.removeItem(ce()),localStorage.removeItem(de()))},[x,t,ce,de]),i.useEffect(()=>{if(!t||!s||n?.status!=="active"||x)return;const N=()=>{document.hidden&&(V(M=>M+1),U(!0))},R=()=>{n?.status==="active"&&!x&&(V(M=>M+1),U(!0))};return document.addEventListener("visibilitychange",N),window.addEventListener("blur",R),()=>{document.removeEventListener("visibilitychange",N),window.removeEventListener("blur",R)}},[t,s,n?.status,x]),i.useEffect(()=>{q>=3&&n?.status==="active"&&!x&&(async()=>{try{await F(`/battles/${t}/forfeit`,{method:"POST"}),a(`/dashboard/codearena/battle/results/${t}`)}catch(R){console.error("Error forfeiting battle:",R)}})()},[q,n?.status,x,t,a]),i.useEffect(()=>{if(!t||!s)return;const N=async()=>{try{const M=await F(`/battles/${t}`);if(!M){a("/dashboard/codearena");return}if(m(M),M.challenge&&!b&&M.challenge.description&&(Array.isArray(M.challenge.testCases)||Array.isArray(M.challenge.test_cases))){B(M.challenge);const G=M.challenge.testCases&&M.challenge.testCases.length>0?M.challenge.testCases.map(K=>({input:K.input,output:K.expectedOutput||K.output||K.expected_output||""})):(M.challenge.test_cases||[]).map(K=>({input:K.input,output:K.expected_output||K.output||""}));j(G)}const Z=M.participants.find(G=>G.odId===s?.id);Z?.hasSubmitted&&!x&&(I(!0),Z.submissionResult&&u({success:Z.submissionResult.passed,passed:Z.submissionResult.passed,status:Z.submissionResult.passed?"Accepted":"Wrong Answer",passedCount:Z.submissionResult.passedCount,totalCount:Z.submissionResult.totalCount,totalTime:Z.submissionResult.totalTime,executionTime:Z.submissionResult.totalTime})),M.forfeitedBy&&M.forfeitedBy!==s?.id&&O(!0),(M.status==="completed"||M.status==="forfeited")&&a(`/dashboard/codearena/battle/results/${t}`),h(!1)}catch(M){console.error("Failed to fetch battle data",M),a("/dashboard/codearena")}};N();const R=setInterval(N,3e3);return()=>clearInterval(R)},[t,s,x,b]),i.useEffect(()=>{const N=async R=>{if(n?.status==="active"&&!x&&!l.current)return t&&(localStorage.setItem(ce(),H.current),localStorage.setItem(de(),k),localStorage.setItem(`battle_autosubmit_${t}`,"true")),R.preventDefault(),R.returnValue="Your code will be auto-submitted when you return. Continue?",R.returnValue};return window.addEventListener("beforeunload",N),()=>{window.removeEventListener("beforeunload",N)}},[n?.status,t,x,k,ce,de]),i.useEffect(()=>{if(!t||!s||!n||x||l.current)return;if(localStorage.getItem(`battle_autosubmit_${t}`)==="true"&&n.status==="active"&&Y.current.length>0){console.log("Auto-submitting code after page refresh..."),localStorage.removeItem(`battle_autosubmit_${t}`);const R=setTimeout(()=>{!x&&!l.current&&Qe()},1e3);return()=>clearTimeout(R)}},[t,s,n?.status,x,g.length]),i.useEffect(()=>{if(n?.status==="countdown"){if(y>0){J(y);const N=setTimeout(()=>w(y-1),1200);return()=>clearTimeout(N)}else if(y===0){J(0);const N=setTimeout(async()=>{t&&await F(`/battles/${t}/start`,{method:"POST"})},1500);return()=>clearTimeout(N)}}},[n?.status,y,t,J]),i.useEffect(()=>{n?.status==="countdown"&&w(3)},[n?.status]),i.useEffect(()=>{if(n?.status==="active"&&n.startTime){const N=new Date(n.startTime).getTime(),R=n.timeLimit*1e3;return X.current=setInterval(()=>{const Z=Date.now()-N,G=Math.max(0,R-Z);A(Math.ceil(G/1e3)),G<=0&&(X.current&&clearInterval(X.current),zt())},1e3),()=>{X.current&&clearInterval(X.current)}}},[n?.status,n?.startTime,n?.timeLimit]),i.useEffect(()=>{C(_e[k]||_e.python)},[k]);const zt=async()=>{!x&&n&&await Qe()},Ht=async()=>{if(!(!s||!n||!t||T||!window.confirm("âš ï¸ Are you sure you want to leave?\\n\\nLeaving will forfeit the match and your opponent will win the prize!"))){_(!0);try{await F(`/battles/${t}/forfeit`,{method:"POST"}),a("/dashboard/codearena")}catch(R){console.error("Error forfeiting battle:",R),alert("Failed to leave battle. Please try again."),_(!1)}}},Qe=async()=>{if(!(!s||!n||d||x||!t||l.current)){if(!g||g.length===0){u({success:!1,passed:!1,status:"Error",error:"No test cases available. Please try again.",passedCount:0,totalCount:0,totalTime:0,executionTime:0});return}l.current=!0,E(!0),localStorage.removeItem(`battle_autosubmit_${t}`);try{const N=await F(`/battles/${t}/submit`,{method:"POST",body:JSON.stringify({code:o,language:k})});u({success:N.passed,passed:N.passed,status:N.passed?"Accepted":"Wrong Answer",passedCount:N.passedCount,totalCount:N.totalCount,totalTime:N.totalTime,executionTime:N.totalTime}),I(!0)}catch(N){console.error("Battle submission error:",N);let R="Submission failed. Please try again.";N instanceof Me?R=`Security Error: ${N.message}`:N instanceof xe?R=`Validation Error: ${N.message}`:N instanceof Error&&(N.message.includes("API request failed")?R="âš ï¸ Code execution service temporarily unavailable. Please try again.":N.message.includes("429")||N.message.includes("Too Many Requests")?R="â³ Too many submissions. Please wait a moment and try again.":R=N.message),u({success:!1,passed:!1,status:"Error",error:R,passedCount:0,totalCount:g.length,totalTime:0,executionTime:0})}E(!1),l.current=!1,t&&(localStorage.removeItem(ce()),localStorage.removeItem(de()))}},Ut=N=>{const R=Math.floor(N/60),M=N%60;return`${R.toString().padStart(2,"0")}:${M.toString().padStart(2,"0")}`},Vt=()=>n?.participants.find(N=>N.odId!==s?.id),Yt=()=>n?.participants.find(N=>N.odId===s?.id);if(console.log("Battle status:",n?.status,"Countdown:",y,"Loading:",p),p)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"w-16 h-16 text-cyan-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"Loading battle..."})]})});if(n?.status==="countdown"&&y>=0)return console.log("Showing countdown overlay!",y),e.jsxs("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(20)].map((N,R)=>e.jsx(c.div,{className:"absolute w-2 h-2 bg-cyan-400/30 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-200],scale:[0,1,0],opacity:[0,1,0]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:R*.1}},R))}),e.jsx(c.div,{className:"absolute inset-0 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},children:[1,2,3].map(N=>e.jsx(c.div,{className:"absolute border-2 border-cyan-500/20 rounded-full",style:{width:N*200,height:N*200},animate:{scale:[1,1.5,1],opacity:[.3,.1,.3]},transition:{duration:2,repeat:1/0,delay:N*.3}},N))}),e.jsx(c.div,{className:"absolute inset-0 bg-gradient-to-br from-cyan-500/10 via-purple-500/10 to-[#00d4ff]/10",animate:{scale:[1,1.2,1],opacity:[.3,.6,.3],rotate:[0,5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),e.jsx(oe,{mode:"wait",children:e.jsxs(c.div,{initial:{scale:.3,opacity:0,rotateY:-180},animate:{scale:1,opacity:1,rotateY:0},exit:{scale:2,opacity:0,rotateY:180},transition:{type:"spring",stiffness:300,damping:20},className:"text-center z-10",children:[e.jsx(c.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},className:"mb-6",children:e.jsx(c.div,{animate:{textShadow:["0 0 20px rgba(0, 173, 181, 0.5)","0 0 40px rgba(0, 173, 181, 0.8)","0 0 20px rgba(0, 173, 181, 0.5)"]},transition:{duration:1.5,repeat:1/0},className:"text-2xl font-bold text-cyan-400 tracking-widest",children:"âš”ï¸ BATTLE ARENA âš”ï¸"})}),e.jsxs("div",{className:"flex items-center justify-center gap-8 mb-8",children:[e.jsxs(c.div,{className:"text-center",initial:{x:-100,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},children:[e.jsx(c.div,{className:"w-20 h-20 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center mb-2 shadow-lg shadow-cyan-500/50",animate:{boxShadow:["0 0 20px rgba(0, 173, 181, 0.5)","0 0 40px rgba(0, 173, 181, 0.8)","0 0 20px rgba(0, 173, 181, 0.5)"]},transition:{duration:1.5,repeat:1/0},children:e.jsx("span",{className:"text-white font-bold text-2xl",children:n.participants[0]?.odName?.charAt(0)||""})}),e.jsx("p",{className:"text-cyan-400 font-semibold",children:n.participants[0]?.odName}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["Rating: ",n.participants[0]?.rating||1e3]})]}),e.jsx(c.div,{className:"text-cyan-400 text-5xl font-black",animate:{scale:[1,1.2,1],rotate:[0,5,-5,0],textShadow:["0 0 30px rgba(255, 0, 0, 0.5)","0 0 60px rgba(255, 0, 0, 0.8)","0 0 30px rgba(255, 0, 0, 0.5)"]},transition:{duration:1,repeat:1/0},style:{background:"linear-gradient(to right, #00ADB5, #ff4444, #00ADB5)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"VS"}),e.jsxs(c.div,{className:"text-center",initial:{x:100,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2},children:[e.jsx(c.div,{className:"w-20 h-20 rounded-full bg-gradient-to-br from-red-400 to-orange-500 flex items-center justify-center mb-2 shadow-lg shadow-red-500/50",animate:{boxShadow:["0 0 20px rgba(239, 68, 68, 0.5)","0 0 40px rgba(239, 68, 68, 0.8)","0 0 20px rgba(239, 68, 68, 0.5)"]},transition:{duration:1.5,repeat:1/0},children:e.jsx("span",{className:"text-white font-bold text-2xl",children:n.participants[1]?.odName?.charAt(0)||""})}),e.jsx("p",{className:"text-red-400 font-semibold",children:n.participants[1]?.odName}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["Rating: ",n.participants[1]?.rating||1e3]})]})]}),e.jsx(c.p,{className:"text-gray-400 text-xl mb-6",animate:{opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0},children:y>0?"Battle starts in":""}),e.jsx(c.div,{animate:{scale:y===0?[1,1.5,1.2]:[1,1.2,1],color:y===0?"#22c55e":y===1?"#ef4444":y===2?"#f59e0b":"#06b6d4"},transition:{duration:.5,ease:"easeOut"},className:"text-9xl font-black mb-6",style:{textShadow:"0 0 50px currentColor, 0 0 100px currentColor",filter:"drop-shadow(0 0 30px currentColor)"},children:y===0?"âš”ï¸ FIGHT! âš”ï¸":y}),e.jsx(c.p,{animate:{opacity:[.5,1,.5],y:[0,-5,0]},transition:{duration:1,repeat:1/0},className:"text-gray-400 text-lg",children:y===0?"ðŸ”¥ Show your coding skills! ðŸ”¥":"âš¡ Get ready to code!"}),e.jsxs(c.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"mt-8 flex items-center justify-center gap-2 text-yellow-400",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-bold",children:["Prize: ",n.prize," coins"]})]})]},y)})]});const ye=Vt(),Fe=Yt();return e.jsxs("div",{className:"h-screen bg-gray-900 flex flex-col overflow-hidden -mx-4 -mt-6",children:[e.jsxs("header",{className:"bg-gray-800 border-b border-gray-700 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Fe?.odProfilePic||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s?.id}`,alt:"You",className:"w-10 h-10 rounded-full border-2 border-cyan-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:Fe?.odName||"You"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Rating: ",Fe?.rating||1e3]})]}),Fe?.hasSubmitted&&e.jsx(re,{className:"w-5 h-5 text-green-400"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-3xl font-bold ${S<=60?"text-red-400 animate-pulse":"text-white"}`,children:Ut(S)}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:n?.challenge?.title||"Loading challenge..."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[ye?.hasSubmitted&&e.jsx(re,{className:"w-5 h-5 text-green-400"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-white font-medium",children:ye?.odName||"Opponent"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Rating: ",ye?.rating||1e3]})]}),e.jsx("img",{src:ye?.odProfilePic||`https://api.dicebear.com/7.x/avataaars/svg?seed=${ye?.odId}`,alt:"Opponent",className:"w-10 h-10 rounded-full border-2 border-red-400"})]})]}),e.jsxs("div",{className:"flex justify-center mt-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-1 bg-yellow-500/20 border border-yellow-500/30 rounded-full",children:[e.jsx(Q,{className:"w-4 h-4 text-yellow-400"}),e.jsxs("span",{className:"text-yellow-400 font-bold",children:[n?.prize||0," coins"]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 text-green-400 bg-green-500/10 rounded-full border border-green-500/20",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Secure Battle"})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-3 bg-gray-800/50 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-cyan-400"}),b?.title||"Loading Challenge..."]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-700 text-gray-300 rounded",children:n?.difficulty})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsx("div",{className:"bg-gray-800/80 rounded-xl shadow-lg border border-cyan-900/30 p-5 mb-4 max-h-96 overflow-y-auto custom-scrollbar",children:e.jsx("div",{className:"prose prose-invert prose-base max-w-none problem-statement-prose",dangerouslySetInnerHTML:{__html:b?.problemStatement||b?.description||'<p class="text-white-400">Loading challenge...</p>'}})}),g.length>0&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("h4",{className:"text-white font-medium",children:"Sample Cases"}),g.slice(0,2).map((N,R)=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 text-sm",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Input:"}),e.jsx("pre",{className:"text-cyan-400 font-mono mt-1",children:N.input})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-xs",children:"Output:"}),e.jsx("pre",{className:"text-green-400 font-mono mt-1",children:N.output})]})]},R))]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col border-b border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-2 bg-gray-800/50 border-b border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-white font-medium text-sm",children:"Your Code"}),x&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-400",children:[e.jsx(re,{className:"w-3 h-3"}),"Submitted"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>L(!$),disabled:x,className:"flex items-center gap-2 px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm disabled:opacity-50",children:[e.jsx("span",{className:"text-white capitalize",children:k}),e.jsx(ot,{className:"w-3 h-3 text-gray-400"})]}),e.jsx(oe,{children:$&&e.jsx(c.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},className:"absolute right-0 top-full mt-1 w-36 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 overflow-hidden",children:W.filter(N=>["python","cpp","java","javascript"].includes(N.id)).map(N=>e.jsx("button",{onClick:()=>{P(N.id),L(!1)},className:`w-full px-3 py-2 text-left text-sm hover:bg-gray-700 ${k===N.id?"text-cyan-400":"text-white"}`,children:N.name},N.id))})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(dt,{height:"100%",language:k==="cpp"?"cpp":k,value:o,onChange:N=>!x&&C(N||""),theme:"vs-dark",options:{fontSize:13,fontFamily:"JetBrains Mono, Fira Code, Consolas, monospace",minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",automaticLayout:!0,tabSize:4,readOnly:x,padding:{top:8}}})})]}),e.jsx("div",{className:"h-32 bg-gray-800/50 p-4 overflow-y-auto",children:v?e.jsxs("div",{className:`p-3 rounded-lg ${v.passed?"bg-green-900/20 border border-green-500/30":"bg-red-900/20 border border-red-500/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[v.passed?e.jsx(re,{className:"w-5 h-5 text-green-400"}):e.jsx(ve,{className:"w-5 h-5 text-red-400"}),e.jsx("span",{className:`font-medium ${v.passed?"text-green-400":"text-red-400"}`,children:v.passed?"All Tests Passed!":"Some Tests Failed"})]}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[v.passedCount," / ",v.totalCount," test cases â€¢ Time: ",(v.totalTime||0).toFixed(0),"ms"]}),ye?.hasSubmitted?e.jsx("p",{className:"text-sm text-cyan-400 mt-2",children:"Waiting for results..."}):e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Waiting for opponent to submit..."})]}):e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("p",{className:"text-sm",children:"Submit your code to see results"}),ye?.hasSubmitted&&e.jsx("p",{className:"text-xs text-yellow-400 mt-2",children:"âš ï¸ Opponent has already submitted!"})]})})]})]}),e.jsx(oe,{children:z&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50",children:e.jsxs(c.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-gray-800 rounded-2xl p-8 max-w-md w-full mx-4 text-center border border-green-500/30",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-green-500/20 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-10 h-10 text-green-400"})}),e.jsx("h3",{className:"text-2xl font-bold text-green-400 mb-2",children:"ðŸŽ‰ You Win!"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Your opponent left the battle."}),e.jsxs("p",{className:"text-yellow-400 font-bold text-xl mb-6",children:["+",n?.prize," coins awarded!"]}),e.jsx("button",{onClick:()=>a("/dashboard/codearena"),className:"w-full py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all",children:"Back to Arena"})]})})}),e.jsxs("div",{className:"bg-gray-800 border-t border-gray-700 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(c.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:Ht,disabled:T||n?.status==="completed",className:"flex items-center gap-2 px-4 py-2 bg-red-500/20 border border-red-500/30 text-red-400 rounded-lg hover:bg-red-500/30 transition-all disabled:opacity-50",children:[T?e.jsx(ae,{className:"w-4 h-4 animate-spin"}):e.jsx(ca,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:T?"Leaving...":"Leave Battle"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsxs("span",{children:["Time Limit: ",n?.timeLimit?Math.floor(n.timeLimit/60):15," min"]})]})]}),e.jsx(c.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:Qe,disabled:d||x,className:`flex items-center gap-2 px-6 py-2.5 rounded-lg font-medium transition-all ${x?"bg-green-600 text-white cursor-not-allowed":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white"} disabled:opacity-70`,children:d?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-4 h-4 animate-spin"}),"Submitting..."]}):x?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4"}),"Submitted"]}):e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"w-4 h-4"}),"Submit Solution"]})})]}),e.jsx("style",{children:`
        .problem-statement-prose, .problem-statement-prose *, .problem-statement-prose h1, .problem-statement-prose h2, .problem-statement-prose h3 {
          color: #fff !important;
        }
        .problem-statement-prose h1, .problem-statement-prose h2, .problem-statement-prose h3 {
          margin-top: 1.2em;
          margin-bottom: 0.5em;
        }
        .problem-statement-prose ul, .problem-statement-prose ol {
          margin-left: 1.5em;
          margin-bottom: 1em;
        }
        .problem-statement-prose pre, .problem-statement-prose code {
          background: #1e293b;
          color: #facc15;
          border-radius: 0.3em;
          padding: 0.3em 0.6em;
          font-size: 1em;
        }
        .problem-statement-prose p {
          margin: 0.7em 0;
          line-height: 1.7;
        }
        .problem-statement-prose table {
          background: #0f172a;
          border-radius: 0.3em;
        }
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #334155;
          border-radius: 4px;
        }
      `}),e.jsx(oe,{children:D&&e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx(c.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-gray-800 border-2 border-red-500 rounded-2xl p-6 max-w-md w-full shadow-2xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-500/20 rounded-full flex items-center justify-center",children:e.jsx(Ue,{className:"w-8 h-8 text-red-500"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"âš ï¸ Warning!"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"You switched away from the battle! This is not allowed during an active battle."}),e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-3 mb-4",children:[e.jsxs("p",{className:"text-red-400 font-semibold",children:["Tab switches: ",q,"/3"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:q>=3?"You have been disqualified!":`${3-q} more switch(es) and you will automatically lose!`})]}),e.jsx("button",{onClick:()=>U(!1),className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white font-bold rounded-xl hover:shadow-lg transition-all",children:"I Understand, Continue Battle"})]})})})})]})};class Us{BACKEND_URL="https://nextstepbackend-qhxw.onrender.com";async executeCode(a,s,r){const n=localStorage.getItem("authToken");if(!n)throw new Error("Authentication required");const m=et({code:a,language:s});try{const p=await fetch(`${this.BACKEND_URL}/api/execute`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({source_code:m.code,language_id:this.getLanguageId(s),stdin:r||""})});if(!p.ok)throw new Error(`Execution failed: ${p.statusText}`);return await p.json()}catch(p){throw console.error("Code execution error:",p),new Error("Failed to execute code. Please try again.")}}async submitChallenge(a,s,r,n,m,p,h){if(!localStorage.getItem("authToken"))throw new Error("Authentication required");const w=et({code:s,language:r,challengeId:a});try{const S=await F(`/challenges/${a}/submit`,{method:"POST",body:JSON.stringify({code:w.code,language:r,testCases:n,coinReward:m,title:p,difficulty:h})});return{success:S.success||!1,passed:S.passed||S.passedCount||0,total:S.total||S.totalCount||0,passedCount:S.passedCount||S.passed||0,totalCount:S.totalCount||S.total||0,message:S.message||(S.success?"All test cases passed!":"Some test cases failed"),coinsChanged:S.coinsChanged||0,testResults:S.testResults}}catch(S){throw console.error("Challenge submission error:",S),new Error("Failed to submit solution. Please try again.")}}async submitBattleSolution(a,s,r){if(!localStorage.getItem("authToken"))throw new Error("Authentication required");const m=et({code:s,language:r,battleId:a});try{return await F(`/battles/${a}/submit`,{method:"POST",body:JSON.stringify({code:m.code,language:r})})}catch(p){throw console.error("Battle submission error:",p),new Error("Failed to submit battle solution. Please try again.")}}getLanguageId(a){return{javascript:63,python:71,java:62,cpp:54,c:50,csharp:51,ruby:72,go:60,rust:73,php:68,swift:83,kotlin:78}[a.toLowerCase()]||63}async verifyBattleEntry(a,s){try{return(await F(`/battles/verify-entry?userId=${a}&fee=${s}`)).canEnter||!1}catch(r){return console.error("Battle entry verification error:",r),!1}}}const rt=new Us,Vs=[{id:"python",name:"Python"},{id:"cpp",name:"C++"},{id:"java",name:"Java"},{id:"javascript",name:"JavaScript"}],Ys=()=>{const{challengeId:t}=Ye(),a=pe(),s=lt(),{user:r}=fe();be();const[n,m]=i.useState(null),[p,h]=i.useState([]),[y,w]=i.useState(!0),[S,A]=i.useState(""),[b,B]=i.useState("python"),[g,j]=i.useState(!1),[o,C]=i.useState(!1),[k,P]=i.useState(!1),[$,L]=i.useState(null),[d,E]=i.useState(null),[x,I]=i.useState(""),[v,u]=i.useState(!1),[T,_]=i.useState("description"),[z,O]=i.useState(!1),[D,U]=i.useState(!1),q=Vs,V={python:`# Write your solution here
def solve():
    # Read input
    n = int(input())
    
    # Your code here
    result = n
    
    # Print output
    print(result)

solve()`,cpp:`#include <bits/stdc++.h>
using namespace std;

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    
    // Read input
    int n;
    cin >> n;
    
    // Your code here
    int result = n;
    
    // Print output
    cout << result << endl;
    
    return 0;
}`,java:`import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        
        // Read input
        int n = sc.nextInt();
        
        // Your code here
        int result = n;
        
        // Print output
        System.out.println(result);
    }
}`,javascript:`// Read input from stdin
const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

let lines = [];
rl.on('line', (line) => {
    lines.push(line);
});

rl.on('close', () => {
    // Parse input
    const n = parseInt(lines[0]);
    
    // Your code here
    const result = n;
    
    // Print output
    console.log(result);
});`};i.useEffect(()=>{(async()=>{if(t){w(!0);try{const f=s.state?.challenge;if(f)m(f),f.testCases&&h(Array.isArray(f.testCases)?f.testCases:[]);else{const W=await _t(t);if(W){m(W);const J=await jt(t);h(J)}else m(null)}w(!1)}catch(f){console.error("Error loading challenge:",f),m(null),w(!1)}}})()},[t,s]),i.useEffect(()=>{A(V[b]||V.python)},[b]);const X=async()=>{C(!0),E(null),L(null);try{const l=v?x:p[0]?.input||"",f=await rt.executeCode(S,b,l);E(f)}catch(l){let f="Failed to run code. Please try again.";l instanceof Me?f=`Security Error: ${l.message}`:l instanceof xe?f=`Validation Error: ${l.message}`:l instanceof Error&&(f=l.message),E({output:"",stderr:f,time:"0",memory:"0",status:"Error"})}C(!1)},H=async()=>{if(!t){alert("Invalid challenge ID");return}if(p.length===0){alert("No test cases available for this problem. Please try again or use the Run button with custom input.");return}P(!0),L(null),E(null);try{const l=await rt.submitChallenge(t,S,b,p.map(f=>({input:f.input,expected_output:f.expectedOutput,expectedOutput:f.expectedOutput})),n?.coinReward,n?.title,n?.difficulty);l.success&&n&&r?(U(!0),L({success:!0,passedCount:l.passedCount,totalCount:l.totalCount,totalTime:0,totalMemory:0,results:l.testResults?.map((f,W)=>({testCase:W+1,passed:f.passed,input:f.input,expected:f.expected,output:f.output}))||p.map((f,W)=>({testCase:W+1,passed:!0}))}),l.coinsChanged>0&&alert(`ðŸŽ‰ ${l.message}`)):(L({success:!1,passedCount:l.passedCount,totalCount:l.totalCount,totalTime:0,totalMemory:0,results:l.testResults?.map((f,W)=>({testCase:W+1,passed:f.passed,input:f.input,expected:f.expected,output:f.output,error:f.error}))||p.map((f,W)=>({testCase:W+1,passed:!1}))}),l.coinsChanged<0?alert(`âŒ ${l.message}`):l.message&&alert(l.message))}catch(l){console.error("Submission error:",l);let f="Submission failed. Please try again.";l instanceof Me?f=`Security Error: ${l.message}`:l instanceof xe?f=`Validation Error: ${l.message}`:l instanceof Error&&(f=l.message),L({success:!1,results:[],passedCount:0,totalCount:p.length,totalTime:0,totalMemory:0,compilationError:f})}P(!1)},Y=l=>{switch(l){case"easy":return"text-green-400 bg-green-400/10 border-green-400/30";case"medium":return"text-yellow-400 bg-yellow-400/10 border-yellow-400/30";case"hard":return"text-red-400 bg-red-400/10 border-red-400/30";case"expert":return"text-purple-400 bg-purple-400/10 border-purple-400/30";default:return"text-gray-400 bg-gray-400/10 border-gray-400/30"}};return y?e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"h-screen bg-gray-900 flex flex-col overflow-hidden -mx-4 -mt-6",children:[e.jsxs("header",{className:"bg-gradient-to-r from-gray-800 via-gray-900 to-black border-b border-gray-700 px-4 py-3 flex items-center justify-between relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-20 bg-gradient-to-bl from-cyan-500/20 to-transparent rounded-full -translate-y-10 translate-x-20"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>a("/dashboard/codearena/practice"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(St,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg font-bold text-white flex items-center gap-2",children:[n?.title||"Loading...",D&&e.jsx(re,{className:"w-5 h-5 text-green-400"})]}),e.jsx("div",{className:"flex items-center gap-3 text-sm",children:n&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full border ${Y(n.difficulty)}`,children:n.difficulty?n.difficulty.charAt(0).toUpperCase()+n.difficulty.slice(1):"Unknown"}),e.jsxs("span",{className:"text-gray-400",children:["Category: ",n.category||"N/A"]}),e.jsxs("span",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(ee,{className:"w-4 h-4"}),n.coinReward]})]})})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>j(!g),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-600 hover:to-gray-500 rounded-lg transition-all shadow-lg border border-gray-600 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/10 to-blue-500/10"}),e.jsx(le,{className:"w-4 h-4 text-cyan-400 relative"}),e.jsx("span",{className:"text-white capitalize font-semibold relative",children:b}),e.jsx(ot,{className:"w-4 h-4 text-gray-400 relative"})]}),e.jsx(oe,{children:g&&e.jsx(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 top-full mt-2 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 overflow-hidden",children:q.filter(l=>["python","cpp","java","javascript"].includes(l.id)).map(l=>e.jsx("button",{onClick:()=>{B(l.id),j(!1)},className:`w-full px-4 py-2 text-left hover:bg-gray-700 transition-colors ${b===l.id?"text-cyan-400 bg-gray-700/50":"text-white"}`,children:l.name},l.id))})})]}),n&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-gray-400 hover:text-white transition-colors cursor-pointer",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Database Challenge"})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 text-green-400 bg-green-500/10 rounded-lg border border-green-500/20",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Secure Mode"})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/2 border-r border-gray-700 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-700",children:[e.jsx("button",{onClick:()=>_("description"),className:`px-4 py-3 text-sm font-medium transition-colors ${T==="description"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Description"}),e.jsx("button",{onClick:()=>_("submissions"),className:`px-4 py-3 text-sm font-medium transition-colors ${T==="submissions"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Submissions"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:T==="description"?e.jsx("div",{className:"space-y-4",children:y?e.jsx("div",{className:"flex items-center justify-center py-10",children:e.jsx(ae,{className:"w-8 h-8 text-cyan-400 animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"prose prose-invert max-w-none problem-statement",dangerouslySetInnerHTML:{__html:n?.problemStatement||""}}),n?.examples&&n.examples.length>0&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Examples"}),n.examples.map((l,f)=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-2 divide-x divide-gray-700",children:[e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Input"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.input})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Output"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.output})]})]}),l.explanation&&e.jsxs("div",{className:"px-3 pb-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Explanation"}),e.jsx("p",{className:"text-sm text-gray-300",children:l.explanation})]})]},f))]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Sample Test Cases (",p.length,")"]}),e.jsxs("button",{onClick:async()=>{if(t){w(!0);const l=await jt(t);h(l),w(!1)}},className:"flex items-center gap-1 text-sm text-cyan-400 hover:text-cyan-300",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Refresh"]})]}),p.length>0?p.map((l,f)=>e.jsx(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:f*.1},className:"bg-gradient-to-br from-gray-800/80 to-gray-900/80 rounded-xl border border-gray-700 overflow-hidden shadow-lg hover:shadow-xl transition-shadow",children:e.jsxs("div",{className:"grid grid-cols-2 divide-x divide-gray-700",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-900/20 to-transparent",children:[e.jsx("p",{className:"text-xs text-[#00ADB5] mb-2 font-semibold flex items-center gap-1",children:"ðŸ“ Input"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap bg-gray-900/50 p-2 rounded",children:l.input})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-900/20 to-transparent",children:[e.jsx("p",{className:"text-xs text-green-400 mb-2 font-semibold flex items-center gap-1",children:"âœ… Output"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap bg-gray-900/50 p-2 rounded",children:l.expectedOutput})]})]})},f)):e.jsxs("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 p-6 text-center",children:[e.jsx("p",{className:"text-gray-400 mb-2",children:"No test cases loaded yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Click Refresh to load test cases or use custom input"})]})]}),n?.tags&&n.tags.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{onClick:()=>O(!z),className:"flex items-center gap-2 text-yellow-400 hover:text-yellow-300 transition-colors",children:[e.jsx(Ct,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:z?"Hide Hints":"Show Hints (Tags)"})]}),e.jsx(oe,{children:z&&e.jsx(c.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 flex flex-wrap gap-2",children:n.tags.map((l,f)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-700 text-gray-300 rounded",children:l},f))})})]})]})}):e.jsxs("div",{className:"text-center py-10 text-gray-400",children:[e.jsx(Q,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Your submission history will appear here"})]})})]}),e.jsxs("div",{className:"w-1/2 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(dt,{height:"100%",language:b==="cpp"?"cpp":b,value:S,onChange:l=>A(l||""),theme:"vs-dark",options:{fontSize:14,fontFamily:"JetBrains Mono, Fira Code, Consolas, monospace",minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",glyphMargin:!1,folding:!0,lineDecorationsWidth:10,automaticLayout:!0,tabSize:4,wordWrap:"on",padding:{top:10}}})}),e.jsxs("div",{className:"border-t border-gray-700 px-4 py-2 flex items-center gap-4 bg-gray-800/50",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:l=>u(l.target.checked),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded accent-cyan-500"}),"Custom Input"]}),v&&e.jsx("textarea",{value:x,onChange:l=>I(l.target.value),placeholder:"Enter custom input...",className:"flex-1 px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm text-white resize-none h-8"})]}),e.jsx("div",{className:"h-48 border-t border-gray-700 bg-gray-800/50 overflow-y-auto",children:$||d?e.jsxs("div",{className:"p-4",children:[d&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${d.error?"text-red-400":"text-green-400"}`,children:d.status}),d.time&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(we,{className:"w-3 h-3"}),d.time,"s"]}),d.memory&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(Oe,{className:"w-3 h-3"}),(d.memory/1024).toFixed(2)," MB"]})]}),d.output&&e.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Output:"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:d.output})]}),d.stderr&&e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Error:"}),e.jsx("pre",{className:"text-sm text-red-300 font-mono whitespace-pre-wrap",children:d.stderr})]})]}),$&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${$.success?"bg-green-900/20 border border-green-500/30":"bg-red-900/20 border border-red-500/30"}`,children:[$.success?e.jsx(re,{className:"w-6 h-6 text-green-400"}):e.jsx(ve,{className:"w-6 h-6 text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${$.success?"text-green-400":"text-red-400"}`,children:$.success?"All Tests Passed!":"Some Tests Failed"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[$.passedCount," / ",$.totalCount," test cases passed"]})]}),$.success&&n&&e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-yellow-400",children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-bold",children:["+",n.coinReward]})]})]}),$.compilationError&&e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Compilation Error:"}),e.jsx("pre",{className:"text-sm text-red-300 font-mono whitespace-pre-wrap",children:$.compilationError})]}),$.results&&$.results.length>0&&e.jsx("div",{className:"space-y-2",children:$.results.map((l,f)=>e.jsx("div",{className:`p-2 rounded border ${l.passed?"bg-green-900/10 border-green-500/20":"bg-red-900/10 border-red-500/20"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[l.passed?e.jsx(re,{className:"w-4 h-4 text-green-400"}):e.jsx(ve,{className:"w-4 h-4 text-red-400"}),e.jsxs("span",{className:"text-sm text-white",children:["Test Case ",l.testCase]}),l.time&&e.jsxs("span",{className:"text-xs text-gray-400",children:[l.time,"s"]})]})},f))})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsx("p",{className:"text-sm",children:"Run or submit your code to see results"})})}),e.jsxs("div",{className:"border-t border-gray-700 p-4 flex items-center justify-between bg-gray-800",children:[e.jsxs("button",{onClick:()=>A(V[b]||""),className:"flex items-center gap-2 px-4 py-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Reset Code"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(c.button,{whileHover:{scale:1.02,boxShadow:"0 10px 30px rgba(59, 130, 246, 0.3)"},whileTap:{scale:.98},onClick:X,disabled:o||k,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-[#00ADB5] to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg relative overflow-hidden",children:[o&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-indigo-400/20"}),o?e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full relative"}):e.jsx(At,{className:"w-4 h-4 relative"}),e.jsx("span",{className:"relative",children:"Run"})]}),e.jsxs(c.button,{whileHover:{scale:1.02,boxShadow:"0 10px 30px rgba(34, 197, 94, 0.3)"},whileTap:{scale:.98},onClick:H,disabled:o||k,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 via-emerald-500 to-green-600 hover:from-green-600 hover:via-emerald-600 hover:to-green-700 text-white rounded-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg relative overflow-hidden",children:[k&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-green-400/20 to-emerald-400/20"}),k?e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full relative"}):e.jsx(ct,{className:"w-4 h-4 relative"}),e.jsx("span",{className:"relative",children:"âš¡ Submit"})]})]})]})]})]}),e.jsx("style",{children:`
        .problem-statement {
          color: #e5e7eb;
        }
        .problem-statement .header {
          font-size: 1.25rem;
          font-weight: 600;
          margin-bottom: 1rem;
        }
        .problem-statement .time-limit,
        .problem-statement .memory-limit {
          color: #9ca3af;
          font-size: 0.875rem;
        }
        .problem-statement pre {
          background: #1f2937;
          padding: 0.75rem;
          border-radius: 0.5rem;
          overflow-x: auto;
        }
        .problem-statement .section-title {
          font-size: 1.125rem;
          font-weight: 600;
          margin-top: 1.5rem;
          margin-bottom: 0.5rem;
          color: #60a5fa;
        }
        .problem-statement .input-specification,
        .problem-statement .output-specification,
        .problem-statement .note {
          margin-top: 1rem;
        }
        .problem-statement .sample-tests {
          margin-top: 1.5rem;
        }
        .problem-statement .input,
        .problem-statement .output {
          background: #1f2937;
          padding: 0.5rem;
          border-radius: 0.25rem;
          margin: 0.5rem 0;
        }
      `})]})},qs=()=>{const{user:t}=fe(),{fetchGlobalLeaderboard:a,fetchWeeklyLeaderboard:s,fetchMonthlyLeaderboard:r,getUserWallet:n}=be(),[m,p]=i.useState("global"),[h,y]=i.useState([]),[w,S]=i.useState(!0),[A,b]=i.useState(null),[B,g]=i.useState(null);i.useEffect(()=>{(async()=>{S(!0);try{let C=[];switch(m){case"global":C=await a();break;case"weekly":C=await s();break;case"monthly":C=await r();break}if(y(C),t){const k=await n(t.id);g(k);const P=C.find($=>$.odId===t.id);P&&b(P)}}catch(C){console.error("Error loading leaderboard:",C),y([])}finally{S(!1)}})()},[m,t]);const j=o=>{switch(o){case 1:return e.jsx(ge,{className:"w-5 h-5 text-yellow-500"});case 2:return e.jsx(De,{className:"w-5 h-5 text-gray-400"});case 3:return e.jsx(De,{className:"w-5 h-5 text-amber-600"});default:return null}};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-6 pb-20 md:pb-6",children:[e.jsx(c.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/30 rounded-xl",children:e.jsx(Q,{className:"w-6 h-6 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"ðŸ† Leaderboard"}),e.jsx("p",{className:"text-gray-500 dark:text-white text-sm",children:"Compete with the best coders"})]})]}),e.jsx("div",{className:"flex gap-2 bg-gray-100 dark:bg-gray-700 p-2 rounded-lg",children:[{id:"global",label:"All Time",icon:Q},{id:"weekly",label:"Weekly",icon:Nt},{id:"monthly",label:"Monthly",icon:we}].map(o=>e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>p(o.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${m===o.id?"bg-[#00ADB5] text-white":"text-gray-600 dark:text-white hover:text-gray-800 dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[e.jsx(o.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:o.label})]},o.id))})]})}),e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6 text-center",children:"Top Performers"}),e.jsxs("div",{className:"flex items-end justify-center gap-4 md:gap-8",children:[h[1]&&e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 rounded-full bg-gray-500 flex items-center justify-center text-xl md:text-2xl font-bold text-white shadow-md border-2 border-gray-400",children:h[1]?.avatar||h[1]?.odName?.[0]||"?"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-gray-600 rounded-full flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"2"})})]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-semibold text-sm md:text-base text-center truncate max-w-[80px] md:max-w-[100px]",children:h[1]?.odName}),e.jsxs("p",{className:"text-gray-600 dark:text-white text-xs",children:["Level ",h[1]?.level]}),e.jsxs("div",{className:"mt-3 h-20 w-20 md:w-24 rounded-t-xl bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-[#00ADB5] font-bold text-lg",children:h[1]?.rating}),e.jsxs("span",{className:"text-gray-600 dark:text-white text-xs",children:[h[1]?.problemsSolved," solved"]})]})]}),h[0]&&e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col items-center -mt-4",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full bg-amber-500 flex items-center justify-center text-2xl md:text-3xl font-bold text-white shadow-xl border-3 border-amber-400",children:h[0]?.avatar||h[0]?.odName?.[0]||"?"}),e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-amber-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(ge,{className:"w-5 h-5 text-white"})})]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-bold text-base md:text-lg text-center truncate max-w-[100px] md:max-w-[120px]",children:h[0]?.odName}),e.jsxs("p",{className:"text-gray-600 dark:text-white text-xs",children:["Level ",h[0]?.level]}),e.jsxs("div",{className:"mt-3 h-28 w-24 md:w-28 rounded-t-xl bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-700 shadow-md flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-[#00ADB5] font-bold text-xl",children:h[0]?.rating}),e.jsxs("span",{className:"text-gray-600 dark:text-white text-xs",children:[h[0]?.problemsSolved," solved"]})]})]}),h[2]&&e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("div",{className:"w-16 h-16 md:w-20 md:h-20 rounded-full bg-orange-500 flex items-center justify-center text-xl md:text-2xl font-bold text-white shadow-md border-2 border-orange-400",children:h[2]?.avatar||h[2]?.odName?.[0]||"?"}),e.jsx("div",{className:"absolute -top-1 -right-1 w-7 h-7 bg-orange-600 rounded-full flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"3"})})]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-semibold text-sm md:text-base text-center truncate max-w-[80px] md:max-w-[100px]",children:h[2]?.odName}),e.jsxs("p",{className:"text-gray-600 dark:text-white text-xs",children:["Level ",h[2]?.level]}),e.jsxs("div",{className:"mt-3 h-16 w-20 md:w-24 rounded-t-xl bg-orange-50 dark:bg-orange-900/30 border border-orange-200 dark:border-orange-700 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-[#00ADB5] font-bold text-lg",children:h[2]?.rating}),e.jsxs("span",{className:"text-gray-600 dark:text-white text-xs",children:[h[2]?.problemsSolved," solved"]})]})]})]})]}),B&&e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 border border-[#00ADB5]/30 dark:border-blue-700 rounded-xl p-5",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-xl font-bold text-white shadow-lg",children:B?.userName?.[0]||"Y"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-[#00ADB5] rounded-full flex items-center justify-center text-xs font-bold text-white border-2 border-white dark:border-gray-800",children:A?.rank||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 dark:text-white font-semibold text-lg",children:B?.userName||"You"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-white",children:"Your Current Rank"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[#00ADB5] font-bold text-xl",children:A?.rating||B?.coins||1e3}),e.jsx("p",{className:"text-xs text-gray-500",children:"Rating"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-emerald-600 font-bold text-xl",children:A?.problemsSolved||0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:"Solved"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-purple-600 font-bold text-xl",children:A?.battlesWon||0}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:"Wins"})]})]})]})}),e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 py-3 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600 text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.jsx("div",{className:"col-span-1 text-center",children:"#"}),e.jsx("div",{className:"col-span-5",children:"Player"}),e.jsx("div",{className:"col-span-2 text-center",children:"Rating"}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:"Solved"}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:"Wins"})]}),w?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(ae,{className:"w-8 h-8 text-[#00ADB5] animate-spin"})}):h.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-500 dark:text-white",children:[e.jsx(Q,{className:"w-12 h-12 mb-3 opacity-30"}),e.jsx("p",{className:"text-lg font-medium",children:"No rankings yet"}),e.jsx("p",{className:"text-sm",children:"Start solving challenges to appear on the leaderboard!"})]}):e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:h.map((o,C)=>e.jsxs(c.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:C*.03},className:`grid grid-cols-12 gap-2 px-4 py-4 items-center hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${o.odId===t?.id?"bg-[#00ADB5]/10 dark:bg-[#00ADB5]/20 border-l-4 border-[#00ADB5]":""}`,children:[e.jsx("div",{className:"col-span-1 flex items-center justify-center",children:o.rank<=3?e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${o.rank===1?"bg-yellow-100":o.rank===2?"bg-gray-100":"bg-amber-100"}`,children:j(o.rank)}):e.jsx("span",{className:"text-gray-500 dark:text-white font-medium",children:o.rank})}),e.jsxs("div",{className:"col-span-5 flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold text-white flex-shrink-0 ${o.rank===1?"bg-amber-500":o.rank===2?"bg-gray-500":o.rank===3?"bg-orange-500":"bg-gray-400"}`,children:o.avatar||o.odName?.[0]||"?"}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("p",{className:"text-gray-900 dark:text-white font-medium truncate flex items-center gap-2",children:[o.odName,o.odId===t?.id&&e.jsx("span",{className:"text-xs bg-[#00ADB5]/20 dark:bg-blue-900/50 text-[#00ADB5] dark:text-[#00ADB5] px-2 py-0.5 rounded-full font-medium",children:"You"})]}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-white flex items-center gap-1",children:[e.jsx(Ae,{className:"w-3 h-3 text-amber-500"}),"Level ",o.level]})]})]}),e.jsx("div",{className:"col-span-2 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(qe,{className:"w-4 h-4 text-[#00ADB5]"}),e.jsx("span",{className:"text-[#00ADB5] font-bold",children:o.rating})]})}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:e.jsx("span",{className:"text-green-600 font-medium",children:o.problemsSolved})}),e.jsx("div",{className:"col-span-2 text-center hidden sm:block",children:e.jsx("span",{className:"text-purple-600 font-medium",children:o.battlesWon})})]},o.odId||C))})]}),e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[e.jsx(Jt,{className:"w-5 h-5 text-amber-600"}),"Weekly Rewards"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:[{rank:"1st Place",coins:100,icon:ge,bgColor:"bg-amber-50 dark:bg-amber-900/30",iconBg:"bg-amber-500",borderColor:"border-amber-200 dark:border-amber-700"},{rank:"2nd Place",coins:50,icon:De,bgColor:"bg-gray-50 dark:bg-gray-700",iconBg:"bg-gray-500",borderColor:"border-gray-200 dark:border-gray-600"},{rank:"3rd Place",coins:200,icon:De,bgColor:"bg-orange-50 dark:bg-orange-900/30",iconBg:"bg-orange-500",borderColor:"border-orange-200 dark:border-orange-700"}].map((o,C)=>e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6+C*.1},className:`flex items-center gap-4 p-4 rounded-lg border ${o.bgColor} ${o.borderColor} hover:shadow-md transition-all`,children:[e.jsx("div",{className:`p-3 rounded-lg ${o.iconBg} shadow-sm`,children:e.jsx(o.icon,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:o.rank}),e.jsxs("p",{className:"text-amber-600 font-bold text-lg",children:[o.coins.toLocaleString()," coins"]})]})]},C))})]})]})})},wt=t=>Array.isArray(t)?t.map(a=>({input:a.input||"",expectedOutput:a.expectedOutput||a.expected_output||"",isHidden:a.isHidden||!1,points:a.points||0})):[],Gs=()=>{const{challengeId:t}=Ye(),a=pe(),s=lt(),[r,n]=i.useState(null),[m,p]=i.useState(!0),[h,y]=i.useState(""),[w,S]=i.useState("python"),[A,b]=i.useState(!1),[B,g]=i.useState(!1),[j,o]=i.useState(!1),[C,k]=i.useState(null),[P,$]=i.useState(null),[L,d]=i.useState(""),[E,x]=i.useState(!1),[I,v]=i.useState("description"),[u,T]=i.useState(!1),[_,z]=i.useState(!1),[O,D]=i.useState({}),U=Wt();i.useEffect(()=>{(async()=>{if(t){p(!0);try{let f=s.state?.challenge;if(f&&!f.problemStatement){const J={easy:"Easy",Easy:"Easy",medium:"Medium",Medium:"Medium",hard:"Hard",Hard:"Hard",expert:"Hard"}[f.difficulty]||"Medium";f={id:f.id,title:f.title,description:f.description,difficulty:J,category:f.category||f.topic,points:100,coinReward:f.coinReward||10,timeLimit:5e3,memoryLimit:256,problemStatement:f.description,inputFormat:"Standard input",outputFormat:"Standard output",constraints:[f.constraints||"N/A"],examples:[],testCases:wt(f.testCases||f.test_cases||[]),hints:[],tags:[f.category||f.topic],isPremium:!1,isDaily:!1,totalSubmissions:0,successfulSubmissions:0,acceptanceRate:0,createdAt:new Date,updatedAt:new Date}}f||(f=await _t(t)),f&&(n(f),f.starterCode?.[w]?y(f.starterCode[w]||""):y(q(w))),p(!1)}catch(f){console.error("Error loading challenge:",f),p(!1)}}})()},[t,s]),i.useEffect(()=>{r?.starterCode?.[w]?y(r.starterCode[w]||""):y(q(w))},[w,r]);const q=l=>{const f={python:`# Write your solution here
def solve():
    # Read input
    n = int(input())
    
    # Your code here
    result = n
    
    # Print output
    print(result)

solve()`,cpp:`#include <bits/stdc++.h>
using namespace std;

int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    
    // Read input
    int n;
    cin >> n;
    
    // Your code here
    int result = n;
    
    // Print output
    cout << result << endl;
    
    return 0;
}`,java:`import java.util.*;

public class Main {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        
        // Read input
        int n = sc.nextInt();
        
        // Your code here
        int result = n;
        
        // Print output
        System.out.println(result);
    }
}`,javascript:`// Read input from stdin
const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

let lines = [];
rl.on('line', (line) => {
    lines.push(line);
});

rl.on('close', () => {
    // Parse input
    const n = parseInt(lines[0]);
    
    // Your code here
    const result = n;
    
    // Print output
    console.log(result);
});`};return f[l]||f.python},V=async()=>{if(r){g(!0),$(null),k(null);try{const l=r.testCases.filter(J=>!J.isHidden),f=E?L:l[0]?.input||"",W=await zs(h,w,f);$(W)}catch(l){$({output:"",error:l?.message||"Failed to run code. Please try again.",time:null,memory:null,status:"Error"})}g(!1)}},X=async()=>{if(!(!r||!t)){o(!0),k(null),$(null);try{let l=r.testCases||[];if(l.length===0&&(l=wt(await Ps(t)||[])),l.length===0){k({success:!1,results:[],passedCount:0,totalCount:0,totalTime:0,totalMemory:0,compilationError:"No test cases available for this challenge."}),o(!1);return}const f=l.map(J=>({input:J.input||"",expectedOutput:J.expectedOutput||J.expected_output||""})),W=await rt.submitChallenge(t,h,w,f,r.coinReward||10,r.title,r.difficulty);k({success:W.success,passedCount:W.passedCount,totalCount:W.totalCount,totalTime:0,totalMemory:0,results:W.testResults?.map((J,_e)=>({testCase:_e+1,passed:J.passed,input:J.input,expected:J.expected,output:J.output,error:J.error}))||[]}),W.success?(z(!0),W.coinsChanged>0?alert(`ðŸŽ‰ ${W.message}`):alert(`âœ… ${W.message||"All test cases passed!"}`)):W.coinsChanged<0?alert(`âŒ ${W.message}`):W.message&&alert(`âŒ ${W.message}`)}catch(l){console.error("Submission error:",l),k({success:!1,results:[],passedCount:0,totalCount:0,totalTime:0,totalMemory:0,compilationError:l?.message||"Submission failed. Please try again."})}o(!1)}},H=l=>{switch(l){case"easy":return"text-green-400 bg-green-400/10 border-green-400/30";case"medium":return"text-yellow-400 bg-yellow-400/10 border-yellow-400/30";case"hard":return"text-red-400 bg-red-400/10 border-red-400/30";case"expert":return"text-purple-400 bg-purple-400/10 border-purple-400/30";default:return"text-gray-400 bg-gray-400/10 border-gray-400/30"}};if(m)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full"})});if(!r)return e.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Challenge Not Found"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"The challenge you're looking for doesn't exist."}),e.jsx("button",{onClick:()=>a("/dashboard/codearena/practice"),className:"px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-colors",children:"Back to Challenges"})]})});const Y=r.testCases.filter(l=>!l.isHidden);return e.jsxs("div",{className:"h-screen bg-gray-900 flex flex-col overflow-hidden -mx-4 -mt-6",children:[e.jsxs("header",{className:"bg-gray-800/90 border-b border-gray-700 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>a("/dashboard/codearena/practice"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:e.jsx(St,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg font-bold text-white flex items-center gap-2",children:[r.title,_&&e.jsx(re,{className:"w-5 h-5 text-green-400"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full border ${H(r.difficulty)}`,children:r.difficulty?r.difficulty.charAt(0).toUpperCase()+r.difficulty.slice(1):"Unknown"}),e.jsx("span",{className:"text-gray-400",children:r.category}),e.jsxs("span",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(ee,{className:"w-4 h-4"}),r.coinReward]})]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>b(!A),className:"flex items-center gap-2 px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg transition-colors",children:[e.jsx(le,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{className:"text-white capitalize",children:w}),e.jsx(ot,{className:"w-4 h-4 text-gray-400"})]}),e.jsx(oe,{children:A&&e.jsx(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 top-full mt-2 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 overflow-hidden",children:U.filter(l=>["python","cpp","java","javascript"].includes(l.id)).map(l=>e.jsx("button",{onClick:()=>{S(l.id),b(!1)},className:`w-full px-4 py-2 text-left hover:bg-gray-700 transition-colors ${w===l.id?"text-cyan-400 bg-gray-700/50":"text-white"}`,children:l.name},l.id))})})]})})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-1/2 border-r border-gray-700 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-700",children:[e.jsx("button",{onClick:()=>v("description"),className:`px-4 py-3 text-sm font-medium transition-colors ${I==="description"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Description"}),e.jsx("button",{onClick:()=>v("submissions"),className:`px-4 py-3 text-sm font-medium transition-colors ${I==="submissions"?"text-cyan-400 border-b-2 border-cyan-400":"text-gray-400 hover:text-white"}`,children:"Submissions"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:I==="description"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"prose prose-invert max-w-none problem-statement",dangerouslySetInnerHTML:{__html:r.problemStatement||""}}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Examples"}),(r.examples||[]).map((l,f)=>e.jsxs("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-2 divide-x divide-gray-700",children:[e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Input"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.input})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Output"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.output})]})]}),l.explanation&&e.jsxs("div",{className:"p-3 border-t border-gray-700 bg-gray-800/30",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Explanation"}),e.jsx("p",{className:"text-sm text-gray-300",children:l.explanation})]})]},f))]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:["Sample Test Cases (",Y.length,")"]}),Y.map((l,f)=>e.jsx("div",{className:"bg-gray-800/50 rounded-lg border border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-2 divide-x divide-gray-700",children:[e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Input"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.input})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Expected Output"}),e.jsxs("button",{onClick:()=>D(W=>({...W,[f]:!W[f]})),className:"text-xs text-cyan-400 hover:text-cyan-300 flex items-center gap-1",children:[O[f]?e.jsx(ma,{className:"w-3 h-3"}):e.jsx(Xt,{className:"w-3 h-3"}),O[f]?"Hide":"Show"]})]}),O[f]?e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:l.expectedOutput}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:'Click "Show" to reveal'})]})]})},f))]}),r.hints&&r.hints.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{onClick:()=>T(!u),className:"flex items-center gap-2 text-yellow-400 hover:text-yellow-300 transition-colors",children:[e.jsx(Ct,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:u?"Hide Hints":"Show Hints"})]}),e.jsx(oe,{children:u&&e.jsx(c.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 space-y-2",children:r.hints.map((l,f)=>e.jsxs("div",{className:"p-3 bg-yellow-900/20 border border-yellow-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-xs text-yellow-400",children:["Hint ",f+1]}),e.jsxs("span",{className:"text-xs text-yellow-400/70",children:[typeof l=="object"?l.coinCost:5," coins"]})]}),e.jsx("p",{className:"text-sm text-gray-300",children:typeof l=="object"?l.text:l})]},f))})})]}),r.tags&&r.tags.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map((l,f)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-700 text-gray-300 rounded",children:l},f))})]})]}):e.jsxs("div",{className:"text-center py-10 text-gray-400",children:[e.jsx(Q,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Your submission history will appear here"})]})})]}),e.jsxs("div",{className:"w-1/2 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(dt,{height:"100%",language:w==="cpp"?"cpp":w,value:h,onChange:l=>y(l||""),theme:"vs-dark",options:{fontSize:14,fontFamily:"JetBrains Mono, Fira Code, Consolas, monospace",minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",glyphMargin:!1,folding:!0,lineDecorationsWidth:10,automaticLayout:!0,tabSize:4,wordWrap:"on",padding:{top:10}}})}),e.jsxs("div",{className:"border-t border-gray-700 px-4 py-2 flex items-center gap-4 bg-gray-800/50",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:l=>x(l.target.checked),className:"w-4 h-4 bg-gray-700 border-gray-600 rounded accent-cyan-500"}),"Custom Input"]}),E&&e.jsx("textarea",{value:L,onChange:l=>d(l.target.value),placeholder:"Enter custom input...",className:"flex-1 px-3 py-1 bg-gray-800 border border-gray-700 rounded text-sm text-white resize-none h-8"})]}),e.jsx("div",{className:"h-48 border-t border-gray-700 bg-gray-800/50 overflow-y-auto",children:C||P?e.jsxs("div",{className:"p-4",children:[P&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-medium ${P.error?"text-red-400":"text-green-400"}`,children:P.status}),P.time&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(we,{className:"w-3 h-3"}),P.time,"s"]}),P.memory&&e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(Oe,{className:"w-3 h-3"}),(P.memory/1024).toFixed(2)," MB"]})]}),P.output&&e.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Output:"}),e.jsx("pre",{className:"text-sm text-white font-mono whitespace-pre-wrap",children:P.output})]}),P.error&&e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Error:"}),e.jsx("pre",{className:"text-sm text-red-300 font-mono whitespace-pre-wrap",children:P.error})]})]}),C&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${C.success?"bg-green-900/20 border border-green-500/30":"bg-red-900/20 border border-red-500/30"}`,children:[C.success?e.jsx(re,{className:"w-6 h-6 text-green-400"}):e.jsx(ve,{className:"w-6 h-6 text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${C.success?"text-green-400":"text-red-400"}`,children:C.success?"All Tests Passed!":"Some Tests Failed"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[C.passedCount," / ",C.totalCount," test cases passed"]})]}),C.success&&r&&e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-yellow-400",children:[e.jsx(ee,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-bold",children:["+",r.coinReward]})]})]}),C.compilationError&&e.jsxs("div",{className:"bg-red-900/20 border border-red-500/30 rounded p-3",children:[e.jsx("p",{className:"text-xs text-red-400 mb-1",children:"Compilation Error:"}),e.jsx("pre",{className:"text-sm text-red-300 font-mono whitespace-pre-wrap",children:C.compilationError})]}),C.results&&C.results.length>0&&e.jsx("div",{className:"space-y-2",children:C.results.map((l,f)=>e.jsxs("div",{className:`p-2 rounded border ${l.passed?"bg-green-900/10 border-green-500/20":"bg-red-900/10 border-red-500/20"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l.passed?e.jsx(re,{className:"w-4 h-4 text-green-400"}):e.jsx(ve,{className:"w-4 h-4 text-red-400"}),e.jsxs("span",{className:"text-sm text-white",children:["Test Case ",l.testCase]}),l.time&&e.jsxs("span",{className:"text-xs text-gray-400",children:[l.time,"s"]})]}),!l.passed&&l.actualOutput&&e.jsxs("div",{className:"mt-2 pl-6",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Your output:"}),e.jsx("pre",{className:"text-xs text-red-300 font-mono",children:l.actualOutput}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Expected:"}),e.jsx("pre",{className:"text-xs text-green-300 font-mono",children:l.expectedOutput})]})]},f))})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsx("p",{className:"text-sm",children:"Run or submit your code to see results"})})}),e.jsxs("div",{className:"border-t border-gray-700 p-4 flex items-center justify-between bg-gray-800",children:[e.jsxs("button",{onClick:()=>{r?.starterCode?.[w]?y(r.starterCode[w]||""):y(q(w))},className:"flex items-center gap-2 px-4 py-2 text-gray-400 hover:text-white transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Reset Code"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(c.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:V,disabled:B||j,className:"flex items-center gap-2 px-5 py-2.5 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[B?e.jsx(ae,{className:"w-4 h-4 animate-spin"}):e.jsx(At,{className:"w-4 h-4"}),"Run"]}),e.jsxs(c.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:X,disabled:B||j,className:"flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[j?e.jsx(ae,{className:"w-4 h-4 animate-spin"}):e.jsx(ct,{className:"w-4 h-4"}),"Submit"]})]})]})]})]}),e.jsx("style",{children:`
        .problem-statement {
          color: #e5e7eb;
        }
        .problem-statement .header {
          font-size: 1.25rem;
          font-weight: 600;
          margin-bottom: 1rem;
        }
        .problem-statement .time-limit,
        .problem-statement .memory-limit {
          color: #9ca3af;
          font-size: 0.875rem;
        }
        .problem-statement pre {
          background: #1f2937;
          padding: 0.75rem;
          border-radius: 0.5rem;
          overflow-x: auto;
        }
        .problem-statement code {
          background: #374151;
          padding: 0.125rem 0.375rem;
          border-radius: 0.25rem;
          font-size: 0.875rem;
        }
        .problem-statement .section-title {
          font-size: 1.125rem;
          font-weight: 600;
          margin-top: 1.5rem;
          margin-bottom: 0.5rem;
          color: #60a5fa;
        }
        .problem-statement ul {
          padding-left: 1.5rem;
          list-style-type: disc;
        }
        .problem-statement ol {
          padding-left: 1.5rem;
          list-style-type: decimal;
        }
        .problem-statement li {
          margin: 0.25rem 0;
        }
      `})]})},Js=[{problems:[{id:"A001",title:"Maximum Subarray Sum",difficulty:"Medium",timeLimit:"1s",memoryLimit:"256MB",description:"Given an integer array nums, find the contiguous subarray (containing at least one number) which has the largest sum and return its sum.",inputFormat:`First line contains integer n (1 â‰¤ n â‰¤ 10^5) - the length of array.
Second line contains n integers a_i (-10^4 â‰¤ a_i â‰¤ 10^4) - array elements.`,outputFormat:"Print a single integer - the maximum sum of contiguous subarray.",constraints:["1 â‰¤ n â‰¤ 100000","-10000 â‰¤ nums[i] â‰¤ 10000"],tags:["array","dynamic-programming","kadane"],testCases:[{input:`9
-2 1 -3 4 -1 2 1 -5 4`,output:"6",explanation:"Subarray [4,-1,2,1] has the largest sum = 6"},{input:`1
5`,output:"5",explanation:"Single element array"},{input:`5
-1 -2 -3 -4 -5`,output:"-1",explanation:"All negative, choose the largest"}]},{id:"A002",title:"Rotate Array",difficulty:"Easy",timeLimit:"2s",memoryLimit:"256MB",description:"Given an array, rotate the array to the right by k steps, where k is non-negative.",inputFormat:`First line contains two integers n and k (1 â‰¤ n â‰¤ 10^5, 0 â‰¤ k â‰¤ 10^9) - array length and rotation steps.
Second line contains n integers a_i (1 â‰¤ a_i â‰¤ 10^9) - array elements.`,outputFormat:"Print n integers - the rotated array.",constraints:["1 â‰¤ n â‰¤ 100000","0 â‰¤ k â‰¤ 10^9","1 â‰¤ nums[i] â‰¤ 10^9"],tags:["array","math"],testCases:[{input:`7 3
1 2 3 4 5 6 7`,output:"5 6 7 1 2 3 4",explanation:"Rotate right by 3 steps"},{input:`3 2
-1 -100 3`,output:"-100 3 -1",explanation:"Rotate right by 2 steps"},{input:`2 5
1 2`,output:"2 1",explanation:"k=5 is same as k=1 for length 2"}]},{id:"A003",title:"Find Missing Number",difficulty:"Easy",timeLimit:"1s",memoryLimit:"256MB",description:"Given an array nums containing n distinct numbers in the range [0, n], return the only number in the range that is missing from the array.",inputFormat:`First line contains integer n (1 â‰¤ n â‰¤ 10^4).
Second line contains n integers - array elements (each in range [0, n]).`,outputFormat:"Print a single integer - the missing number.",constraints:["1 â‰¤ n â‰¤ 10000","0 â‰¤ nums[i] â‰¤ n","All numbers are distinct"],tags:["array","math","bit-manipulation"],testCases:[{input:`3
3 0 1`,output:"2",explanation:"n=3, array has [0,1,3], missing 2"},{input:`2
0 1`,output:"2",explanation:"Range [0,2], missing 2"},{input:`9
9 6 4 2 3 5 7 0 1`,output:"8",explanation:"Missing number is 8"}]},{id:"A004",title:"Product of Array Except Self",difficulty:"Medium",timeLimit:"2s",memoryLimit:"256MB",description:"Given an integer array nums, return an array answer such that answer[i] is equal to the product of all the elements of nums except nums[i]. You must write an algorithm that runs in O(n) time and without using the division operation.",inputFormat:`First line contains integer n (2 â‰¤ n â‰¤ 10^5).
Second line contains n integers a_i (1 â‰¤ |a_i| â‰¤ 30) - array elements.`,outputFormat:"Print n integers - the product array.",constraints:["2 â‰¤ n â‰¤ 100000","-30 â‰¤ nums[i] â‰¤ 30","Product of any prefix/suffix fits in 32-bit integer"],tags:["array","prefix-sum"],testCases:[{input:`4
1 2 3 4`,output:"24 12 8 6",explanation:"[2*3*4, 1*3*4, 1*2*4, 1*2*3]"},{input:`5
-1 1 0 -3 3`,output:"0 0 9 0 0",explanation:"Product except self with zero"}]},{id:"A005",title:"Container With Most Water",difficulty:"Medium",timeLimit:"1s",memoryLimit:"256MB",description:"You are given an integer array height of length n. There are n vertical lines drawn such that the two endpoints of the i-th line are (i, 0) and (i, height[i]). Find two lines that together with the x-axis form a container, such that the container contains the most water. Return the maximum amount of water a container can store.",inputFormat:`First line contains integer n (2 â‰¤ n â‰¤ 10^5).
Second line contains n integers h_i (0 â‰¤ h_i â‰¤ 10^4) - heights.`,outputFormat:"Print a single integer - maximum water area.",constraints:["2 â‰¤ n â‰¤ 100000","0 â‰¤ height[i] â‰¤ 10000"],tags:["array","two-pointers","greedy"],testCases:[{input:`9
1 8 6 2 5 4 8 3 7`,output:"49",explanation:"Lines at index 1 and 8, area = min(8,7) * 7 = 49"},{input:`2
1 1`,output:"1",explanation:"Only two lines, area = 1"},{input:`6
4 3 2 1 4 5`,output:"16",explanation:"Lines at index 0 and 5, area = min(4,5) * 5 = 20? No, distance is 5"}]},{id:"A006",title:"Find All Duplicates in Array",difficulty:"Medium",timeLimit:"1s",memoryLimit:"256MB",description:"Given an integer array nums of length n where all integers are in the range [1, n] and each integer appears once or twice, return an array of all the integers that appears twice. You must solve it without extra space and in O(n) runtime.",inputFormat:`First line contains integer n (1 â‰¤ n â‰¤ 10^5).
Second line contains n integers a_i (1 â‰¤ a_i â‰¤ n).`,outputFormat:"Print all duplicate numbers in any order (space-separated). If no duplicates, print empty line.",constraints:["1 â‰¤ n â‰¤ 100000","1 â‰¤ nums[i] â‰¤ n","Each element appears once or twice"],tags:["array","hash-table"],testCases:[{input:`8
4 3 2 7 8 2 3 1`,output:"2 3",explanation:"2 and 3 appear twice"},{input:`2
1 1`,output:"1",explanation:"1 appears twice"},{input:`1
1`,output:"",explanation:"No duplicates"}]}]}],Qs="/questions.json";let Ie=null,at=0;const Ks=36e5,nt=async()=>{if(Ie&&Date.now()-at<Ks)return console.log("âœ“ Using cached questions:",Ie.length),Ie;try{console.log("ðŸ“¥ Attempting to fetch from local /questions.json...");const t=await fetch(Qs);if(t.ok){const a=await t.json(),s=vt(a);if(s.length>0)return console.log(`âœ“ Loaded ${s.length} questions from local file`),Ie=s,at=Date.now(),s}}catch{console.warn("âš ï¸ Local file fetch failed, using bundled data...")}try{const a=vt(Js);if(a.length>0)return console.log(`âœ“ Loaded ${a.length} questions from bundled data`),Ie=a,at=Date.now(),a}catch(t){console.error("âŒ Failed to load bundled questions:",t)}return console.error("âŒ All question sources failed"),[]};function vt(t){if(!t)return[];let a=[];if(Array.isArray(t))a=t;else{const s=t;if(Array.isArray(s.problems))a=s.problems;else if(Array.isArray(s.questions))a=s.questions;else return[]}return a.map(s=>{const r=s,n=String(r.difficulty??r.level??"").trim().toLowerCase();let m="medium";n.startsWith("e")?m="easy":n.startsWith("m")?m="medium":n.startsWith("h")&&(m="hard");const p=r.id??r._id??"",h=r.title??r.name??"Untitled",y=r.description??r.prompt??"";let w="General";typeof r.category=="string"?w=String(r.category):Array.isArray(r.tags)&&r.tags.length>0?w=String(r.tags[0]):typeof r.topic=="string"&&(w=String(r.topic));const S=Number(r.coinReward??r.coins??r.reward??0)||0,A=Array.isArray(r.testCases)?r.testCases:Array.isArray(r.test_cases)?r.test_cases:[],b=B=>{const g=B,j=String(g.input??g.stdin??""),o=String(g.output??g.expected_output??g.expectedOutput??""),C=!!(g.isHidden??g.hidden??!1),k=typeof g.points=="number"?g.points:void 0;return{input:j,expectedOutput:o,expected_output:o,isHidden:C,points:k}};return{id:String(p),title:String(h),description:String(y),category:w,difficulty:m,coinReward:S,coins:S,constraints:String(r.constraints??r.limits??""),solution_hint:String(r.solution_hint??r.hint??""),testCases:A.map(b),test_cases:A.map(B=>{const g=b(B);return{input:g.input,expected_output:g.expected_output}})}})}const Xs=async()=>{const t=await nt(),a=new Set(t.map(s=>s.category));return Array.from(a).sort()},Zs=()=>{const t=pe(),[a,s]=i.useState([]),[r,n]=i.useState([]),[m,p]=i.useState(!0),[h,y]=i.useState(""),[w,S]=i.useState("all"),[A,b]=i.useState("all"),[B,g]=i.useState([]),[j,o]=i.useState(1),C=20,k=[{id:"all",label:"All",color:"bg-gray-100 text-gray-700 border-gray-200"},{id:"easy",label:"Easy",color:"bg-green-50 text-green-700 border-green-200"},{id:"medium",label:"Medium",color:"bg-yellow-50 text-yellow-700 border-yellow-200"},{id:"hard",label:"Hard",color:"bg-red-50 text-red-700 border-red-200"}];i.useEffect(()=>{(async()=>{p(!0);try{const E=await nt();console.log("Questions loaded:",E.length);const x=await Xs();console.log("Topics:",x.length);const I=E.map(v=>({id:v.id,title:v.title,description:v.description,difficulty:v.difficulty,topic:v.category,tags:[v.category],coinReward:v.coins,acceptanceRate:75,category:v.category,isDaily:!1,isPremium:!1,testCases:v.test_cases,sampleCode:"",examples:"",constraints:v.constraints,solution_hint:v.solution_hint}));console.log("Challenges prepared:",I.length),s(I),n(I.slice(0,C)),g(x),p(!1)}catch(E){console.error("Error loading questions:",E),p(!1)}})()},[]),i.useEffect(()=>{let d=[...a];if(w!=="all"&&(d=d.filter(I=>I.difficulty===w)),A!=="all"&&(d=d.filter(I=>I.topic===A)),h){const I=h.toLowerCase();d=d.filter(v=>v.title.toLowerCase().includes(I)||v.description.toLowerCase().includes(I)||v.tags.some(u=>u.toLowerCase().includes(I)))}console.log("Filtered challenges:",d.length,"from",a.length);const E=(j-1)*C,x=d.slice(E,E+C);console.log("Paginated challenges:",x.length),n(x)},[a,w,A,h,j]);const P=async()=>{p(!0);try{const E=(await nt()).map(x=>({id:x.id,title:x.title,description:x.description,difficulty:x.difficulty,topic:x.category,tags:[x.category],coinReward:x.coins,acceptanceRate:75,category:x.category,isDaily:!1,isPremium:!1,testCases:x.test_cases,sampleCode:"",solution_hint:x.solution_hint}));s(E),o(1)}catch(d){console.error("Error refreshing questions:",d)}p(!1)},$=d=>{t(`/dashboard/codearena/challenge/${d.id}`,{state:{challenge:d}})},L=[{label:"Total",value:a.length.toLocaleString(),icon:le,color:"text-[#00ADB5] bg-[#00ADB5]/10"},{label:"Easy",value:a.filter(d=>d.difficulty==="easy").length,icon:Oe,color:"text-green-600 bg-green-50"},{label:"Medium",value:a.filter(d=>d.difficulty==="medium").length,icon:ue,color:"text-yellow-600 bg-yellow-50"},{label:"Hard",value:a.filter(d=>d.difficulty==="hard").length,icon:Ae,color:"text-red-600 bg-red-50"}];return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"space-y-6 pb-20 md:pb-6",children:[e.jsx(c.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-xl",children:e.jsx(ue,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"âš¡ Practice Challenges"}),e.jsx("p",{className:"text-gray-500 dark:text-white text-sm",children:"Solve coding challenges from 3000+ questions and earn coins"})]})]}),e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:P,disabled:m,className:"flex items-center gap-2 px-4 py-2 bg-[#00ADB5] hover:bg-[#00ADB5]/80 text-white font-medium rounded-lg transition-all disabled:opacity-50",children:[e.jsx(Ce,{className:`w-4 h-4 ${m?"animate-spin":""}`}),"Refresh"]})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:L.map((d,E)=>e.jsxs(c.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:E*.1},whileHover:{y:-2,scale:1.02},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-lg transition-all group",children:[e.jsx("div",{className:`inline-flex p-2 rounded-lg ${d.color} dark:bg-opacity-20 mb-3 group-hover:scale-110 transition-transform`,children:e.jsx(d.icon,{className:"w-4 h-4"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d.value}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-white",children:d.label})]},d.label))}),e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(kt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search challenges...",value:h,onChange:d=>{y(d.target.value),o(1)},className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-[#00ADB5] transition-all"})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:k.map(d=>e.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{S(d.id),o(1)},className:`px-4 py-2 rounded-lg text-sm font-medium border transition-all ${w===d.id?d.color:"bg-gray-50 dark:bg-gray-900 text-gray-600 dark:text-white border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:d.label},d.id))}),B.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{b("all"),o(1)},className:`px-4 py-2 rounded-full text-xs font-medium transition-all ${A==="all"?"bg-[#00ADB5] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"All Topics"}),B.slice(0,10).map(d=>e.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{b(d),o(1)},className:`px-4 py-2 rounded-full text-xs font-medium transition-all ${A===d?"bg-[#00ADB5] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:d},d)),B.length>10&&e.jsxs("span",{className:"px-4 py-2 text-xs text-gray-500 dark:text-white",children:["+",B.length-10," more"]})]})]}),m?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs(c.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8",children:[e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-8 h-8 border-2 border-[#00ADB5] border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-white",children:"Loading 3000+ questions from GitHub..."})]})}):r.length===0?e.jsxs(c.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-20 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsx(Qt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-lg",children:"No challenges found"}),e.jsx("p",{className:"text-gray-500 dark:text-white text-sm mt-2",children:"Try adjusting your filters"})]}):e.jsx("div",{className:"space-y-3",children:r.map((d,E)=>e.jsx(c.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{delay:E*.05,duration:.4},whileHover:{y:-2,scale:1.02},className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 hover:shadow-lg hover:border-blue-300 dark:hover:border-blue-600 transition-all group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white text-lg group-hover:text-[#00ADB5] dark:group-hover:text-[#00ADB5] transition-colors",children:d.title})}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-white mb-3 group-hover:text-gray-700 dark:group-hover:text-gray-300 transition-colors line-clamp-2",children:d.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm mb-3",children:[e.jsx(c.span,{whileHover:{scale:1.05},className:`px-3 py-1 rounded-full text-xs font-semibold ${d.difficulty==="easy"?"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-700":d.difficulty==="medium"?"bg-yellow-50 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 border border-yellow-200 dark:border-yellow-700":"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-700"}`,children:d.difficulty?d.difficulty.charAt(0).toUpperCase()+d.difficulty.slice(1):"Unknown"}),e.jsx("span",{className:"text-gray-600 dark:text-white text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:d.category}),e.jsxs("span",{className:"flex items-center gap-1 text-amber-600 dark:text-amber-400 text-xs font-medium",children:[e.jsx(ee,{className:"w-3 h-3"}),d.coinReward||d.coins||0]})]})]}),e.jsx("div",{className:"flex items-center gap-2 ml-6",children:e.jsxs(c.button,{whileHover:{scale:1.05,boxShadow:"0 10px 30px rgba(59, 130, 246, 0.3)"},whileTap:{scale:.95},onClick:()=>$(d),className:"flex items-center gap-2 px-6 py-3 bg-[#00ADB5] hover:bg-[#00ADB5]/80 text-white text-sm font-semibold rounded-lg transition-all",children:[e.jsx("span",{className:"relative",children:"Solve"}),e.jsx(Ge,{className:"w-4 h-4 relative"})]})})]})},d.id))}),!m&&r.length>0&&e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-center gap-3",children:[e.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>o(d=>Math.max(1,d-1)),disabled:j===1,className:"px-6 py-3 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium shadow-sm",children:"Previous"}),e.jsxs("span",{className:"px-4 py-3 text-gray-700 dark:text-gray-300 text-sm bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:["Page ",j]}),e.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>o(d=>d+1),disabled:r.length<C,className:"px-6 py-3 bg-[#00ADB5] hover:bg-[#00ADB5]/80 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all font-medium shadow-sm",children:"Next"})]})]})})},er=()=>{const[t,a]=i.useState(!1),[s,r]=i.useState(!1),[n,m]=i.useState(null),[p,h]=i.useState(null),y=async()=>{try{const b=(await F("/challenges")).challenges?.length||0;return h(b),b}catch(A){return console.error("Error checking challenges:",A),0}},w=async()=>{a(!0),m(null);try{let A=0;for(const b of tt)await F("/challenges",{method:"POST",body:JSON.stringify({...b,createdAt:new Date,updatedAt:new Date})}),A++;m({type:"success",text:`Successfully added ${A} challenges to backend!`}),await y()}catch(A){console.error("Error seeding challenges:",A),m({type:"error",text:`Error: ${A.message||"Failed to seed challenges"}`})}a(!1)},S=async()=>{if(confirm("Are you sure you want to delete ALL challenges? This cannot be undone.")){r(!0),m(null);try{const b=(await F("/challenges")).challenges||[];let B=0;for(const g of b)await F(`/challenges/${g.id}`,{method:"DELETE"}),B++;m({type:"info",text:`Deleted ${B} challenges from backend.`}),h(0)}catch(A){console.error("Error deleting challenges:",A),m({type:"error",text:`Error: ${A.message||"Failed to delete challenges"}`})}r(!1)}};return i.useEffect(()=>{y()},[]),e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-lg p-8 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex p-3 bg-[#00ADB5]/20 dark:bg-blue-900/50 rounded-full mb-4",children:e.jsx(la,{className:"w-8 h-8 text-[#00ADB5] dark:text-[#00ADB5]"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"CodeArena Seed Tool"}),e.jsx("p",{className:"text-gray-500 dark:text-white",children:"Add sample challenges to your backend database"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-white",children:"Challenges to add:"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:tt.length})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-white",children:"Existing in backend:"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:p!==null?p:e.jsx(Ce,{className:"w-4 h-4 animate-spin text-gray-400"})})]})]}),n&&e.jsxs(c.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:`mb-6 p-4 rounded-lg flex items-start gap-3 ${n.type==="success"?"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700":n.type==="error"?"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700":"bg-[#00ADB5]/10 dark:bg-[#00ADB5]/20 border border-[#00ADB5]/30 dark:border-blue-700"}`,children:[n.type==="success"?e.jsx(re,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}):n.type==="error"?e.jsx(ut,{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}):e.jsx(ut,{className:"w-5 h-5 text-[#00ADB5] dark:text-[#00ADB5] flex-shrink-0 mt-0.5"}),e.jsx("p",{className:`text-sm ${n.type==="success"?"text-green-700 dark:text-green-400":n.type==="error"?"text-red-700 dark:text-red-400":"text-blue-700 dark:text-[#00ADB5]"}`,children:n.text})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:w,disabled:t||s,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-[#00ADB5] text-white font-medium rounded-lg hover:bg-[#00ADB5]/80 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[t?e.jsx(ae,{className:"w-5 h-5 animate-spin"}):e.jsx(Zt,{className:"w-5 h-5"}),t?"Adding Challenges...":"Seed Challenges"]}),e.jsxs("button",{onClick:()=>y(),disabled:t||s,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(Ce,{className:"w-5 h-5"}),"Refresh Count"]}),e.jsxs("button",{onClick:S,disabled:t||s||p===0,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-400 font-medium rounded-lg hover:bg-red-100 dark:hover:bg-red-900/50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors border border-red-200 dark:border-red-700",children:[s?e.jsx(ae,{className:"w-5 h-5 animate-spin"}):e.jsx(ea,{className:"w-5 h-5"}),s?"Deleting...":"Delete All Challenges"]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Challenges to be added:"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:tt.map((A,b)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:A.title}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${A.difficulty==="easy"?"bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-400":A.difficulty==="medium"?"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-400":"bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-400"}`,children:A.difficulty})]},b))})]})]})})},tr=({wallet:t,onClose:a})=>{const{user:s}=fe(),{fetchUserTransactions:r,getUserProgress:n}=be(),[m,p]=i.useState([]),[h,y]=i.useState(!0),[w,S]=i.useState("overview"),[A,b]=i.useState({problemsSolved:0,battlesWon:0,currentStreak:0});i.useEffect(()=>{(async()=>{if(s)try{const C=(await n?.(s.id))?.solvedChallenges?.length||t?.achievements?.problemsSolved||0;let k=0,P=0;try{k=t?.achievements?.battlesWon||0,P=t?.streak?.current||0}catch($){console.error("Error fetching battles for wallet:",$),k=t?.achievements?.battlesWon||0,P=t?.streak?.current||0}b({problemsSolved:C,battlesWon:k,currentStreak:P})}catch(o){console.error("Error fetching real stats:",o),b({problemsSolved:t?.achievements?.problemsSolved||0,battlesWon:t?.achievements?.battlesWon||0,currentStreak:t?.streak?.current||0})}})()},[s,t,n]),i.useEffect(()=>{(async()=>{if(s)try{const o=await r(s.id);p(o||[])}catch(o){console.error("Error loading transactions:",o),p([])}finally{y(!1)}})()},[s,r]);const B=(j,o)=>{if(j==="earn")switch(o){case"challenge":return ue;case"battle":return te;case"tournament":return Q;default:return mt}else switch(o){case"hint":return Ae;case"entry_fee":return te;default:return ee}},g=j=>j?(j.toDate?j.toDate():new Date(j)).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"";return e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-end",onClick:a,children:e.jsxs(c.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},onClick:j=>j.stopPropagation(),className:"h-full w-full max-w-sm bg-gray-900 border-l border-gray-700/50 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(ya,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"My Wallet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Manage your coins & rewards"})]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-700/50 rounded-lg transition-colors",children:e.jsx(it,{className:"w-5 h-5 text-gray-400"})})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500/20 via-amber-500/20 to-orange-500/20 border border-yellow-500/30 rounded-2xl p-6",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Total Balance"}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-yellow-400 to-amber-500 flex items-center justify-center",children:e.jsx("span",{className:"text-xl font-bold text-gray-900",children:"â‚¿"})}),e.jsx("span",{className:"text-4xl font-bold text-white",children:t?.coins?.toLocaleString()||0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-400 mb-1",children:[e.jsx(qe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Earned"})]}),e.jsx("p",{className:"text-white font-bold",children:t?.totalEarned?.toLocaleString()||0})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 mb-1",children:[e.jsx(Et,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Spent"})]}),e.jsx("p",{className:"text-white font-bold",children:t?.totalSpent?.toLocaleString()||0})]})]})]})}),e.jsx("div",{className:"flex gap-2 px-4",children:[{id:"overview",label:"Overview"},{id:"history",label:"History"}].map(j=>e.jsx("button",{onClick:()=>S(j.id),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-all ${w===j.id?"bg-cyan-500/20 text-cyan-400":"bg-gray-800/50 text-gray-400 hover:text-white"}`,children:j.label},j.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:w==="overview"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5 text-purple-400"}),e.jsxs("span",{className:"text-white font-medium",children:["Level ",t?.level||1]})]}),e.jsxs("span",{className:"text-sm text-gray-400",children:[t?.experience||0," / ",(t?.level||1)*100," XP"]})]}),e.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx(c.div,{initial:{width:0},animate:{width:`${(t?.experience||0)/((t?.level||1)*100)*100}%`},className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsx(ue,{className:"w-5 h-5 text-green-400 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:A.problemsSolved}),e.jsx("p",{className:"text-sm text-gray-400",children:"Problems Solved"})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsx(te,{className:"w-5 h-5 text-[#00ADB5] mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:A.battlesWon}),e.jsx("p",{className:"text-sm text-gray-400",children:"Battles Won"})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsx(Q,{className:"w-5 h-5 text-yellow-400 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t?.achievements?.tournamentsWon||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tournaments"})]}),e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsx(Oe,{className:"w-5 h-5 text-orange-400 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:A.currentStreak}),e.jsx("p",{className:"text-sm text-gray-400",children:"Win Streak"})]})]}),t?.badges&&t.badges.length>0&&e.jsxs("div",{className:"bg-gray-800/50 border border-gray-700/50 rounded-xl p-4",children:[e.jsxs("h3",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(mt,{className:"w-5 h-5 text-pink-400"}),"Badges"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.badges.map((j,o)=>e.jsxs("div",{className:"px-3 py-1.5 bg-gray-700/50 rounded-lg text-sm text-white flex items-center gap-2",title:j.description,children:[e.jsx("span",{children:j.icon}),e.jsx("span",{children:j.name})]},o))})]})]}):e.jsx("div",{className:"space-y-3",children:h?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(c.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full"})}):m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(st,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No transactions yet"})]}):m.map((j,o)=>{const C=B(j.type,j.category),k=j.type==="earn";return e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:o*.05},className:"flex items-center justify-between p-3 bg-gray-800/50 border border-gray-700/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${k?"bg-green-500/20":"bg-red-500/20"}`,children:e.jsx(C,{className:`w-4 h-4 ${k?"text-green-400":"text-red-400"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:j.description}),e.jsx("p",{className:"text-xs text-gray-400",children:g(j.createdAt)})]})]}),e.jsxs("div",{className:`flex items-center gap-1 font-bold ${k?"text-green-400":"text-red-400"}`,children:[k?e.jsx(ra,{className:"w-4 h-4"}):e.jsx(aa,{className:"w-4 h-4"}),e.jsxs("span",{children:[k?"+":"-",j.amount]})]})]},j.id||o)})})})]})})};class ar extends i.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){console.error("CodeArena Error:",a,s)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-red-200 dark:border-red-800 p-8 max-w-md w-full text-center",children:[e.jsx(Tt,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-4",children:"There was an error loading CodeArena. Please refresh the page or try again later."}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/30 p-3 rounded-lg mb-4 text-left",children:e.jsx("pre",{className:"text-xs text-red-700 dark:text-red-400 whitespace-pre-wrap",children:this.state.error?.message||"Unknown error"})}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-[#00ADB5] text-white rounded-lg hover:bg-[#00ADB5]/80 transition-colors",children:"Refresh Page"})]})}):this.props.children}}const sr=()=>{const t=pe(),a=lt(),{user:s}=fe(),{getUserWallet:r,initializeWallet:n,subscribeToWallet:m,userprofile:p,fetchGlobalLeaderboard:h,getUserProgress:y}=be(),[w,S]=i.useState("home"),[A,b]=i.useState(null),[B,g]=i.useState({problemsSolved:0,battlesWon:0,currentStreak:0,globalRank:"-"}),[j,o]=i.useState(!0),[C,k]=i.useState(!1),[P,$]=i.useState(null),L=async(x,I)=>{try{const u=(await y?.(x))?.solvedChallenges?.length||I?.achievements?.problemsSolved||0;let T=0,_=0;try{const U=((await F("/battles")).battles||[]).filter(V=>(V.participants||[]).some(H=>(H.odId||H.userId)===x));U.forEach(V=>{V.winnerId===x&&T++});const q=U.filter(V=>V.status==="completed"||V.status==="forfeited").sort((V,X)=>{const H=Y=>Y?typeof Y=="object"&&Y.toDate?Y.toDate().getTime():Y instanceof Date?Y.getTime():typeof Y=="number"?Y:0:0;return H(X.createdAt)-H(V.createdAt)});for(const V of q)if(V.winnerId===x)_++;else if(V.winnerId)break}catch(O){console.error("Error fetching battles:",O),T=I?.achievements?.battlesWon||0,_=I?.streak?.current||0}let z="-";try{const D=(await h?.())?.find(U=>U.odId===x);D&&(z=D.rank)}catch{}g({problemsSolved:u,battlesWon:T,currentStreak:_,globalRank:z})}catch(v){console.error("Error fetching user stats:",v),g({problemsSolved:I?.achievements?.problemsSolved||0,battlesWon:I?.achievements?.battlesWon||0,currentStreak:I?.streak?.current||0,globalRank:"-"})}};i.useEffect(()=>{(async()=>{if(s&&s.id)try{console.log("Initializing wallet for user:",s.id);const I=await r(s.id);console.log("Existing wallet:",I),I||(console.log("No wallet found, creating new one..."),await n(s.id));const v=m(s.id,async u=>{console.log("Wallet data received:",u),b(u),await L(s.id,u),o(!1)});return()=>v()}catch(I){console.error("Error initializing wallet:",I),$("Failed to initialize wallet. Please check your connection and try again."),o(!1)}else console.log("No user or user.id, skipping wallet init"),o(!1)})()},[s,r,n,m,p]),i.useEffect(()=>{const x=a.pathname;x.includes("/battle/history")?S("history"):x.includes("/battle")?S("battle"):x.includes("/practice")?S("practice"):x.includes("/leaderboard")?S("leaderboard"):S("home")},[a]);const d=[{label:"Problems Solved",value:B.problemsSolved,icon:le,color:"text-emerald-600 bg-emerald-50"},{label:"Battles Won",value:B.battlesWon,icon:te,color:"text-[#00ADB5] bg-[#00ADB5]/10"},{label:"Current Streak",value:B.currentStreak,icon:Ae,color:"text-orange-600 bg-orange-50"},{label:"Global Rank",value:B.globalRank,icon:Q,color:"text-amber-600 bg-amber-50"}],E=[{title:"Quick Battle",description:"Compete in a 1v1 coding duel",icon:te,color:"bg-red-500",path:"battle"},{title:"Practice Mode",description:"Solve problems from Codeforces",icon:ue,color:"bg-[#00ADB5]",path:"practice"},{title:"Leaderboard",description:"View global rankings",icon:Q,color:"bg-amber-500",path:"leaderboard"}];return j?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"w-8 h-8 text-[#00ADB5] animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-white",children:"Loading CodeArena..."})]})}):P?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-red-200 dark:border-red-700 p-8 max-w-md w-full text-center",children:[e.jsx(Tt,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Error Loading CodeArena"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-4",children:P}),e.jsx("button",{onClick:()=>{$(null),o(!0),window.location.reload()},className:"px-4 py-2 bg-[#00ADB5] text-white rounded-lg hover:bg-[#00ADB5]/80 transition-colors",children:"Try Again"})]})}):s?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-[#00ADB5] rounded-lg",children:e.jsx(le,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"CodeArena"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white",children:"Battle. Code. Win."})]})]}),e.jsx("nav",{className:"hidden md:flex items-center gap-1",children:[{id:"home",label:"Home",icon:le,path:""},{id:"battle",label:"Battle",icon:te,path:"battle"},{id:"history",label:"History",icon:st,path:"battle/history"},{id:"practice",label:"Practice",icon:ue,path:"practice"},{id:"leaderboard",label:"Ranks",icon:Q,path:"leaderboard"}].map(x=>e.jsxs("button",{onClick:()=>t(`/dashboard/codearena/${x.path}`),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${w===x.id?"bg-[#00ADB5]/10 dark:bg-[#00ADB5]/20 text-[#00ADB5] dark:text-[#00ADB5]":"text-gray-600 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[e.jsx(x.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:x.label})]},x.id))}),e.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-4 py-2 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-700 rounded-lg hover:bg-amber-100 dark:hover:bg-amber-900/50 transition-all",children:[e.jsx(ee,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"}),e.jsx("span",{className:"text-amber-700 dark:text-amber-300 font-semibold",children:A?.coins?.toLocaleString()||0})]})]})})}),e.jsx("main",{className:"max-w-6xl mx-auto px-4 py-6",children:e.jsxs(Kt,{children:[e.jsx(ie,{path:"/",element:e.jsx(rr,{stats:d,quickActions:E,navigate:t})}),e.jsx(ie,{path:"/battle",element:e.jsx(Sa,{wallet:A})}),e.jsx(ie,{path:"/battle/history",element:e.jsx(ja,{})}),e.jsx(ie,{path:"/battle/:battleId",element:e.jsx(Hs,{})}),e.jsx(ie,{path:"/battle/results/:battleId",element:e.jsx(Aa,{})}),e.jsx(ie,{path:"/practice",element:e.jsx(Zs,{})}),e.jsx(ie,{path:"/practice/:challengeId",element:e.jsx(Ys,{})}),e.jsx(ie,{path:"/challenge/:challengeId",element:e.jsx(Gs,{})}),e.jsx(ie,{path:"/leaderboard",element:e.jsx(qs,{})}),e.jsx(ie,{path:"/seed",element:e.jsx(er,{})})]})}),e.jsx(oe,{children:C&&e.jsx(tr,{wallet:A,onClose:()=>k(!1)})}),e.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 px-4 py-2 z-50",children:e.jsx("div",{className:"flex justify-around",children:[{id:"home",label:"Home",icon:le,path:""},{id:"battle",label:"Battle",icon:te,path:"battle"},{id:"history",label:"History",icon:st,path:"battle/history"},{id:"leaderboard",label:"Ranks",icon:Q,path:"leaderboard"}].map(x=>e.jsxs("button",{onClick:()=>t(`/dashboard/codearena/${x.path}`),className:`flex flex-col items-center gap-1 p-2 ${w===x.id?"text-[#00ADB5]":"text-gray-400"}`,children:[e.jsx(x.icon,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:x.label})]},x.id))})})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 max-w-md w-full text-center",children:[e.jsx(le,{className:"w-12 h-12 text-[#00ADB5] mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Login Required"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-4",children:"Please log in to access CodeArena."}),e.jsx("button",{onClick:()=>t("/login"),className:"px-4 py-2 bg-[#00ADB5] text-white rounded-lg hover:bg-[#00ADB5]/80 transition-colors",children:"Go to Login"})]})})},rr=({stats:t,quickActions:a,navigate:s})=>{const{fetchGlobalLeaderboard:r}=be(),[n,m]=i.useState([]),[p,h]=i.useState([]),[y,w]=i.useState(!0),[S,A]=i.useState(!0);return i.useEffect(()=>{const b=async()=>{try{const o=await F("/battles?status=active"),C=await F("/battles?status=waiting"),k=await F("/battles?status=countdown"),P=o.battles||[],$=C.battles||[],L=k.battles||[],d=[...P,...L,...$].slice(0,5).map(E=>({id:E.id||E._id,status:E.status,difficulty:E.difficulty,entryFee:E.entryFee,prize:E.prize,participants:E.participants?.map(x=>({odId:x.odId||x.userId,userName:x.userName||x.odName||"Player",userAvatar:x.userAvatar||x.odProfilePic}))||[]}));m(d)}catch(o){console.error("Error loading battles:",o),m([])}finally{w(!1)}},B=async()=>{try{if(r){const o=await r();h(o?.slice(0,3)||[])}}catch(o){console.error("Error loading top players:",o),h([])}finally{A(!1)}};b(),B();const g=setInterval(b,1e4),j=setInterval(B,3e4);return()=>{clearInterval(g),clearInterval(j)}},[]),e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-6 pb-20 md:pb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Welcome Back! ðŸ‘‹"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-6",children:"Ready to test your coding skills? Battle other developers or practice with Codeforces problems."}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>s("/dashboard/codearena/battle"),className:"flex items-center gap-2 px-5 py-2.5 bg-[#00ADB5] text-white font-medium rounded-lg hover:bg-[#00ADB5]/80 transition-colors",children:[e.jsx(te,{className:"w-4 h-4"}),"Find Match"]}),e.jsxs("button",{onClick:()=>s("/dashboard/codearena/practice"),className:"flex items-center gap-2 px-5 py-2.5 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 font-medium rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),"Practice"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.map((b,B)=>e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:B*.05},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4",children:[e.jsx("div",{className:`inline-flex p-2 rounded-lg ${b.color} mb-3`,children:e.jsx(b.icon,{className:"w-4 h-4"})}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:b.value}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-white",children:b.label})]},b.label))}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:a.map((b,B)=>e.jsxs(c.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1+B*.05},onClick:()=>s(`/dashboard/codearena/${b.path}`),className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 text-left hover:border-gray-300 dark:hover:border-gray-600 hover:shadow-sm transition-all group",children:[e.jsx("div",{className:`inline-flex p-3 rounded-lg ${b.color} mb-4`,children:e.jsx(b.icon,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:b.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-white mb-4",children:b.description}),e.jsxs("div",{className:"flex items-center gap-1 text-[#00ADB5] dark:text-[#00ADB5] text-sm font-medium group-hover:gap-2 transition-all",children:[e.jsx("span",{children:"Get Started"}),e.jsx(Ge,{className:"w-4 h-4"})]})]},b.title))}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-green-600"}),"Live Battles"]}),e.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-50 dark:bg-green-900/30 px-2 py-1 rounded-full",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),y?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ae,{className:"w-5 h-5 text-gray-400 animate-spin"})}):n.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-white",children:[e.jsx(He,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No active battles"}),e.jsx("button",{onClick:()=>s("/dashboard/codearena/battle"),className:"mt-2 text-xs text-[#00ADB5] hover:underline",children:"Start a battle"})]}):e.jsx("div",{className:"space-y-3",children:n.map((b,B)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer",onClick:()=>s(`/dashboard/codearena/battle/${b.id}`),title:"Rejoin this battle",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex -space-x-2",children:b.participants?.slice(0,2).map((g,j)=>e.jsx("div",{className:`w-7 h-7 rounded-full border-2 border-white dark:border-gray-800 flex items-center justify-center text-xs font-bold text-white ${j===0?"bg-[#00ADB5]":"bg-purple-500"}`,children:g.userName?.[0]||"?"},j))}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[b.participants?.[0]?.userName||"Player"," vs ",b.participants?.[1]?.userName||"Waiting..."]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-white capitalize",children:b.difficulty||"Medium"})]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${b.status==="waiting"?"text-[#00ADB5] bg-[#00ADB5]/10 dark:bg-[#00ADB5]/20":"text-orange-600 bg-orange-50 dark:bg-orange-900/30"}`,children:b.status==="waiting"?"Waiting":"In Progress"})]},b.id||B))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-amber-500"}),"Top Players"]}),e.jsx("button",{onClick:()=>s("/dashboard/codearena/leaderboard"),className:"text-sm text-[#00ADB5] dark:text-[#00ADB5] hover:underline",children:"View All"})]}),S?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ae,{className:"w-5 h-5 text-gray-400 animate-spin"})}):p.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-white",children:[e.jsx(ge,{className:"w-8 h-8 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No rankings yet"}),e.jsx("button",{onClick:()=>s("/dashboard/codearena/practice"),className:"mt-2 text-xs text-[#00ADB5] hover:underline",children:"Start solving challenges"})]}):e.jsx("div",{className:"space-y-3",children:p.map(b=>{const B=["text-amber-500 bg-amber-50 dark:bg-amber-900/30","text-gray-400 bg-gray-100 dark:bg-gray-700","text-orange-500 bg-orange-50 dark:bg-orange-900/30"];return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center text-xs font-bold ${B[b.rank-1]||"text-gray-600 dark:text-white bg-gray-50 dark:bg-gray-700"}`,children:b.rank}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:b.odName}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-white",children:[b.problemsSolved," solved"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[#00ADB5] dark:text-[#00ADB5]",children:[e.jsx(qe,{className:"w-3 h-3"}),e.jsx("span",{className:"text-sm font-medium",children:b.rating})]})]},b.odId)})})]})]})]})},fr=()=>e.jsx(ar,{children:e.jsx(sr,{})});export{fr as default};
