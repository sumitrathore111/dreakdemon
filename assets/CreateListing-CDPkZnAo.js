import{i as B,k as L,u as S,t as I,r as c,j as e,z as T,J as E,X as w,K as i}from"./index-Do6L6L7r.js";import{j as F,u as R,k as U}from"./marketplaceServiceNew-CwxS4q6E.js";import{C as q,L as $,T as Y}from"./marketplace-Deg-FW8s.js";import{P as p}from"./plus-C-5GXOn_.js";import{I as M}from"./image-C4MZC_Sl.js";function z(){const{user:u}=B(),{userprofile:x,avatrUrl:N}=L(),o=S(),{projectId:n}=I(),l=!!n,[t,s]=c.useState({title:"",description:"",category:"web-app",techStack:[],price:0,isFree:!0,images:[],links:{github:"",liveDemo:"",documentation:"",video:""},licenseType:"personal",status:"published"}),[m,h]=c.useState(""),[d,b]=c.useState(""),[y,f]=c.useState(!1),[D,k]=c.useState(!1);c.useEffect(()=>{(async()=>{if(!(!l||!n)){k(!0);try{const a=await F(n);if(a){if(a.sellerId!==u?.id){i.error("You can only edit your own projects"),o("/dashboard/marketplace/my-listings");return}s({title:a.title,description:a.description,category:a.category,techStack:a.techStack,price:a.price,isFree:a.isFree,images:a.images,links:a.links,licenseType:a.licenseType,status:a.status})}else i.error("Project not found"),o("/dashboard/marketplace/my-listings")}catch(a){console.error("Error loading project:",a),i.error("Failed to load project"),o("/dashboard/marketplace/my-listings")}finally{k(!1)}}})()},[n,l,u,o]);const j=r=>{r&&!t.techStack.includes(r)&&(s({...t,techStack:[...t.techStack,r]}),h(""))},A=r=>{s({...t,techStack:t.techStack.filter(a=>a!==r)})},v=()=>{if(d&&!t.images.includes(d)){if(!/^https?:\/\/.+/.test(d)){i.error("Please enter a valid image URL (must start with http:// or https://)");return}s({...t,images:[...t.images,d]}),b(""),i.success("Image URL added!")}},C=r=>{s({...t,images:t.images.filter(a=>a!==r)})},P=async r=>{if(r.preventDefault(),!u||!x?.name){i.error("You must be logged in");return}if(!t.title||!t.description){i.error("Please fill in all required fields");return}if(t.techStack.length===0){i.error("Please add at least one technology");return}if(!t.links.github||!t.links.github.trim()){i.error("GitHub repository link is required");return}if(!t.links.liveDemo||!t.links.liveDemo.trim()){i.error("Live Demo link is required");return}const a=/^https?:\/\/.+/;if(!a.test(t.links.github)){i.error("Please enter a valid GitHub URL (must start with http:// or https://)");return}if(!a.test(t.links.liveDemo)){i.error("Please enter a valid Live Demo URL (must start with http:// or https://)");return}f(!0);try{if(l&&n)await R(n,t),i.success("Project updated successfully!"),o(`/dashboard/marketplace/project/${n}`);else{const g={...t,sellerId:u.id,sellerName:x.name,sellerAvatar:N||""};await U(g),i.success("Project submitted for verification! It will be visible after admin approval.",{duration:5e3,icon:"ðŸ”"}),o("/dashboard/marketplace/my-listings")}}catch(g){console.error(`Error ${l?"updating":"creating"} project:`,g),g?.message?i.error(`Failed to ${l?"update":"create"} listing: ${g.message}`):i.error(`Failed to ${l?"update":"create"} listing. Check browser console for details.`)}finally{f(!1)}};return D?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-t-transparent rounded-full animate-spin mb-4",style:{borderColor:"#00ADB5",borderTopColor:"transparent"}}),e.jsx("p",{className:"text-gray-600 dark:text-white font-medium",children:"Loading project..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("button",{onClick:()=>o(l?"/dashboard/marketplace/my-listings":"/dashboard/marketplace"),className:"mb-6 flex items-center gap-2 text-gray-600 dark:text-white transition-colors font-medium",style:{"--hover-color":"#00ADB5"},onMouseEnter:r=>r.currentTarget.style.color="#00ADB5",onMouseLeave:r=>r.currentTarget.style.color="",children:[e.jsx(T,{className:"w-5 h-5"}),l?"Back to My Listings":"Back to Marketplace"]}),e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-50 dark:bg-gray-800 rounded-xl p-8 border border-gray-200 dark:border-gray-700 shadow-sm",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",style:{color:"#00ADB5"},children:l?"Edit Your Project":"List Your Project"}),e.jsx("p",{className:"text-gray-600 dark:text-white mb-8",children:l?"Update your project details":"Share your amazing project with the community"}),e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Project Title *"}),e.jsx("input",{type:"text",value:t.title,onChange:r=>s({...t,title:r.target.value}),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#00ADB5] focus:bg-white dark:focus:bg-gray-800 transition-all",placeholder:"e.g., E-commerce Platform with React & Node.js",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Description *"}),e.jsx("textarea",{value:t.description,onChange:r=>s({...t,description:r.target.value}),rows:6,className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#00ADB5] focus:bg-white dark:focus:bg-gray-800 transition-all",placeholder:"Describe your project, its features, and what makes it special...",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Category *"}),e.jsx("select",{value:t.category,onChange:r=>s({...t,category:r.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#00ADB5]",children:Object.entries(q).map(([r,a])=>e.jsx("option",{value:r,children:a},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"License Type *"}),e.jsx("select",{value:t.licenseType,onChange:r=>s({...t,licenseType:r.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#00ADB5]",children:Object.entries($).map(([r,a])=>e.jsx("option",{value:r,children:a},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Tech Stack *"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:m,onChange:r=>h(r.target.value),onKeyPress:r=>{r.key==="Enter"&&(r.preventDefault(),j(m))},list:"tech-options",className:"flex-1 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#00ADB5] focus:bg-white dark:focus:bg-gray-800 transition-all",placeholder:"Type or select technology..."}),e.jsx("datalist",{id:"tech-options",children:Y.map(r=>e.jsx("option",{value:r},r))}),e.jsxs("button",{type:"button",onClick:()=>j(m),className:"px-4 py-2 text-white rounded-lg transition-colors flex items-center gap-2 hover:opacity-90",style:{backgroundColor:"#00ADB5"},children:[e.jsx(p,{className:"w-5 h-5"}),"Add"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.techStack.map(r=>e.jsxs("span",{className:"px-3 py-1.5 rounded-lg text-sm font-medium flex items-center gap-2",style:{backgroundColor:"rgba(0, 173, 181, 0.15)",color:"#00ADB5"},children:[r,e.jsx("button",{type:"button",onClick:()=>A(r),className:"hover:text-purple-900 transition-colors",children:e.jsx(w,{className:"w-4 h-4"})})]},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Pricing"}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:t.isFree,onChange:()=>s({...t,isFree:!0,price:0}),className:"w-4 h-4 accent-[#00ADB5]"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Free"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:!t.isFree,onChange:()=>s({...t,isFree:!1}),className:"w-4 h-4 accent-[#00ADB5]"}),e.jsx("span",{className:"text-gray-900 dark:text-white",children:"Paid"})]})]}),!t.isFree&&e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500 dark:text-white font-medium",children:"$"}),e.jsx("input",{type:"number",min:"1",value:t.price,onChange:r=>s({...t,price:Number(r.target.value)}),className:"w-full pl-8 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#00ADB5] focus:bg-white dark:focus:bg-gray-600 transition-all",placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Project Images"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center w-full p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 mb-3",children:[e.jsx(M,{className:"w-8 h-8 text-[#00ADB5] mb-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-white",children:"Add images by URL"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Use image URLs from hosting services like Imgur, Cloudinary, etc."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:d,onChange:r=>b(r.target.value),onKeyPress:r=>{r.key==="Enter"&&(r.preventDefault(),v())},className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#00ADB5] focus:bg-white dark:focus:bg-gray-600 transition-all text-sm",placeholder:"https://example.com/image.jpg"}),e.jsxs("button",{type:"button",onClick:v,className:"px-3 py-2 bg-[#00ADB5] text-white rounded-lg hover:opacity-90 transition-colors flex items-center gap-2 text-sm",children:[e.jsx(p,{className:"w-4 h-4"}),"Add"]})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:t.images.map((r,a)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:r,alt:`Preview ${a+1}`,className:"w-full h-32 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>C(r),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(w,{className:"w-4 h-4"})})]},a))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:["GitHub Repository ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"url",value:t.links.github,onChange:r=>s({...t,links:{...t.links,github:r.target.value}}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#00ADB5]",placeholder:"https://github.com/...",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:["Live Demo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"url",value:t.links.liveDemo,onChange:r=>s({...t,links:{...t.links,liveDemo:r.target.value}}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#00ADB5]",placeholder:"https://demo.example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Documentation"}),e.jsx("input",{type:"url",value:t.links.documentation,onChange:r=>s({...t,links:{...t.links,documentation:r.target.value}}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#00ADB5]",placeholder:"https://docs.example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Video Demo (YouTube, etc.)"}),e.jsx("input",{type:"url",value:t.links.video,onChange:r=>s({...t,links:{...t.links,video:r.target.value}}),className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-[#00ADB5]",placeholder:"https://youtube.com/..."})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>o(l?"/dashboard/marketplace/my-listings":"/dashboard/marketplace"),className:"flex-1 px-6 py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white rounded-lg font-semibold hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:y,className:"flex-1 px-6 py-3 text-white rounded-lg font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 hover:opacity-90",style:{background:"linear-gradient(135deg, #00ADB5 0%, #00d4ff 100%)"},children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:l?"Updating...":"Publishing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"w-5 h-5"}),e.jsx("span",{children:l?"Update Project":"Publish Project"})]})})]})]})]})]})})}export{z as default};
